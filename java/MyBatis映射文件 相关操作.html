<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修MyBatis映射文件 相关操作' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>MyBatis映射文件 相关操作</center></div><div class='banquan'>原文出处:本文由博客园博主累成一条狗提供。<br/>
原文连接:https://www.cnblogs.com/l-y-h/p/11713843.html</div><br>
    <h2>一、MyBatis映射文件</h2>
<h3>1、简介</h3>
<p>　　MyBatis 的真正强大在于它的映射语句，也是它的魔力所在。由于它的异常强大，映射器的 XML 文件就显得相对简单。如果拿它跟具有相同功能的 JDBC 代码进行对比，你会立即发现省掉了将近 95% 的代码。MyBatis 就是针对 SQL 构建的，并且比普通的方法做的更好。</p>
<p>　　学习 MyBatis，需要了解 其如何对参数进行处理、如何将返回值进行映射。</p>
<h3>2、实现简单的增删改查</h3>
<p>　　使用一个简单的增删改查小案例，快速明白 mybatis 映射文件使用的流程。</p>
<p>step1：文件结构</p>
<p><img src="./images/MyBatis映射文件 相关操作0.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>step2：完整代码</p>
<src class="cnblogs_code">
<pre><code><span style="color: #000000;">【主要文件】
    config/db.properties                   用于设置数据库的配置信息
    config/EmpMapper.xml                   sql映射文件，用于编写sql语句
    config/mybatis-config.xml              全局配置文件
    entity.Employee                        实体类
    mapper.EmpMapper                       接口类，用于定义sql方法
    test.Demo                              测试类，用于测试增删改查


【config/db.properties 】
jdbc.driver = com.mysql.cj.jdbc.Driver
jdbc.url = jdbc:mysql://localhost:3306/lyh?useUnicode=true</span><span style="color: #ff0000;">&amp;characterEncoding</span><span style="color: #000000;">=utf8
jdbc.username = root
jdbc.password = 123456


【config/mybatis-config.xml】
</span><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="UTF-8" </span><span style="color: #0000ff;">?&gt;</span>
<span style="color: #0000ff;">&lt;!</span><span style="color: #ff00ff;">DOCTYPE configuration
        PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-config.dtd"</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">configuration</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">properties </span><span style="color: #ff0000;">resource</span><span style="color: #0000ff;">="config/db.properties"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">properties</span><span style="color: #0000ff;">&gt;</span>

    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">environments </span><span style="color: #ff0000;">default</span><span style="color: #0000ff;">="development"</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">environment </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="development"</span><span style="color: #0000ff;">&gt;</span>
            <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">transactionManager </span><span style="color: #ff0000;">type</span><span style="color: #0000ff;">="JDBC"</span><span style="color: #0000ff;">/&gt;</span>
            <span style="color: #008000;">&lt;!--</span><span style="color: #008000;"> MyBatis自带连接池，只需配置数据库连接的一些数据即可
                       此处以MySql为例。
                   </span><span style="color: #008000;">--&gt;</span>
            <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">dataSource </span><span style="color: #ff0000;">type</span><span style="color: #0000ff;">="POOLED"</span><span style="color: #0000ff;">&gt;</span>
                <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">property </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">="driver"</span><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">="${jdbc.driver}"</span><span style="color: #0000ff;">/&gt;</span>
                <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">property </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">="url"</span><span style="color: #ff0000;">
                          value</span><span style="color: #0000ff;">="${jdbc.url}"</span><span style="color: #0000ff;">/&gt;</span>
                <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">property </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">="username"</span><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">="${jdbc.username}"</span><span style="color: #0000ff;">/&gt;</span>
                <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">property </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">="password"</span><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">="${jdbc.password}"</span><span style="color: #0000ff;">/&gt;</span>
            <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">dataSource</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">environment</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">environments</span><span style="color: #0000ff;">&gt;</span>

    <span style="color: #008000;">&lt;!--</span><span style="color: #008000;"> 加载SQL定义文件，需要修改
        若有多个SQL定义文件，可以使用&lt;mapper /&gt;标签追加。
          文件路径中存在.的话，使用/分割
     </span><span style="color: #008000;">--&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">mappers</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">mapper </span><span style="color: #ff0000;">resource</span><span style="color: #0000ff;">="config/EmpMapper.xml"</span><span style="color: #0000ff;">/&gt;</span>
    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">mappers</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">configuration</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">


【entity.Employee】
package entity;

import java.io.Serializable;

/**
 * 实体类
 */
public class Employee implements Serializable {
    private Integer id;
    private String name;
    private Double salary;
    private Integer age;

    public Employee() {
    }

    public Employee(Integer id, String name, Double salary, Integer age) {
        this.id = id;
        this.name = name;
        this.salary = salary;
        this.age = age;
    }

    public Integer getId() {
        return id;
    }

    public void setId(Integer id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public Double getSalary() {
        return salary;
    }

    public void setSalary(Double salary) {
        this.salary = salary;
    }

    public Integer getAge() {
        return age;
    }

    public void setAge(Integer age) {
        this.age = age;
    }

    @Override
    public String toString() {
        return "Employee{" +
                "id=" + id +
                ", name='" + name + '\'' +
                ", salary=" + salary +
                ", age=" + age +
                '}';
    }
}



【mapper.EmpMapper】
package mapper;

import entity.Employee;
import org.apache.ibatis.annotations.Select;

/**
 * 接口式编程，定义一系列方法，并根据方法映射到sql 的xml 文件中。
 * 其中，返回值类型可以是 Integer、Long、Boolean、void 、实体类
 */
public interface EmpMapper {
    public Employee getEmpById(Integer id);
    public Long addEmp(Employee emp);
    public Boolean updateEmp(Employee emp);
    public Integer deleteEmpById(Integer id);
}



【config/EmpMapper.xml】
</span><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="UTF-8" </span><span style="color: #0000ff;">?&gt;</span>
<span style="color: #0000ff;">&lt;!</span><span style="color: #ff00ff;">DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">mapper </span><span style="color: #ff0000;">namespace</span><span style="color: #0000ff;">="mapper.EmpMapper"</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">insert </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="addEmp"</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
        INSERT INTO emp(emp.name, emp.salary, emp.age) VALUES (#{name}, #{salary}, #{age})
    </span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">insert</span><span style="color: #0000ff;">&gt;</span>

    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">delete </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="deleteEmpById"</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
        DELETE FROM emp WHERE emp.id = #{id}
    </span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">delete</span><span style="color: #0000ff;">&gt;</span>

    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">update </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="updateEmp"</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
        UPDATE emp SET emp.salary = #{salary}, emp.age = #{age}, emp.name = #{name} WHERE emp.id = #{id}
    </span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">update</span><span style="color: #0000ff;">&gt;</span>

    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">select </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="getEmpById"</span><span style="color: #ff0000;"> resultType</span><span style="color: #0000ff;">="entity.Employee"</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
        SELECT * FROM emp WHERE emp.id = #{id}
    </span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">select</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">mapper</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">


【test.Demo】
package test;

import entity.Employee;
import mapper.EmpMapper;
import org.apache.ibatis.io.Resources;
import org.apache.ibatis.session.SqlSession;
import org.apache.ibatis.session.SqlSessionFactory;
import org.apache.ibatis.session.SqlSessionFactoryBuilder;
import org.junit.Test;

import java.io.IOException;
import java.io.InputStream;

public class Demo {

    private static SqlSessionFactory getSqlSessionFactory() throws IOException {
        // step1：读取配置文件
        String resource = "config/mybatis-config.xml";
        InputStream inputStream = Resources.getResourceAsStream(resource);

        // step2：创建一个 SqlSessionFactory 的对象
        SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);

        return sqlSessionFactory;
    }

    @Test
    public void testAddEmp() throws IOException {
        // 获取一个 SqlSessionFactory 的对象
        SqlSessionFactory sqlSessionFactory = Demo.getSqlSessionFactory();
        // 获取一个 SqlSession 的实例
        SqlSession session = sqlSessionFactory.openSession();
        try{
            EmpMapper empMapper = session.getMapper(EmpMapper.class);
            Long result = empMapper.addEmp(new Employee(null,"jarry", 4000.0, 33));
            System.out.println(result);
            // 增删改需要 commit
            session.commit();
        }finally {
            // step4：关闭 SqlSession 实例
            session.close();
        }
    }

    @Test
    public void testDeleteEmpById() throws IOException {
        // 获取一个 SqlSessionFactory 的对象
        SqlSessionFactory sqlSessionFactory = Demo.getSqlSessionFactory();
        // 获取一个 SqlSession 的实例
        SqlSession session = sqlSessionFactory.openSession();
        try{
            EmpMapper empMapper = session.getMapper(EmpMapper.class);
            Integer result = empMapper.deleteEmpById(5);
            System.out.println(result);
            // 增删改需要 commit
            session.commit();
        }finally {
            // step4：关闭 SqlSession 实例
            session.close();
        }
    }

    @Test
    public void testUpdateEmp() throws IOException {
        // 获取一个 SqlSessionFactory 的对象
        SqlSessionFactory sqlSessionFactory = Demo.getSqlSessionFactory();
        // 获取一个 SqlSession 的实例
        SqlSession session = sqlSessionFactory.openSession();
        try{
            EmpMapper empMapper = session.getMapper(EmpMapper.class);
            Boolean result = empMapper.updateEmp(new Employee(1,"jarry", 4000.0, 33));
            System.out.println(result);
            // 增删改需要 commit
            session.commit();
        }finally {
            // step4：关闭 SqlSession 实例
            session.close();
        }
    }

    @Test
    public void testGetEmpById() throws IOException {
        // 获取一个 SqlSessionFactory 的对象
        SqlSessionFactory sqlSessionFactory = Demo.getSqlSessionFactory();
        // 获取一个 SqlSession 的实例
        SqlSession session = sqlSessionFactory.openSession();
        try{
            EmpMapper empMapper = session.getMapper(EmpMapper.class);
            Employee result = empMapper.getEmpById(1);
            System.out.println(result);
            // 增删改需要 commit
            session.commit();
        }finally {
            // step4：关闭 SqlSession 实例
            session.close();
        }
    }
}</span></code></pre>

<p>&nbsp;</p>
<p>step3：测试截图<br />（1）添加一条数据</p>
<p><img src="./images/MyBatis映射文件 相关操作1.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>（2）删除一条数据</p>
<p><img src="./images/MyBatis映射文件 相关操作2.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>（3）更新一条数据</p>
<p><img src="./images/MyBatis映射文件 相关操作3.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>（4）查询一条数据</p>
<p><img src="./images/MyBatis映射文件 相关操作4.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h3>3、返回自增的主键（支持自增的数据库，比如mysql等）</h3>
<p>　　需要使用 useGeneratedKeys（默认为false） 与 keyProperty（指定主键）。<br />　　mybatis 内部 会调用 getGeneratedKeys 方法并进行封装。</p>
<src class="cnblogs_code">
<pre><code><span style="color: #000000;">【对 测试 代码进行修改】
@Test
public void testAddEmp() throws IOException {
    // 获取一个 SqlSessionFactory 的对象
    SqlSessionFactory sqlSessionFactory = Demo.getSqlSessionFactory();
    // 获取一个 SqlSession 的实例
    SqlSession session = sqlSessionFactory.openSession();
    try{
        EmpMapper empMapper = session.getMapper(EmpMapper.class);
        Employee employee = new Employee(null,"tom", 4000.0, 33);
        System.out.println(employee);
        Long result = empMapper.addEmp(employee);
        System.out.println(employee);
        System.out.println(result);
        // 增删改需要 commit
        session.commit();
    }finally {
        // step4：关闭 SqlSession 实例
        session.close();
    }
}</span></code></pre>

<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;不会自动返回主键。</p>
<p><img src="./images/MyBatis映射文件 相关操作5.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>增加 useGeneratedKeys 与 keyProperty。</p>
<src class="cnblogs_code">
<pre><code><span style="color: #000000;">【对sql映射文件进行修改】
</span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">insert </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="addEmp"</span><span style="color: #ff0000;"> useGeneratedKeys</span><span style="color: #0000ff;">="true"</span><span style="color: #ff0000;"> keyProperty</span><span style="color: #0000ff;">="id"</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
    INSERT INTO emp(emp.name, emp.salary, emp.age) VALUES (#{name}, #{salary}, #{age})
</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">insert</span><span style="color: #0000ff;">&gt;</span></code></pre>

<p>会自动映射主键。</p>
<p><img src="./images/MyBatis映射文件 相关操作6.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h3>4、返回非自增的主键（使用mysql模拟非自增的数据库）</h3>
<p>　　使用 selectKey 标签来指定。<br />　　创建一个表（不使用auto_increment定义自增主键）。</p>
<p><img src="./images/MyBatis映射文件 相关操作7.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>将sql映射文件的 表名 换为 emp2。进行增加数据操作。</p>
<src class="cnblogs_code">
<pre><code><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">insert </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="addEmp"</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
    INSERT INTO emp2(emp2.id, emp2.name, emp2.salary, emp2.age) VALUES (#{id}, #{name}, #{salary}, #{age})
</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">insert</span><span style="color: #0000ff;">&gt;</span></code></pre>

<p>主键不会自动映射。</p>
<p><img src="./images/MyBatis映射文件 相关操作8.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>使用 selectKey ，可以指定 主键。 resultType 为返回值类型。 order 为 BEFORE|AFTER（决定什么时候执行）。</p>
<src class="cnblogs_code">
<pre><code><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">insert </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="addEmp"</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">selectKey </span><span style="color: #ff0000;">keyProperty</span><span style="color: #0000ff;">="id"</span><span style="color: #ff0000;"> order</span><span style="color: #0000ff;">="BEFORE"</span><span style="color: #ff0000;"> resultType</span><span style="color: #0000ff;">="Integer"</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
        SELECT max(id) + 10 FROM emp2
    </span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">selectKey</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
    INSERT INTO emp2(emp2.id, emp2.name, emp2.salary, emp2.age) VALUES (#{id}, #{name}, #{salary}, #{age})
</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">insert</span><span style="color: #0000ff;">&gt;</span></code></pre>

<p>自动映射主键。</p>
<p><img src="./images/MyBatis映射文件 相关操作9.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2>二、参数处理</h2>
<h3>1、单个参数</h3>
<p>　　对于单个参数，直接使用 #{变量名} 即可获取。</p>
<src class="cnblogs_code">
<pre><code><span style="color: #000000;">【mapper.EmpMapper】
package mapper;

import entity.Employee;
import org.apache.ibatis.annotations.Select;

/**
 * 接口式编程，定义一系列方法，并根据方法映射到sql 的xml 文件中。
 * 其中，返回值类型可以是 Integer、Long、Boolean、void 、实体类
 */
public interface EmpMapper {
    public Employee getEmpById(Integer id);
}


【config/EmpMapper.xml】
</span><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="UTF-8" </span><span style="color: #0000ff;">?&gt;</span>
<span style="color: #0000ff;">&lt;!</span><span style="color: #ff00ff;">DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">mapper </span><span style="color: #ff0000;">namespace</span><span style="color: #0000ff;">="mapper.EmpMapper"</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">select </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="getEmpById"</span><span style="color: #ff0000;"> resultType</span><span style="color: #0000ff;">="entity.Employee"</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
        SELECT * FROM emp WHERE emp.id = #{id}
    </span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">select</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">mapper</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">


【test.Demo】
package test;

import entity.Employee;
import mapper.EmpMapper;
import org.apache.ibatis.io.Resources;
import org.apache.ibatis.session.SqlSession;
import org.apache.ibatis.session.SqlSessionFactory;
import org.apache.ibatis.session.SqlSessionFactoryBuilder;
import org.junit.Test;

import java.io.IOException;
import java.io.InputStream;

public class Demo {

    private static SqlSessionFactory getSqlSessionFactory() throws IOException {
        // step1：读取配置文件
        String resource = "config/mybatis-config.xml";
        InputStream inputStream = Resources.getResourceAsStream(resource);

        // step2：创建一个 SqlSessionFactory 的对象
        SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);

        return sqlSessionFactory;
    }

    @Test
    public void testGetEmpById() throws IOException {
        // 获取一个 SqlSessionFactory 的对象
        SqlSessionFactory sqlSessionFactory = Demo.getSqlSessionFactory();
        // 获取一个 SqlSession 的实例
        SqlSession session = sqlSessionFactory.openSession();
        try{
            EmpMapper empMapper = session.getMapper(EmpMapper.class);
            Employee result = empMapper.getEmpById(1);
            System.out.println(result);
            // 增删改需要 commit
            session.commit();
        }finally {
            // step4：关闭 SqlSession 实例
            session.close();
        }
    }
}</span></code></pre>

<p>&nbsp;</p>
<p><img src="./images/MyBatis映射文件 相关操作10.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h3>2、多个参数（少量）</h3>
<p>　　对于多个参数，直接使用 #{变量名} 会抛出异常（可使用@param与之配合）。其内部会将其封装为一个map集合。</p>
<src class="cnblogs_code">
<pre><code><span style="color: #000000;">【mapper.EmpMapper】
package mapper;

import entity.Employee;
import org.apache.ibatis.annotations.Select;

/**
 * 接口式编程，定义一系列方法，并根据方法映射到sql 的xml 文件中。
 * 其中，返回值类型可以是 Integer、Long、Boolean、void 、实体类
 */
public interface EmpMapper {
    public Employee getEmpByIdAndName(Integer id, String name);
}


【config/EmpMapper.xml】
</span><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="UTF-8" </span><span style="color: #0000ff;">?&gt;</span>
<span style="color: #0000ff;">&lt;!</span><span style="color: #ff00ff;">DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">mapper </span><span style="color: #ff0000;">namespace</span><span style="color: #0000ff;">="mapper.EmpMapper"</span><span style="color: #0000ff;">&gt;</span>

    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">select </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="getEmpByIdAndName"</span><span style="color: #ff0000;"> resultType</span><span style="color: #0000ff;">="entity.Employee"</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
        SELECT * FROM emp WHERE emp.id = #{id} AND emp.name = #{name}
    </span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">select</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">mapper</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">


【test.Demo】
package test;

import entity.Employee;
import mapper.EmpMapper;
import org.apache.ibatis.io.Resources;
import org.apache.ibatis.session.SqlSession;
import org.apache.ibatis.session.SqlSessionFactory;
import org.apache.ibatis.session.SqlSessionFactoryBuilder;
import org.junit.Test;

import java.io.IOException;
import java.io.InputStream;

public class Demo {

    private static SqlSessionFactory getSqlSessionFactory() throws IOException {
        // step1：读取配置文件
        String resource = "config/mybatis-config.xml";
        InputStream inputStream = Resources.getResourceAsStream(resource);

        // step2：创建一个 SqlSessionFactory 的对象
        SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);

        return sqlSessionFactory;
    }

    @Test
    public void testGetEmpByIdAndName() throws IOException {
        // 获取一个 SqlSessionFactory 的对象
        SqlSessionFactory sqlSessionFactory = Demo.getSqlSessionFactory();
        // 获取一个 SqlSession 的实例
        SqlSession session = sqlSessionFactory.openSession();
        try{
            EmpMapper empMapper = session.getMapper(EmpMapper.class);
            Employee result = empMapper.getEmpByIdAndName(1, "jack");
            System.out.println(result);
            // 增删改需要 commit
            session.commit();
        }finally {
            // step4：关闭 SqlSession 实例
            session.close();
        }
    }
}</span></code></pre>

<p><img src="./images/MyBatis映射文件 相关操作11.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>參數名不对。修改如下</p>
<src class="cnblogs_code">
<pre><code><span style="color: #000000;">【config/EmpMapper.xml】
</span><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="UTF-8" </span><span style="color: #0000ff;">?&gt;</span>
<span style="color: #0000ff;">&lt;!</span><span style="color: #ff00ff;">DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">mapper </span><span style="color: #ff0000;">namespace</span><span style="color: #0000ff;">="mapper.EmpMapper"</span><span style="color: #0000ff;">&gt;</span>

    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">select </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="getEmpByIdAndName"</span><span style="color: #ff0000;"> resultType</span><span style="color: #0000ff;">="entity.Employee"</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
        SELECT * FROM emp WHERE emp.id = #{param1} AND emp.name = #{param2}
    </span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">select</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">mapper</span><span style="color: #0000ff;">&gt;</span></code></pre>

<p>&nbsp;</p>
<p><img src="./images/MyBatis映射文件 相关操作12.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>若想使用 #{id} 等来获取参数， 可以使用 @param 注解并自定义名。</p>
<src class="cnblogs_code">
<pre><code><span style="color: #000000;">【mapper.EmpMapper.java】
package mapper;

import entity.Employee;
import org.apache.ibatis.annotations.Param;
import org.apache.ibatis.annotations.Select;

/**
 * 接口式编程，定义一系列方法，并根据方法映射到sql 的xml 文件中。
 * 其中，返回值类型可以是 Integer、Long、Boolean、void 、实体类
 */
public interface EmpMapper {
    public Employee getEmpByIdAndName(@Param("id") Integer id, @Param("name") String name);
}


【config/EmpMapper.xml】
</span><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="UTF-8" </span><span style="color: #0000ff;">?&gt;</span>
<span style="color: #0000ff;">&lt;!</span><span style="color: #ff00ff;">DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">mapper </span><span style="color: #ff0000;">namespace</span><span style="color: #0000ff;">="mapper.EmpMapper"</span><span style="color: #0000ff;">&gt;</span>

    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">select </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="getEmpByIdAndName"</span><span style="color: #ff0000;"> resultType</span><span style="color: #0000ff;">="entity.Employee"</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
        SELECT * FROM emp WHERE emp.id = #{id} AND emp.name = #{name}
    </span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">select</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">mapper</span><span style="color: #0000ff;">&gt;</span></code></pre>

<p><img src="./images/MyBatis映射文件 相关操作13.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h3>3、多个参数（过多）</h3>
<p>　　对于参数过多的时候，在方法参数中一个个定义明显不可取。<br />　　此时可以传递一个 自定义类 或者 一个map 集合。</p>
<src class="cnblogs_code">
<pre><code><span style="color: #000000;">【mapper.EmpMapper】
package mapper;

import entity.Employee;
import org.apache.ibatis.annotations.Param;

import java.util.Map;

/**
 * 接口式编程，定义一系列方法，并根据方法映射到sql 的xml 文件中。
 * 其中，返回值类型可以是 Integer、Long、Boolean、void 、实体类
 */
public interface EmpMapper {
    public Employee getEmpByMap(Map</span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">String</span><span style="color: #ff0000;">, Object</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;"> map);
}



【config/EmpMapper.xml】
</span><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="UTF-8" </span><span style="color: #0000ff;">?&gt;</span>
<span style="color: #0000ff;">&lt;!</span><span style="color: #ff00ff;">DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">mapper </span><span style="color: #ff0000;">namespace</span><span style="color: #0000ff;">="mapper.EmpMapper"</span><span style="color: #0000ff;">&gt;</span>

    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">select </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="getEmpByMap"</span><span style="color: #ff0000;"> resultType</span><span style="color: #0000ff;">="entity.Employee"</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
        SELECT * FROM emp WHERE emp.id = #{id} AND emp.name = #{name}
    </span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">select</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">mapper</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">



【test.Demo】
package test;

import entity.Employee;
import mapper.EmpMapper;
import org.apache.ibatis.io.Resources;
import org.apache.ibatis.session.SqlSession;
import org.apache.ibatis.session.SqlSessionFactory;
import org.apache.ibatis.session.SqlSessionFactoryBuilder;
import org.junit.Test;

import java.io.IOException;
import java.io.InputStream;
import java.util.HashMap;
import java.util.Map;

public class Demo {

    private static SqlSessionFactory getSqlSessionFactory() throws IOException {
        // step1：读取配置文件
        String resource = "config/mybatis-config.xml";
        InputStream inputStream = Resources.getResourceAsStream(resource);

        // step2：创建一个 SqlSessionFactory 的对象
        SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);

        return sqlSessionFactory;
    }

    @Test
    public void testGetEmpByMap() throws IOException {
        // 获取一个 SqlSessionFactory 的对象
        SqlSessionFactory sqlSessionFactory = Demo.getSqlSessionFactory();
        // 获取一个 SqlSession 的实例
        SqlSession session = sqlSessionFactory.openSession();
        try{
            EmpMapper empMapper = session.getMapper(EmpMapper.class);
            Map</span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">String</span><span style="color: #ff0000;">, Object</span><span style="color: #0000ff;">&gt;</span> map = new HashMap<span style="color: #0000ff;">&lt;&gt;</span><span style="color: #000000;">();
            map.put("id", 1);
            map.put("name", "jack");
            Employee result = empMapper.getEmpByMap(map);
            System.out.println(result);
            // 增删改需要 commit
            session.commit();
        }finally {
            // step4：关闭 SqlSession 实例
            session.close();
        }
    }
}</span></code></pre>

<p>&nbsp;</p>
<p><img src="./images/MyBatis映射文件 相关操作14.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h3>4、对于List集合</h3>
<p>　　可以使用 #{list[0]} 或者 #{collection[0]} 等格式来&middot;获取参数。</p>
<src class="cnblogs_code">
<pre><code><span style="color: #000000;">【mapper.EmpMapper】
package mapper;

import entity.Employee;
import org.apache.ibatis.annotations.Param;

import java.util.List;
import java.util.Map;

/**
 * 接口式编程，定义一系列方法，并根据方法映射到sql 的xml 文件中。
 * 其中，返回值类型可以是 Integer、Long、Boolean、void 、实体类
 */
public interface EmpMapper {
    public Employee getEmpByList(List</span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Integer</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;"> list);
}


【config/EmpMapper.xml】
</span><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="UTF-8" </span><span style="color: #0000ff;">?&gt;</span>
<span style="color: #0000ff;">&lt;!</span><span style="color: #ff00ff;">DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">mapper </span><span style="color: #ff0000;">namespace</span><span style="color: #0000ff;">="mapper.EmpMapper"</span><span style="color: #0000ff;">&gt;</span>

    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">select </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="getEmpByList"</span><span style="color: #ff0000;"> resultType</span><span style="color: #0000ff;">="entity.Employee"</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
        SELECT * FROM emp WHERE emp.id = #{collection[0]}
    </span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">select</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">mapper</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">



【test.Demo】
package test;

import entity.Employee;
import mapper.EmpMapper;
import org.apache.ibatis.io.Resources;
import org.apache.ibatis.session.SqlSession;
import org.apache.ibatis.session.SqlSessionFactory;
import org.apache.ibatis.session.SqlSessionFactoryBuilder;
import org.junit.Test;

import java.io.IOException;
import java.io.InputStream;
import java.util.ArrayList;
import java.util.List;


public class Demo {

    private static SqlSessionFactory getSqlSessionFactory() throws IOException {
        // step1：读取配置文件
        String resource = "config/mybatis-config.xml";
        InputStream inputStream = Resources.getResourceAsStream(resource);

        // step2：创建一个 SqlSessionFactory 的对象
        SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);

        return sqlSessionFactory;
    }

    @Test
    public void testGetEmpByList() throws IOException {
        // 获取一个 SqlSessionFactory 的对象
        SqlSessionFactory sqlSessionFactory = Demo.getSqlSessionFactory();
        // 获取一个 SqlSession 的实例
        SqlSession session = sqlSessionFactory.openSession();
        try{
            EmpMapper empMapper = session.getMapper(EmpMapper.class);
            List</span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Integer</span><span style="color: #0000ff;">&gt;</span> list = new ArrayList<span style="color: #0000ff;">&lt;&gt;</span><span style="color: #000000;">();
            list.add(1);
            list.add(2);
            list.add(3);
            Employee result = empMapper.getEmpByList(list);
            System.out.println(result);
            // 增删改需要 commit
            session.commit();
        }finally {
            // step4：关闭 SqlSession 实例
            session.close();
        }
    }
}</span></code></pre>

<p><img src="./images/MyBatis映射文件 相关操作15.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<src class="cnblogs_code">
<pre><code><span style="color: #000000;">【或者config/EmpMapper.xml】
</span><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="UTF-8" </span><span style="color: #0000ff;">?&gt;</span>
<span style="color: #0000ff;">&lt;!</span><span style="color: #ff00ff;">DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">mapper </span><span style="color: #ff0000;">namespace</span><span style="color: #0000ff;">="mapper.EmpMapper"</span><span style="color: #0000ff;">&gt;</span>

    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">select </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="getEmpByList"</span><span style="color: #ff0000;"> resultType</span><span style="color: #0000ff;">="entity.Employee"</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
        SELECT * FROM emp WHERE emp.id = #{list[0]}
    </span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">select</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">mapper</span><span style="color: #0000ff;">&gt;</span></code></pre>

<p>&nbsp;</p>
<p><img src="./images/MyBatis映射文件 相关操作16.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h3>5、#{} 与 ${} 的区别</h3>
<p>　　使用 #{} 或者 ${} 都可以获取 参数的值。<br />　　但是 #{} 是以预编译的方式， 将参数设置到 sql 语句中。 类似于 PreparedStatement。<br />　　${} 是直接将值放在sql 语句中。类似于 Statement。</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2>三、select的返回值映射处理--resultType&nbsp;</h2>
<h3>1、返回值类型为 List。</h3>
<p>　　&lt;select&gt; 标签定义查询操作，<br />　　其中 id 唯一标识 sql（与接口的方法同名）。<br />　　resultType 为返回值类型。若返回的为List集合，则返回的为泛型而非 list。比如 List&lt;Employee&gt; ，则 resultType =&ldquo;Employee&rdquo;， 而非 resultType =&ldquo;list&rdquo;。</p>
<src class="cnblogs_code">
<pre><code><span style="color: #000000;">【mapper.EmpMapper】
package mapper;

import entity.Employee;

import java.util.List;

/**
 * 接口式编程，定义一系列方法，并根据方法映射到sql 的xml 文件中。
 * 其中，返回值类型可以是 Integer、Long、Boolean、void 、实体类
 */
public interface EmpMapper {
    public List</span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Employee</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;"> getAllEmp();
}


【config/EmpMapper.xml】
</span><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="UTF-8" </span><span style="color: #0000ff;">?&gt;</span>
<span style="color: #0000ff;">&lt;!</span><span style="color: #ff00ff;">DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">mapper </span><span style="color: #ff0000;">namespace</span><span style="color: #0000ff;">="mapper.EmpMapper"</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">select </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="getAllEmp"</span><span style="color: #ff0000;"> resultType</span><span style="color: #0000ff;">="entity.Employee"</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
        SELECT * FROM emp
    </span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">select</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">mapper</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">



【test.Demo】
package test;

import entity.Employee;
import mapper.EmpMapper;
import org.apache.ibatis.io.Resources;
import org.apache.ibatis.session.SqlSession;
import org.apache.ibatis.session.SqlSessionFactory;
import org.apache.ibatis.session.SqlSessionFactoryBuilder;
import org.junit.Test;

import java.io.IOException;
import java.io.InputStream;
import java.util.List;

public class Demo {

    private static SqlSessionFactory getSqlSessionFactory() throws IOException {
        // step1：读取配置文件
        String resource = "config/mybatis-config.xml";
        InputStream inputStream = Resources.getResourceAsStream(resource);

        // step2：创建一个 SqlSessionFactory 的对象
        SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);

        return sqlSessionFactory;
    }

    @Test
    public void testGetEmpById() throws IOException {
        // 获取一个 SqlSessionFactory 的对象
        SqlSessionFactory sqlSessionFactory = Demo.getSqlSessionFactory();
        // 获取一个 SqlSession 的实例
        SqlSession session = sqlSessionFactory.openSession();
        try{
            EmpMapper empMapper = session.getMapper(EmpMapper.class);
            List</span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Employee</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;"> result = empMapper.getAllEmp();
            for(Employee emp : result){
                System.out.println(emp);
            }
        }finally {
            // step4：关闭 SqlSession 实例
            session.close();
        }
    }
}</span></code></pre>

<p>&nbsp;</p>
<p><img src="./images/MyBatis映射文件 相关操作17.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h3>2、返回值类型为map</h3>
<p>　　若将一条数据返回为 map， 则 resultType = &ldquo;map&rdquo;。<br />　　若将多条数据返回为 map， 则 resultType = &ldquo;value的类型&rdquo;（需要使用@MapKey 指定key）。</p>
<src class="cnblogs_code">
<pre><code><span style="color: #000000;">【mapper.EmpMapper】
package mapper;

import entity.Employee;
import org.apache.ibatis.annotations.MapKey;

import java.util.Map;

/**
 * 接口式编程，定义一系列方法，并根据方法映射到sql 的xml 文件中。
 * 其中，返回值类型可以是 Integer、Long、Boolean、void 、实体类
 */
public interface EmpMapper {
    // 封装多条数据，且每个主键作为key，每条数据为 value
    @MapKey("id")
    public Map</span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Integer</span><span style="color: #ff0000;">, Employee</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;"> getAllMap();

    // 封装一条数据，且每个字段名作为key，值为 value。
    public Map</span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">String</span><span style="color: #ff0000;">, Object</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;"> getEmpMap(Integer id);
}


【config/EmpMapper.xml】
</span><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="UTF-8" </span><span style="color: #0000ff;">?&gt;</span>
<span style="color: #0000ff;">&lt;!</span><span style="color: #ff00ff;">DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">mapper </span><span style="color: #ff0000;">namespace</span><span style="color: #0000ff;">="mapper.EmpMapper"</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">select </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="getAllMap"</span><span style="color: #ff0000;"> resultType</span><span style="color: #0000ff;">="entity.Employee"</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
        SELECT * FROM emp
    </span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">select</span><span style="color: #0000ff;">&gt;</span>

    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">select </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="getEmpMap"</span><span style="color: #ff0000;"> resultType</span><span style="color: #0000ff;">="map"</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
        SELECT * FROM emp WHERE id = #{id}
    </span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">select</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">mapper</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">


【test.Demo】
package test;

import entity.Employee;
import mapper.EmpMapper;
import org.apache.ibatis.io.Resources;
import org.apache.ibatis.session.SqlSession;
import org.apache.ibatis.session.SqlSessionFactory;
import org.apache.ibatis.session.SqlSessionFactoryBuilder;
import org.junit.Test;

import java.io.IOException;
import java.io.InputStream;
import java.util.List;
import java.util.Map;

public class Demo {

    private static SqlSessionFactory getSqlSessionFactory() throws IOException {
        // step1：读取配置文件
        String resource = "config/mybatis-config.xml";
        InputStream inputStream = Resources.getResourceAsStream(resource);

        // step2：创建一个 SqlSessionFactory 的对象
        SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);

        return sqlSessionFactory;
    }

    @Test
    public void testGetAllMap() throws IOException {
        // 获取一个 SqlSessionFactory 的对象
        SqlSessionFactory sqlSessionFactory = Demo.getSqlSessionFactory();
        // 获取一个 SqlSession 的实例
        SqlSession session = sqlSessionFactory.openSession();
        try {
            EmpMapper empMapper = session.getMapper(EmpMapper.class);
            Map</span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Integer</span><span style="color: #ff0000;">, Employee</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;"> result = empMapper.getAllMap();
            System.out.println(result);
        } finally {
            // step4：关闭 SqlSession 实例
            session.close();
        }
    }

    @Test
    public void testGetEmpMap() throws IOException {
        // 获取一个 SqlSessionFactory 的对象
        SqlSessionFactory sqlSessionFactory = Demo.getSqlSessionFactory();
        // 获取一个 SqlSession 的实例
        SqlSession session = sqlSessionFactory.openSession();
        try {
            EmpMapper empMapper = session.getMapper(EmpMapper.class);
            Map</span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">String</span><span style="color: #ff0000;">, Object</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;"> result = empMapper.getEmpMap(1);
            System.out.println(result);
        } finally {
            // step4：关闭 SqlSession 实例
            session.close();
        }
    }
}</span></code></pre>

<p>&nbsp;</p>
<p><img src="./images/MyBatis映射文件 相关操作18.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><img src="./images/MyBatis映射文件 相关操作19.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2>四、select的返回值映射处理--resultMap</h2>
<h3>1、普通映射</h3>
<p>　　使用resultMap 可以自定义结果集映射规则。使用 resultMap 与 resultType 时只能二选一。<br />　　比如：将 emp 的name 字段 修改为 last_name（但是实体类不做修改）。</p>
<p><img src="./images/MyBatis映射文件 相关操作20.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<src class="cnblogs_code">
<pre><code><span style="color: #000000;">【mapper.EmpMapper】
package mapper;

import entity.Employee;

import java.util.Map;

/**
 * 接口式编程，定义一系列方法，并根据方法映射到sql 的xml 文件中。
 * 其中，返回值类型可以是 Integer、Long、Boolean、void 、实体类
 */
public interface EmpMapper {
    public Employee getEmpById(Integer id);
}


【config/EmpMapper.xml】
</span><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="UTF-8" </span><span style="color: #0000ff;">?&gt;</span>
<span style="color: #0000ff;">&lt;!</span><span style="color: #ff00ff;">DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">mapper </span><span style="color: #ff0000;">namespace</span><span style="color: #0000ff;">="mapper.EmpMapper"</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">select </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="getEmpById"</span><span style="color: #ff0000;"> resultType</span><span style="color: #0000ff;">="entity.Employee"</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
        SELECT * FROM emp WHERE id = #{id}
    </span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">select</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">mapper</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">


【entity.Employee】
package entity;

import java.io.Serializable;

/**
 * 实体类
 */
public class Employee implements Serializable {
    private Integer id;
    private String name;
    private Double salary;
    private Integer age;

    public Employee() {
    }

    public Employee(Integer id, String name, Double salary, Integer age) {
        this.id = id;
        this.name = name;
        this.salary = salary;
        this.age = age;
    }

    public Integer getId() {
        return id;
    }

    public void setId(Integer id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public Double getSalary() {
        return salary;
    }

    public void setSalary(Double salary) {
        this.salary = salary;
    }

    public Integer getAge() {
        return age;
    }

    public void setAge(Integer age) {
        this.age = age;
    }

    @Override
    public String toString() {
        return "Employee{" +
                "id=" + id +
                ", name='" + name + '\'' +
                ", salary=" + salary +
                ", age=" + age +
                '}';
    }
}



【test.Demo】
package test;

import entity.Employee;
import mapper.EmpMapper;
import org.apache.ibatis.io.Resources;
import org.apache.ibatis.session.SqlSession;
import org.apache.ibatis.session.SqlSessionFactory;
import org.apache.ibatis.session.SqlSessionFactoryBuilder;
import org.junit.Test;

import java.io.IOException;
import java.io.InputStream;

public class Demo {

    private static SqlSessionFactory getSqlSessionFactory() throws IOException {
        // step1：读取配置文件
        String resource = "config/mybatis-config.xml";
        InputStream inputStream = Resources.getResourceAsStream(resource);

        // step2：创建一个 SqlSessionFactory 的对象
        SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);

        return sqlSessionFactory;
    }

    @Test
    public void testGetEmpByIdAndName() throws IOException {
        // 获取一个 SqlSessionFactory 的对象
        SqlSessionFactory sqlSessionFactory = Demo.getSqlSessionFactory();
        // 获取一个 SqlSession 的实例
        SqlSession session = sqlSessionFactory.openSession();
        try {
            EmpMapper empMapper = session.getMapper(EmpMapper.class);
            Employee result = empMapper.getEmpById(1);
            System.out.println(result);
        } finally {
            // step4：关闭 SqlSession 实例
            session.close();
        }
    }
}</span></code></pre>

<p>&nbsp;</p>
<p>使用 resultType 映射肯定会出现问题。</p>
<p><img src="./images/MyBatis映射文件 相关操作21.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>使用 resultMap 自定义映射规则， 将 last_name 映射到 name。</p>
<src class="cnblogs_code">
<pre><code><span style="color: #000000;">【config/EmpMapper.xml】
</span><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="UTF-8" </span><span style="color: #0000ff;">?&gt;</span>
<span style="color: #0000ff;">&lt;!</span><span style="color: #ff00ff;">DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">mapper </span><span style="color: #ff0000;">namespace</span><span style="color: #0000ff;">="mapper.EmpMapper"</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #008000;">&lt;!--</span><span style="color: #008000;">
        使用resultMap 定义一个自定义一个封装规则。
        id 用于唯一标识该规则。
        type 用于指定返回值类型
    </span><span style="color: #008000;">--&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">resultMap </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="myEmp"</span><span style="color: #ff0000;"> type</span><span style="color: #0000ff;">="entity.Employee"</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #008000;">&lt;!--</span><span style="color: #008000;"> 使用 id 标签 用于指定主键，column 用于指定列，property 用于指定映射后的属性名 </span><span style="color: #008000;">--&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">id </span><span style="color: #ff0000;">column</span><span style="color: #0000ff;">="id"</span><span style="color: #ff0000;"> property</span><span style="color: #0000ff;">="id"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">id</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #008000;">&lt;!--</span><span style="color: #008000;"> result 用于指定 普通列 </span><span style="color: #008000;">--&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">result </span><span style="color: #ff0000;">column</span><span style="color: #0000ff;">="last_name"</span><span style="color: #ff0000;"> property</span><span style="color: #0000ff;">="name"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">result</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">resultMap</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">select </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="getEmpById"</span><span style="color: #ff0000;"> resultMap</span><span style="color: #0000ff;">="myEmp"</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
        SELECT * FROM emp WHERE id = #{id}
    </span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">select</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">mapper</span><span style="color: #0000ff;">&gt;</span></code></pre>

<p>&nbsp;</p>
<p><img src="./images/MyBatis映射文件 相关操作22.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h3>2、关联映射 -- 级联查询</h3>
<p>　　增加一个 department 表，并将其主键作为 emp 表的外键。</p>
<src class="cnblogs_code">
<pre><code><span style="color: #000000;">CREATE TABLE department(
    deptId INT(11) PRIMARY KEY AUTO_INCREMENT,
    deptName VARCHAR(255)
);

ALTER TABLE emp ADD COLUMN deptId INT(11);

ALTER TABLE emp ADD CONSTRAINT fk_emp_department
FOREIGN KEY(deptId) REFERENCES department(deptId)</span></code></pre>

<p>&nbsp;</p>
<p><img src="./images/MyBatis映射文件 相关操作23.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>使用 resultMap 将 查询的结果集 映射到 最终显示的结果集上。即（column -》 property）。<br />可以使用级联属性赋值。格式：A.B</p>
<src class="cnblogs_code">
<pre><code><span style="color: #000000;">【mapper.EmpMapper】
package mapper;

import entity.Employee;

/**
 * 接口式编程，定义一系列方法，并根据方法映射到sql 的xml 文件中。
 * 其中，返回值类型可以是 Integer、Long、Boolean、void 、实体类
 */
public interface EmpMapper {
    public Employee getEmpAndDeptById(Integer id);
}


【config/EmpMapper.xml】
</span><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="UTF-8" </span><span style="color: #0000ff;">?&gt;</span>
<span style="color: #0000ff;">&lt;!</span><span style="color: #ff00ff;">DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">mapper </span><span style="color: #ff0000;">namespace</span><span style="color: #0000ff;">="mapper.EmpMapper"</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">resultMap </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="myMap"</span><span style="color: #ff0000;"> type</span><span style="color: #0000ff;">="entity.Employee"</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">id </span><span style="color: #ff0000;">column</span><span style="color: #0000ff;">="e_id"</span><span style="color: #ff0000;"> property</span><span style="color: #0000ff;">="id"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">id</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">result </span><span style="color: #ff0000;">column</span><span style="color: #0000ff;">="e_name"</span><span style="color: #ff0000;"> property</span><span style="color: #0000ff;">="name"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">result</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">result </span><span style="color: #ff0000;">column</span><span style="color: #0000ff;">="e_salary"</span><span style="color: #ff0000;"> property</span><span style="color: #0000ff;">="salary"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">result</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">result </span><span style="color: #ff0000;">column</span><span style="color: #0000ff;">="e_age"</span><span style="color: #ff0000;"> property</span><span style="color: #0000ff;">="age"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">result</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">result </span><span style="color: #ff0000;">column</span><span style="color: #0000ff;">="d_id"</span><span style="color: #ff0000;"> property</span><span style="color: #0000ff;">="department.deptId"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">result</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">result </span><span style="color: #ff0000;">column</span><span style="color: #0000ff;">="d_name"</span><span style="color: #ff0000;"> property</span><span style="color: #0000ff;">="department.deptName"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">result</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">resultMap</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">select </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="getEmpAndDeptById"</span><span style="color: #ff0000;"> resultMap</span><span style="color: #0000ff;">="myMap"</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
        SELECT e.id e_id, e.last_name e_name, e.age e_age, e.salary e_salary, d.deptId d_id, d.deptName d_name
          FROM emp e, department d
         WHERE e.deptId = d.deptId
           AND e.id = #{id}
    </span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">select</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">mapper</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">


【entity.Employee.java】
package entity;

import java.io.Serializable;

/**
 * 实体类
 */
public class Employee implements Serializable {
    private Integer id;
    private String name;
    private Double salary;
    private Integer age;
    private Department department;

    public Employee() {
    }

    public Employee(Integer id, String name, Double salary, Integer age) {
        this.id = id;
        this.name = name;
        this.salary = salary;
        this.age = age;
    }

    public Integer getId() {
        return id;
    }

    public void setId(Integer id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public Double getSalary() {
        return salary;
    }

    public void setSalary(Double salary) {
        this.salary = salary;
    }

    public Integer getAge() {
        return age;
    }

    public void setAge(Integer age) {
        this.age = age;
    }

    public Department getDepartment() {
        return department;
    }

    public void setDepartment(Department department) {
        this.department = department;
    }

    @Override
    public String toString() {
        return "Employee{" +
                "id=" + id +
                ", name='" + name + '\'' +
                ", salary=" + salary +
                ", age=" + age +
                ", department=" + department +
                '}';
    }
}



【entity.Department.java】
package entity;

public class Department {
    private Integer deptId;
    private String deptName;

    public Integer getDeptId() {
        return deptId;
    }

    public void setDeptId(Integer deptId) {
        this.deptId = deptId;
    }

    public String getDeptName() {
        return deptName;
    }

    public void setDeptName(String deptName) {
        this.deptName = deptName;
    }

    @Override
    public String toString() {
        return "Department{" +
                "deptId=" + deptId +
                ", deptName='" + deptName + '\'' +
                '}';
    }
}



【test.Demo】
package test;

import entity.Employee;
import mapper.EmpMapper;
import org.apache.ibatis.io.Resources;
import org.apache.ibatis.session.SqlSession;
import org.apache.ibatis.session.SqlSessionFactory;
import org.apache.ibatis.session.SqlSessionFactoryBuilder;
import org.junit.Test;

import java.io.IOException;
import java.io.InputStream;

public class Demo {

    private static SqlSessionFactory getSqlSessionFactory() throws IOException {
        // step1：读取配置文件
        String resource = "config/mybatis-config.xml";
        InputStream inputStream = Resources.getResourceAsStream(resource);

        // step2：创建一个 SqlSessionFactory 的对象
        SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);

        return sqlSessionFactory;
    }

    @Test
    public void testGetEmpByIdAndName() throws IOException {
        // 获取一个 SqlSessionFactory 的对象
        SqlSessionFactory sqlSessionFactory = Demo.getSqlSessionFactory();
        // 获取一个 SqlSession 的实例
        SqlSession session = sqlSessionFactory.openSession();
        try {
            EmpMapper empMapper = session.getMapper(EmpMapper.class);
            Employee result = empMapper.getEmpAndDeptById(1);
            System.out.println(result);
        } finally {
            // step4：关闭 SqlSession 实例
            session.close();
        }
    }
}</span></code></pre>

<p>&nbsp;</p>
<p><img src="./images/MyBatis映射文件 相关操作24.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h3>3、关联映射 -- 使用association关联普通对象</h3>
<p>　　除了级联属性赋值，可以使用 association 标签对关联的对象赋值。<br />　　对上例级联属性赋值代码进行修改。</p>
<src class="cnblogs_code">
<pre><code><span style="color: #000000;">【config/EmpMapper.xml】
</span><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="UTF-8" </span><span style="color: #0000ff;">?&gt;</span>
<span style="color: #0000ff;">&lt;!</span><span style="color: #ff00ff;">DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">mapper </span><span style="color: #ff0000;">namespace</span><span style="color: #0000ff;">="mapper.EmpMapper"</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">resultMap </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="myMap"</span><span style="color: #ff0000;"> type</span><span style="color: #0000ff;">="entity.Employee"</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">id </span><span style="color: #ff0000;">column</span><span style="color: #0000ff;">="e_id"</span><span style="color: #ff0000;"> property</span><span style="color: #0000ff;">="id"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">id</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">result </span><span style="color: #ff0000;">column</span><span style="color: #0000ff;">="e_name"</span><span style="color: #ff0000;"> property</span><span style="color: #0000ff;">="name"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">result</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">result </span><span style="color: #ff0000;">column</span><span style="color: #0000ff;">="e_salary"</span><span style="color: #ff0000;"> property</span><span style="color: #0000ff;">="salary"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">result</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">result </span><span style="color: #ff0000;">column</span><span style="color: #0000ff;">="e_age"</span><span style="color: #ff0000;"> property</span><span style="color: #0000ff;">="age"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">result</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #008000;">&lt;!--</span><span style="color: #008000;">
            property 用于指定 映射的属性
            JavaType 用于指定 映射的类型
         </span><span style="color: #008000;">--&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">association </span><span style="color: #ff0000;">property</span><span style="color: #0000ff;">="department"</span><span style="color: #ff0000;"> javaType</span><span style="color: #0000ff;">="entity.Department"</span><span style="color: #0000ff;">&gt;</span>
            <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">result </span><span style="color: #ff0000;">column</span><span style="color: #0000ff;">="d_id"</span><span style="color: #ff0000;"> property</span><span style="color: #0000ff;">="deptId"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">result</span><span style="color: #0000ff;">&gt;</span>
            <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">result </span><span style="color: #ff0000;">column</span><span style="color: #0000ff;">="d_name"</span><span style="color: #ff0000;"> property</span><span style="color: #0000ff;">="deptName"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">result</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">association</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">resultMap</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">select </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="getEmpAndDeptById"</span><span style="color: #ff0000;"> resultMap</span><span style="color: #0000ff;">="myMap"</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
        SELECT e.id e_id, e.last_name e_name, e.age e_age, e.salary e_salary, d.deptId d_id, d.deptName d_name
          FROM emp e, department d
         WHERE e.deptId = d.deptId
           AND e.id = #{id}
    </span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">select</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">mapper</span><span style="color: #0000ff;">&gt;</span></code></pre>

<p>&nbsp;</p>
<p><img src="./images/MyBatis映射文件 相关操作25.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h3>4、关联映射-- 分步查询 -- association</h3>
<p>　　接着对上例进行修改。<br />　　使用 association 的 select 属性，可以调用 另外的sql 语句， 从而实现分步查询的操作。</p>
<src class="cnblogs_code">
<pre><code><span style="color: #000000;">【config/EmpMapper.xml】
</span><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="UTF-8" </span><span style="color: #0000ff;">?&gt;</span>
<span style="color: #0000ff;">&lt;!</span><span style="color: #ff00ff;">DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">mapper </span><span style="color: #ff0000;">namespace</span><span style="color: #0000ff;">="mapper.EmpMapper"</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">resultMap </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="myMap"</span><span style="color: #ff0000;"> type</span><span style="color: #0000ff;">="entity.Employee"</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">id </span><span style="color: #ff0000;">column</span><span style="color: #0000ff;">="id"</span><span style="color: #ff0000;"> property</span><span style="color: #0000ff;">="id"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">id</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">result </span><span style="color: #ff0000;">column</span><span style="color: #0000ff;">="last_name"</span><span style="color: #ff0000;"> property</span><span style="color: #0000ff;">="name"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">result</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">result </span><span style="color: #ff0000;">column</span><span style="color: #0000ff;">="salary"</span><span style="color: #ff0000;"> property</span><span style="color: #0000ff;">="salary"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">result</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">result </span><span style="color: #ff0000;">column</span><span style="color: #0000ff;">="age"</span><span style="color: #ff0000;"> property</span><span style="color: #0000ff;">="age"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">result</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">association </span><span style="color: #ff0000;">property</span><span style="color: #0000ff;">="department"</span><span style="color: #ff0000;"> select</span><span style="color: #0000ff;">="getDeptById"</span><span style="color: #ff0000;"> column</span><span style="color: #0000ff;">="deptId"</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">association</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">resultMap</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">select </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="getEmpAndDeptById"</span><span style="color: #ff0000;"> resultMap</span><span style="color: #0000ff;">="myMap"</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
        SELECT * FROM emp WHERE id = #{id}
    </span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">select</span><span style="color: #0000ff;">&gt;</span>

    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">select </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="getDeptById"</span><span style="color: #ff0000;"> resultType</span><span style="color: #0000ff;">="entity.Department"</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
        SELECT * FROM department WHERE deptId = #{deptId}
    </span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">select</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">mapper</span><span style="color: #0000ff;">&gt;</span></code></pre>

<p>&nbsp;</p>
<p><img src="./images/MyBatis映射文件 相关操作26.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h3>5、关联映射 -- 关联集合对象 -- collection</h3>
<p>　　比如映射的对象是个 list 集合。<br />　　使用 collection 标签定义集合类型的封装规则。其属性 ofType 为集合的泛型，property 为映射的属性名。</p>
<src class="cnblogs_code">
<pre><code><span style="color: #000000;">【entity.Department】
package entity;

import java.util.List;

public class Department {
    private Integer deptId;
    private String deptName;
    private List</span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Employee</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;"> employeeList;

    public Integer getDeptId() {
        return deptId;
    }

    public void setDeptId(Integer deptId) {
        this.deptId = deptId;
    }

    public String getDeptName() {
        return deptName;
    }

    public void setDeptName(String deptName) {
        this.deptName = deptName;
    }

    public List</span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Employee</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;"> getEmployeeList() {
        return employeeList;
    }

    public void setEmployeeList(List</span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Employee</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;"> employeeList) {
        this.employeeList = employeeList;
    }

    @Override
    public String toString() {
        return "Department{" +
                "deptId=" + deptId +
                ", deptName='" + deptName + '\'' +
                ", employeeList=" + employeeList +
                '}';
    }
}



【mapper.EmpMapper.java】
package mapper;

import entity.Department;

/**
 * 接口式编程，定义一系列方法，并根据方法映射到sql 的xml 文件中。
 * 其中，返回值类型可以是 Integer、Long、Boolean、void 、实体类
 */
public interface EmpMapper {
    public Department getDeptById(Integer id);
}



【config/EmpMapper.xml】
</span><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="UTF-8" </span><span style="color: #0000ff;">?&gt;</span>
<span style="color: #0000ff;">&lt;!</span><span style="color: #ff00ff;">DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">mapper </span><span style="color: #ff0000;">namespace</span><span style="color: #0000ff;">="mapper.EmpMapper"</span><span style="color: #0000ff;">&gt;</span>

    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">resultMap </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="myMap"</span><span style="color: #ff0000;"> type</span><span style="color: #0000ff;">="entity.Department"</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">id </span><span style="color: #ff0000;">column</span><span style="color: #0000ff;">="deptId"</span><span style="color: #ff0000;"> property</span><span style="color: #0000ff;">="deptId"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">id</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">result </span><span style="color: #ff0000;">column</span><span style="color: #0000ff;">="deptName"</span><span style="color: #ff0000;"> property</span><span style="color: #0000ff;">="deptName"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">result</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #008000;">&lt;!--</span><span style="color: #008000;">
            collection 标签用于定义集合类型的封装规则。
            ofType 为集合的泛型
            property 为映射的属性名
        </span><span style="color: #008000;">--&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">collection </span><span style="color: #ff0000;">property</span><span style="color: #0000ff;">="employeeList"</span><span style="color: #ff0000;"> ofType</span><span style="color: #0000ff;">="entity.Employee"</span><span style="color: #0000ff;">&gt;</span>
            <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">id </span><span style="color: #ff0000;">column</span><span style="color: #0000ff;">="e_id"</span><span style="color: #ff0000;"> property</span><span style="color: #0000ff;">="id"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">id</span><span style="color: #0000ff;">&gt;</span>
            <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">result </span><span style="color: #ff0000;">column</span><span style="color: #0000ff;">="e_name"</span><span style="color: #ff0000;"> property</span><span style="color: #0000ff;">="name"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">result</span><span style="color: #0000ff;">&gt;</span>
            <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">result </span><span style="color: #ff0000;">column</span><span style="color: #0000ff;">="e_salary"</span><span style="color: #ff0000;"> property</span><span style="color: #0000ff;">="salary"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">result</span><span style="color: #0000ff;">&gt;</span>
            <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">result </span><span style="color: #ff0000;">column</span><span style="color: #0000ff;">="e_age"</span><span style="color: #ff0000;"> property</span><span style="color: #0000ff;">="age"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">result</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">collection</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">resultMap</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">select </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="getDeptById"</span><span style="color: #ff0000;"> resultMap</span><span style="color: #0000ff;">="myMap"</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
        SELECT d.deptId deptId, d.deptName deptName, e.id e_id, e.last_name e_name, e.age e_age, e.salary e_salary
          FROM  department d
     LEFT JOIN emp e
            ON  e.deptId = d.deptId
         WHERE d.deptId = #{id}
    </span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">select</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">mapper</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">


【test.Demo】
package test;

import entity.Department;
import entity.Employee;
import mapper.EmpMapper;
import org.apache.ibatis.io.Resources;
import org.apache.ibatis.session.SqlSession;
import org.apache.ibatis.session.SqlSessionFactory;
import org.apache.ibatis.session.SqlSessionFactoryBuilder;
import org.junit.Test;

import java.io.IOException;
import java.io.InputStream;

public class Demo {

    private static SqlSessionFactory getSqlSessionFactory() throws IOException {
        // step1：读取配置文件
        String resource = "config/mybatis-config.xml";
        InputStream inputStream = Resources.getResourceAsStream(resource);

        // step2：创建一个 SqlSessionFactory 的对象
        SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);

        return sqlSessionFactory;
    }

    @Test
    public void testGetDeptById() throws IOException {
        // 获取一个 SqlSessionFactory 的对象
        SqlSessionFactory sqlSessionFactory = Demo.getSqlSessionFactory();
        // 获取一个 SqlSession 的实例
        SqlSession session = sqlSessionFactory.openSession();
        try {
            EmpMapper empMapper = session.getMapper(EmpMapper.class);
            Department result = empMapper.getDeptById(1);
            System.out.println(result);
            for(Employee employee : result.getEmployeeList()){
                System.out.println(employee);
            }
        } finally {
            // step4：关闭 SqlSession 实例
            session.close();
        }
    }
}</span></code></pre>

<p>&nbsp;</p>
<p><img src="./images/MyBatis映射文件 相关操作27.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h3>6、关联映射-- 分步查询 -- collection</h3>
<p>　　对上例代码稍作修改。即可实现分步查询。</p>
<src class="cnblogs_code">
<pre><code><span style="color: #000000;">【config/EmpMapper.xml】
</span><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="UTF-8" </span><span style="color: #0000ff;">?&gt;</span>
<span style="color: #0000ff;">&lt;!</span><span style="color: #ff00ff;">DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">mapper </span><span style="color: #ff0000;">namespace</span><span style="color: #0000ff;">="mapper.EmpMapper"</span><span style="color: #0000ff;">&gt;</span>

    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">resultMap </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="myMap"</span><span style="color: #ff0000;"> type</span><span style="color: #0000ff;">="entity.Department"</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">id </span><span style="color: #ff0000;">column</span><span style="color: #0000ff;">="deptId"</span><span style="color: #ff0000;"> property</span><span style="color: #0000ff;">="deptId"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">id</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">result </span><span style="color: #ff0000;">column</span><span style="color: #0000ff;">="deptName"</span><span style="color: #ff0000;"> property</span><span style="color: #0000ff;">="deptName"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">result</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">collection </span><span style="color: #ff0000;">property</span><span style="color: #0000ff;">="employeeList"</span><span style="color: #ff0000;"> select</span><span style="color: #0000ff;">="getEmpByDeptId"</span><span style="color: #ff0000;"> column</span><span style="color: #0000ff;">="deptId"</span><span style="color: #0000ff;">&gt;</span>
            <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">id </span><span style="color: #ff0000;">column</span><span style="color: #0000ff;">="e_id"</span><span style="color: #ff0000;"> property</span><span style="color: #0000ff;">="id"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">id</span><span style="color: #0000ff;">&gt;</span>
            <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">result </span><span style="color: #ff0000;">column</span><span style="color: #0000ff;">="e_name"</span><span style="color: #ff0000;"> property</span><span style="color: #0000ff;">="name"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">result</span><span style="color: #0000ff;">&gt;</span>
            <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">result </span><span style="color: #ff0000;">column</span><span style="color: #0000ff;">="e_salary"</span><span style="color: #ff0000;"> property</span><span style="color: #0000ff;">="salary"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">result</span><span style="color: #0000ff;">&gt;</span>
            <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">result </span><span style="color: #ff0000;">column</span><span style="color: #0000ff;">="e_age"</span><span style="color: #ff0000;"> property</span><span style="color: #0000ff;">="age"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">result</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">collection</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">resultMap</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">select </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="getDeptById"</span><span style="color: #ff0000;"> resultMap</span><span style="color: #0000ff;">="myMap"</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
        SELECT * FROM department WHERE deptId = #{id}
    </span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">select</span><span style="color: #0000ff;">&gt;</span>

    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">select </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="getEmpByDeptId"</span><span style="color: #ff0000;"> resultType</span><span style="color: #0000ff;">="entity.Employee"</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
        SELECT * FROM emp WHERE deptId = #{deptId}
    </span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">select</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">mapper</span><span style="color: #0000ff;">&gt;</span></code></pre>

<p>&nbsp;</p>
<p><img src="./images/MyBatis映射文件 相关操作28.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>注：<br />　　对于 collection 与 association的分步查询操作。</p>
<src class="cnblogs_code">
<pre><code><span style="color: #000000;">【若想传递多个参数，格式为：】
    column="{key1 = value1, key2 = value2}"
    
【使用时格式】
    #{key1}  或者 #{key2}</span></code></pre>

<p>&nbsp;</p>
<h3>7、关联映射 -- 鉴别器 -- discriminator</h3>
<p>　　使用鉴别器 discriminator， 可以监控某个列的值，并根据不同的值执行不同的行为。</p>
<p>　　如下例：对于 deptId =1 的数据，将部门名改为 1。对于 deptId =2 的数据，部门名不变。</p>
<src class="cnblogs_code">
<pre><code><span style="color: #000000;">【mapper.EmpMapper】
package mapper;

import entity.Department;

import java.util.List;

/**
 * 接口式编程，定义一系列方法，并根据方法映射到sql 的xml 文件中。
 * 其中，返回值类型可以是 Integer、Long、Boolean、void 、实体类
 */
public interface EmpMapper {
    public List</span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Department</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;"> getDeptById(Integer id);
}


【config/EmpMapper.xml】
</span><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="UTF-8" </span><span style="color: #0000ff;">?&gt;</span>
<span style="color: #0000ff;">&lt;!</span><span style="color: #ff00ff;">DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">mapper </span><span style="color: #ff0000;">namespace</span><span style="color: #0000ff;">="mapper.EmpMapper"</span><span style="color: #0000ff;">&gt;</span>

    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">resultMap </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="myMap"</span><span style="color: #ff0000;"> type</span><span style="color: #0000ff;">="entity.Department"</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #008000;">&lt;!--</span><span style="color: #008000;">
            discriminator 标签为鉴别器，可以根据某列的值执行不同的行为
            javaType 指定某列的值的类型
            column 用于指定某列
        </span><span style="color: #008000;">--&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">discriminator </span><span style="color: #ff0000;">javaType</span><span style="color: #0000ff;">="Integer"</span><span style="color: #ff0000;"> column</span><span style="color: #0000ff;">="deptId"</span><span style="color: #0000ff;">&gt;</span>
            <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">case </span><span style="color: #ff0000;">value</span><span style="color: #0000ff;">="1"</span><span style="color: #ff0000;"> resultType</span><span style="color: #0000ff;">="entity.Department"</span><span style="color: #0000ff;">&gt;</span>
                <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">id </span><span style="color: #ff0000;">column</span><span style="color: #0000ff;">="deptId"</span><span style="color: #ff0000;"> property</span><span style="color: #0000ff;">="deptId"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">id</span><span style="color: #0000ff;">&gt;</span>
                <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">id </span><span style="color: #ff0000;">column</span><span style="color: #0000ff;">="deptId"</span><span style="color: #ff0000;"> property</span><span style="color: #0000ff;">="deptName"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">id</span><span style="color: #0000ff;">&gt;</span>
            <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">case</span><span style="color: #0000ff;">&gt;</span>
            <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">case </span><span style="color: #ff0000;">value</span><span style="color: #0000ff;">="2"</span><span style="color: #ff0000;"> resultType</span><span style="color: #0000ff;">="entity.Department"</span><span style="color: #0000ff;">&gt;</span>
                <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">id </span><span style="color: #ff0000;">column</span><span style="color: #0000ff;">="deptId"</span><span style="color: #ff0000;"> property</span><span style="color: #0000ff;">="deptId"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">id</span><span style="color: #0000ff;">&gt;</span>
                <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">result </span><span style="color: #ff0000;">column</span><span style="color: #0000ff;">="deptName"</span><span style="color: #ff0000;"> property</span><span style="color: #0000ff;">="deptName"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">result</span><span style="color: #0000ff;">&gt;</span>
            <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">case</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">discriminator</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">resultMap</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">select </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="getDeptById"</span><span style="color: #ff0000;"> resultMap</span><span style="color: #0000ff;">="myMap"</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
        SELECT * FROM department
    </span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">select</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">mapper</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">


【test.Demo】
package test;

import entity.Department;
import entity.Employee;
import mapper.EmpMapper;
import org.apache.ibatis.io.Resources;
import org.apache.ibatis.session.SqlSession;
import org.apache.ibatis.session.SqlSessionFactory;
import org.apache.ibatis.session.SqlSessionFactoryBuilder;
import org.junit.Test;

import java.io.IOException;
import java.io.InputStream;
import java.util.List;

public class Demo {

    private static SqlSessionFactory getSqlSessionFactory() throws IOException {
        // step1：读取配置文件
        String resource = "config/mybatis-config.xml";
        InputStream inputStream = Resources.getResourceAsStream(resource);

        // step2：创建一个 SqlSessionFactory 的对象
        SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);

        return sqlSessionFactory;
    }

    @Test
    public void testGetDeptById() throws IOException {
        // 获取一个 SqlSessionFactory 的对象
        SqlSessionFactory sqlSessionFactory = Demo.getSqlSessionFactory();
        // 获取一个 SqlSession 的实例
        SqlSession session = sqlSessionFactory.openSession();
        try {
            EmpMapper empMapper = session.getMapper(EmpMapper.class);
            List</span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Department</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;"> result = empMapper.getDeptById(1);
            System.out.println(result);
        } finally {
            // step4：关闭 SqlSession 实例
            session.close();
        }
    }
}</span></code></pre>

<p>&nbsp;</p>
<p><img src="./images/MyBatis映射文件 相关操作29.png" alt="" /></p>
<p>&nbsp;</p>

</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>