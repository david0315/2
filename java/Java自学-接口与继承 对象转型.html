<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修Java自学-接口与继承 对象转型' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>Java自学-接口与继承 对象转型</center></div><div class='banquan'>原文出处:本文由博客园博主半米高峰提供。<br/>
原文连接:https://www.cnblogs.com/jeddzd/p/11497633.html</div><br>
    <h2 id="java中的对象转型">Java中的对象转型</h2>
<p>示例 1 : <strong>明确引用类型与对象类型的概念</strong></p>
<p>首先，明确引用类型与对象类型的概念<br />
在这个例子里，有一个对象 new ADHero(), 同时也有一个引用ad<br />
对象是有类型的， 是ADHero<br />
引用也是有类型的，是ADHero<br />
通常情况下，引用类型和对象类型是一样的<br />
接下来要讨论的类型转换的问题，指的是<strong>引用类型和对象类型</strong>不一致的情况下的转换问题</p>
<p><img src="./images/Java自学-接口与继承 对象转型0.png" alt="明确引用类型与对象类型的概念" /></p>
<pre><code><code>package charactor;
 
public class Hero {
    public String name;
    protected float hp;
     
    public static void main(String[] args) {
         
        ADHero ad = new ADHero();
         
    }
}</code></code></pre>
<p>示例 2 : <strong>子类转父类(向上转型)</strong></p>
<p>所谓的转型，是指当<strong>引用类型</strong>和<strong>对象类型</strong>不一致的时候，才需要进行类型转换<br />
类型转换有时候会成功，有时候会失败(参考基本类型的类型转换)</p>
<p>到底能否转换成功？ 教大家一个很简单的判别办法<br />
<strong>把右边的当做左边来用</strong>，看说得通不</p>
<pre><code><code>Hero h = new Hero();
ADHero ad = new ADHero();
h = ad;</code></code></pre>
<p>右边ad<strong>引用所指向的对象的类型</strong>是 物理攻击英雄<br />
左边h<strong>引用的类型</strong>是 普通英雄<br />
把物理攻击英雄 当做 普通英雄，说不说得通？ 说得通，就可以转</p>
<p>所有的<strong>子类转换为父类</strong>，都是说得通的。比如你身边的例子</p>
<p>苹果手机 继承了 手机，把苹果手机当做普通手机使用<br />
怡宝纯净水 继承了 饮品， 把怡宝纯净水 当做饮品来使用</p>
<p><img src="./images/Java自学-接口与继承 对象转型1.png" alt="子类转父类(向上转型)" /></p>
<pre><code><code>package charactor;
 
public class Hero {
    public String name;
    protected float hp;
     
    public static void main(String[] args) {
         
        Hero h = new Hero();
         
        ADHero ad = new ADHero();
         
        //类型转换指的是把一个引用所指向的对象的类型，转换为另一个引用的类型
         
        //把ad引用所指向的对象的类型是ADHero
        //h引用的类型是Hero
        //把ADHero当做Hero使用，一定可以
         
        h = ad;
         
    }
}</code></code></pre>
<p>示例 3 : <strong>父类转子类(向下转型)</strong></p>
<p>父类转子类，有的时候行，有的时候不行，所以必须进行强制转换。<br />
强制转换的意思就是 转换有风险，风险自担。</p>
<p><strong>什么时候行呢？</strong></p>
<pre><code><code>1.        Hero h =new Hero();
2.        ADHero ad = new ADHero();
3.        h = ad;
4.        ad = (ADHero) h;</code></code></pre>
<p>第3行，是子类转父类，一定可以的<br />
第4行，就是父类转子类，所以要进行强转。<br />
h这个引用，所指向的对象是ADHero, 所以第4行，就会把ADHero转换为ADHero，就能转换成功。</p>
<p><strong>什么时候转换不行呢？</strong></p>
<pre><code><code>1.        Hero h =new Hero();
2.        ADHero ad = new ADHero();
3.        Support s =new Support();
4.        h = s;
5.        ad = (ADHero)h;</code></code></pre>
<p>第4行，是子类转父类，是可以转换成功的<br />
第5行，是把h引用所指向的对象 Support，转换为ad引用的类型ADHero。 从语义上讲，把物理攻击英雄，当成辅助英雄来用，说不通，所以会强制转换失败，并且抛出异常</p>
<p><strong>以下是对完整的代码的关键行分析：</strong></p>
<p>14行： 把ad当做Hero使用，一定可以<br />
转换之后，h引用指向一个ad对象</p>
<p>15行： h引用有可能指向一个ad对象，也有可能指向一个support对象<br />
所以把h引用转换成AD类型的时候，就有可能成功，有可能失败<br />
因此要进行强制转换，换句话说转换后果自负<br />
到底能不能转换成功，要看<strong>引用h到底指向的是哪种对象</strong><br />
在这个例子里，h指向的是一个ad对象，所以转换成ADHero类型，是可以的</p>
<p>16行：把一个support对象当做Hero使用，一定可以<br />
转换之后，h引用指向一个support对象</p>
<p>17行：这个时候，h指向的是一个support对象，所以转换成ADHero类型，会失败。<br />
失败的表现形式是抛出异常 ClassCastException 类型转换异常</p>
<p><img src="./images/Java自学-接口与继承 对象转型2.png" alt="父类转子类(向下转型)" /></p>
<pre><code><code>package charactor;
  
import charactor1.Support;
  
public class Hero {
    public String name;
    protected float hp;
      
    public static void main(String[] args) {
        Hero h =new Hero();
        ADHero ad = new ADHero();
        Support s =new Support();
          
        h = ad; //14行
        ad = (ADHero) h; //15行
        h = s; //16行
        ad = (ADHero)h; //17行
    }
      
}</code></code></pre>
<p>示例 4 : <strong>没有继承关系的两个类，互相转换</strong></p>
<p>没有继承关系的两个类，互相转换，一定会失败<br />
虽然ADHero和APHero都继承了Hero，但是彼此没有互相继承关系<br />
&quot;<strong>把魔法英雄当做物理英雄来用</strong>&quot;,在语义上也是说不通的</p>
<p>没有继承关系的两个类，互相转换</p>
<pre><code><code>package charactor;
 
public class Hero {
    public String name;
    protected float hp;
 
    public static void main(String[] args) {
        ADHero ad = new ADHero();
 
        APHero ap = new APHero();
 
        // 没有继承关系的类型进行互相转换一定会失败，所以会出现编译错误
        ad = (ADHero) ap;
 
    }
 
}</code></code></pre>
<p>示例 5 : <strong>实现类转换成接口(向上转型)</strong></p>
<p>引用ad指向的对象是ADHero类型，这个类型实现了AD接口<br />
10行： 把一个ADHero类型转换为AD接口<br />
从语义上来讲，把一个ADHero当做AD来使用，而AD接口只有一个physicAttack方法，这就意味着转换后就有可能要调用physicAttack方法，而ADHero一定是有physicAttack方法的，所以转换是能成功的。</p>
<p><img src="./images/Java自学-接口与继承 对象转型3.png" alt="实现类转换成接口(向上转型)" /></p>
<pre><code><code>package charactor;
   
public class Hero {
    public String name;
    protected float hp;
       
    public static void main(String[] args) {
        ADHero ad = new ADHero();
          
        AD adi = ad; //10行
          
    }
       
}</code></code></pre>
<p>示例 6 : <strong>接口转换成实现类(向下转型)</strong></p>
<p>10行： ad引用指向ADHero， 而adi引用是接口类型：AD，实现类转换为接口，是向上转型，所以无需强制转换，并且一定能成功<br />
12行: adi实际上是指向一个ADHero的，所以能够转换成功<br />
14行： adi引用所指向的对象是一个ADHero，要转换为ADAPHero就会失败。</p>
<p><strong>假设能够转换成功</strong>，那么就可以使用<strong>magicAttack</strong>方法，而adi引用所指向的对象<strong>ADHero</strong>是没有<strong>magicAttack</strong>方法的。</p>
<p><img src="./images/Java自学-接口与继承 对象转型4.png" alt="接口转换成实现类(向下转型)" /></p>
<pre><code><code>package charactor;
     
public class Hero {
    public String name;
    protected float hp;
         
    public static void main(String[] args) {
        ADHero ad = new ADHero();
            
        AD adi = ad; //10行
   
        ADHero adHero = (ADHero) adi; //12行
            
        ADAPHero adapHero = (ADAPHero) adi; //14行
        adapHero.magicAttack();
    }
         
}</code></code></pre>
<p>示例 7 : <strong>instanceof</strong></p>
<p>instanceof Hero 判断一个引用所指向的对象，是否是Hero类型，或者Hero的子类</p>
<pre><code><code>package charactor;
  
public class Hero {
    public String name;
    protected float hp;
      
    public static void main(String[] args) {
        ADHero ad = new ADHero();
        APHero ap = new APHero();
         
        Hero h1= ad;
        Hero h2= ap;
         
        //判断引用h1指向的对象，是否是ADHero类型
        System.out.println(h1 instanceof ADHero);
         
        //判断引用h2指向的对象，是否是APHero类型
        System.out.println(h2 instanceof APHero);
         
        //判断引用h1指向的对象，是否是Hero的子类型
        System.out.println(h1 instanceof Hero);
    }
}</code></code></pre>
<p><strong>练习</strong>： <a href="http://how2j.cn/k/interface-inheritance/interface-inheritance-casting/308.html?p=43278">对象转型</a></p>
<p>（如下转换能否成功？<br />
如果不能，是哪一行会出错？<br />
为什么会出错）</p>
<pre><code><code>package charactor;
 
public class Hero {
    public String name;
    protected float hp;
 
    public static void main(String[] args) {
        ADHero ad = new ADHero();
        Hero h = ad;
        AD adi = (AD) h;
        APHero ap = (APHero) adi; //11行
    }
}</code></code></pre>


</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>