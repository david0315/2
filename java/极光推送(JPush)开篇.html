<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修极光推送(JPush)开篇' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>极光推送(JPush)开篇</center></div><div class='banquan'>原文出处:本文由博客园博主因为喜欢提供。<br/>
原文连接:https://www.cnblogs.com/weigy/p/11833228.html</div><br>
    <p><span style="color: #ff0000;"><strong>Date:2019-11-11</strong></span></p>
<p><span style="color: #000000; font-family: 黑体; font-size: 18px;"><strong>读前思考：</strong></span></p>
<p><strong>　　极光推送是什么？</strong></p>
<p><strong>　　极光推送是能做什么？有什么优势？</strong></p>
<p><strong>　　怎么根据业务<strong>需求</strong>来实现极光推送服务呢？</strong></p>
<h2>简介</h2>
<p>极光推送（JPush）是独立的第三方云推送平台，致力于为全球移动应用开发者提供移动消息推送服务。</p>
<src class="para">极光先后推出了极光即时通讯云（JMessage）、极光短信服务（JSMS）、极光统计（JAnalytics）、极光分享（JShare）等开发者服务。<span class="sup--normal" data-sup="8" data-ctrmap=":8,">&nbsp;</span>
<src class="para">极光IM（JMessage） 致力于帮助app解决应用内聊天及跨应用聊天问题，快速集成SDK，提供稳定可靠的APP用户间聊天功能。<span class="sup--normal" data-sup="9" data-ctrmap=":9,"><br /></span>
<src class="para">极光短信（JSMS） 为开发者提供短信下发功能，包括验证码类短信、通知类短信和营销类短信三大类。
<src class="para">极光统计（JAnalytics） 提供整合Android、iOS的统计服务。<span class="sup--normal" data-sup="9" data-ctrmap=":9,"><br /></span>
<src class="para">极光分享帮助应用具备国内主流社交平台分享功能，提供新浪微博、QQ、微信等第三方社会化分享服务，提高产品推广效率，帮助产品提高用户体验，获得更多用户。
<p>极光官方文档：<a title="https://docs.jiguang.cn/" href="https://docs.jiguang.cn/" target="_blank">https://docs.jiguang.cn/</a></p>
<p><span style="font-family: 黑体; font-size: 18pt; color: #ff0000;"><strong>极光社区</strong></span>：<a href="https://community.jiguang.cn/">https://community.jiguang.cn/</a></p>
<p>　　　<span style="font-size: 12px;">　遇到问题，可以在这里找到相应的解决办法。</span></p>
<p id="rest-api">服务端 REST API ：<a title="https://docs.jiguang.cn/jpush/server/push/server_overview/" href="https://docs.jiguang.cn/jpush/server/push/server_overview/" target="_blank">https://docs.jiguang.cn/jpush/server/push/server_overview/</a></p>
<p>server_sdk：<a title="https://docs.jiguang.cn/jpush/server/server_sdk/" href="https://docs.jiguang.cn/jpush/server/server_sdk/" target="_blank">https://docs.jiguang.cn/jpush/server/server_sdk/</a></p>
<p>JPush REST API 的 Java 版本封装开发包，是由极光推送官方提供的，一般支持最新的 API 功能。</p>
<p>对应的 REST API 文档：[REST API - Push](<a title="https://docs.jiguang.cn/jpush/server/push/rest_api_v3_push/" href="https://docs.jiguang.cn/jpush/server/push/rest_api_v3_push/" target="_blank">https://docs.jiguang.cn/jpush/server/push/rest_api_v3_push/</a>),</p>
<p>[REST API - Report](<a title="https://docs.jiguang.cn/jpush/server/push/rest_api_v3_report/" href="https://docs.jiguang.cn/jpush/server/push/rest_api_v3_report/" target="_blank">https://docs.jiguang.cn/jpush/server/push/rest_api_v3_report/</a>).</p>
<p><em id="__mceDel">本开发包 Javadoc：[API Docs](<a title="http://jpush.github.io/jpush-api-java-client/apidocs/" href="http://jpush.github.io/jpush-api-java-client/apidocs/" target="_blank">http://jpush.github.io/jpush-api-java-client/apidocs/</a>)</em></p>
<p><em id="__mceDel"></em><em id="__mceDel">版本更新：[Release页面](<a title="https://github.com/jpush/jpush-api-java-client/releases" href="https://github.com/jpush/jpush-api-java-client/releases" target="_blank">https://github.com/jpush/jpush-api-java-client/releases</a>)</em></p>
<p><img src="./images/极光推送(JPush)开篇0.png" alt="" /></p>
<p>&nbsp;</p>
<h2>极光推送测试</h2>
<p>先注册账号：<a title="https://www.jiguang.cn/" href="https://www.jiguang.cn/" target="_blank">https://www.jiguang.cn/</a></p>
<p><img src="./images/极光推送(JPush)开篇1.png" alt="" /></p>
<p><span style="font-size: 16px; font-family: 黑体;">登录账号创建应用获取AppKey以及Master Secret</span></p>
<p><img src="./images/极光推送(JPush)开篇2.png" alt="" /></p>
<p>开发者服务： <a title="https://www.jiguang.cn/dev2/#/app/a76cf62afbe91d4b57f4c36e/info" href="https://www.jiguang.cn/dev2/#/app/a76cf62afbe91d4b57f4c36e/info" target="_blank">https://www.jiguang.cn/dev2/#/app/a76cf62afbe91d4b57f4c36e/info</a></p>
<p><img src="./images/极光推送(JPush)开篇3.png" alt="" /></p>
<p>&nbsp;</p>
<p>示例代码：</p>
<p><strong><span style="color: #ff0000;">JPushUtil</span></strong>：</p>
<src class="cnblogs_code">
<pre><code><span style="color: #0000ff;">package</span><span style="color: #000000;"> com.joey.jpush.test1;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> cn.jpush.api.push.model.Platform;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> cn.jpush.api.push.model.PushPayload;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> cn.jpush.api.push.model.audience.Audience;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> cn.jpush.api.push.model.notification.Notification;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.List;

</span><span style="color: #008000;">/**</span><span style="color: #008000;">
 * 极光推送工具类 </span><span style="color: #008000; text-decoration: underline;">https://github.com/</span><span style="color: #008000;">
 * @Probject JPushUtil
 * @Create By Joey
 * @Create IN 2019-11-12
 *</span><span style="color: #008000;">*/</span>
<span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> JPushUtil {
    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     * 所有平台，所有设备，内容为 content 的通知
     * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> content
     * </span><span style="color: #808080;">@return</span>
     <span style="color: #008000;">*/</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span><span style="color: #000000;"> PushPayload buildPushObjectAllAlert(String content) {
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> PushPayload.alertAll(content);
    }
    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     * 根据 设备终端ID 推送消息
     * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> regesterIds 设备终端ID集合
     * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> content     内容
     * </span><span style="color: #808080;">@return</span>
     <span style="color: #008000;">*/</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> PushPayload buildPushObjectByregesterIds(List&lt;String&gt;<span style="color: #000000;"> regesterIds, String content) {
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> PushPayload.newBuilder().setPlatform(Platform.all())
                .setAudience(Audience.registrationId(regesterIds))
                .setNotification(Notification.alert(content))
                .build();
    }
    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     * 所有平台，推送目标是别名为 "alias"，通知内容为 TEST
     * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> alias
     * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> content
     * </span><span style="color: #808080;">@return</span>
     <span style="color: #008000;">*/</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span><span style="color: #000000;"> PushPayload buildPushObjectAliasAlert(String alias, String content) {
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> PushPayload.newBuilder().setPlatform(Platform.all()).setAudience(Audience.alias(alias))
                .setNotification(Notification.alert(content)).build();
    }
}</span></code></pre>

<pre><code><strong><span style="color: #ff0000;">JpushService</span>:</strong></code></pre>
<src class="cnblogs_code">
<pre><code><span style="color: #0000ff;">package</span><span style="color: #000000;"> com.joey.jpush.test1;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.List;

</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> JpushService {
    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     * 所有平台推送消息内容 
     * </span><span style="color: #808080;">@return</span>
     <span style="color: #008000;">*/</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> pushAll();

    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     * 指定的设备推送消息内容
     * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> regeSterIds
     * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> msg
     * </span><span style="color: #808080;">@return</span>
     <span style="color: #008000;">*/</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">boolean</span> pushByRegesterId(List&lt;String&gt;<span style="color: #000000;"> regeSterIds, String msg);
}</span></code></pre>

<pre><code><strong><span style="color: #ff0000;">JpushServiceImpl:</span></strong></code></pre>
<src class="cnblogs_code">
<pre><code><span style="color: #0000ff;">package</span><span style="color: #000000;"> com.joey.jpush.test1;

</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> cn.jiguang.common.resp.APIConnectionException;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> cn.jiguang.common.resp.APIRequestException;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> cn.jpush.api.JPushClient;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> cn.jpush.api.push.PushResult;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> cn.jpush.api.push.model.PushPayload;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.slf4j.Logger;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.slf4j.LoggerFactory;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.stereotype.Service;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.List;

</span><span style="color: #008000;">/**</span><span style="color: #008000;">
 * @Probject JpushServiceImpl
 * @Create By Joey
 * @Create IN 2019-11-12
 *</span><span style="color: #008000;">*/</span><span style="color: #000000;">
@Service(</span>"jpushService"<span style="color: #000000;">)
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> JpushServiceImpl <span style="color: #0000ff;">implements</span><span style="color: #000000;"> JpushService {
    </span><span style="color: #008000;">//</span><span style="color: #008000;">AppKey</span>
    <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">static</span> String appKey = "a76cf62afbe91d4b57f4c36e"<span style="color: #000000;">;
    </span><span style="color: #008000;">//</span><span style="color: #008000;">Master Secret</span>
    <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">static</span> String masterSecret = "34960b30f9cec35615156a4d "<span style="color: #000000;">;
    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     * 保存离线的时长。秒为单位。最多支持10天（864000秒）。
     * 0 表示该消息不保存离线。
     * 即：用户在线马上发出，当前不在线用户将不会收到此消息。
     * 此参数不设置则表示默认，默认为保存1天的离线消息（86400秒)。
     </span><span style="color: #008000;">*/</span>
    <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">long</span> timeToLive = 60 * 60 * 24<span style="color: #000000;">;
    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> JPushClient jPushClient = <span style="color: #0000ff;">null</span><span style="color: #000000;">;
    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> Logger logger = LoggerFactory.getLogger(JpushServiceImpl.<span style="color: #0000ff;">class</span><span style="color: #000000;">);

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> pushAll() {
        jPushClient </span>= <span style="color: #0000ff;">new</span> JPushClient(masterSecret, appKey, (<span style="color: #0000ff;">int</span><span style="color: #000000;">) timeToLive);
        </span><span style="color: #0000ff;">boolean</span> flag = <span style="color: #0000ff;">false</span><span style="color: #000000;">;
        </span><span style="color: #0000ff;">try</span><span style="color: #000000;"> {
            String title </span>= "小姐姐,再抱抱我.真的好舒服呢"<span style="color: #000000;">;

            </span><span style="color: #008000;">//</span><span style="color: #008000;">推送对象</span>
            PushPayload payload =<span style="color: #000000;"> JPushUtil.buildPushObjectAllAlert(title);

            </span><span style="color: #008000;">//</span><span style="color: #008000;">推送结果</span>
            PushResult result =<span style="color: #000000;"> jPushClient.sendPush(payload);
            </span><span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> !=<span style="color: #000000;"> result) {
                flag </span>= <span style="color: #0000ff;">true</span><span style="color: #000000;">;
            }
        } </span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (APIConnectionException e) {
            logger.error(</span>"Connection error. Should retry later. "<span style="color: #000000;">, e);
            flag </span>= <span style="color: #0000ff;">false</span><span style="color: #000000;">;
        } </span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (APIRequestException e) {
            logger.error(</span>"Error response from JPush server. Should review and fix it. "<span style="color: #000000;">, e);
            logger.info(</span>"HTTP Status: " +<span style="color: #000000;"> e.getStatus());
            logger.info(</span>"Error Code: " +<span style="color: #000000;"> e.getErrorCode());
            logger.info(</span>"Error Message: " +<span style="color: #000000;"> e.getErrorMessage());
            logger.info(</span>"Msg ID: " +<span style="color: #000000;"> e.getMsgId());
            flag </span>= <span style="color: #0000ff;">false</span><span style="color: #000000;">;
        }
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> flag;
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">boolean</span> pushByRegesterId(List&lt;String&gt;<span style="color: #000000;"> regeSterIds, String msg) {
        jPushClient </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> JPushClient(masterSecret, appKey);
        </span><span style="color: #0000ff;">boolean</span> flag = <span style="color: #0000ff;">false</span><span style="color: #000000;">;
        </span><span style="color: #0000ff;">try</span><span style="color: #000000;"> {
            </span><span style="color: #008000;">//</span><span style="color: #008000;">推送对象</span>
            PushPayload payload =<span style="color: #000000;"> JPushUtil.buildPushObjectByregesterIds(regeSterIds, msg);

            </span><span style="color: #008000;">//</span><span style="color: #008000;">PushResult 表示服务端推送结果</span>
            PushResult result =<span style="color: #000000;"> jPushClient.sendPush(payload);
            </span><span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> !=<span style="color: #000000;"> result) {
                flag </span>= <span style="color: #0000ff;">true</span><span style="color: #000000;">;
            }
        } </span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (APIConnectionException e) {
            logger.error(</span>"Connection error. Should retry later. "<span style="color: #000000;">, e);
            flag </span>= <span style="color: #0000ff;">false</span><span style="color: #000000;">;
        } </span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (APIRequestException e) {
            logger.error(</span>"Error response from JPush server. Should review and fix it. "<span style="color: #000000;">, e);
            logger.info(</span>"HTTP Status: " +<span style="color: #000000;"> e.getStatus());
            logger.info(</span>"Error Code: " +<span style="color: #000000;"> e.getErrorCode());
            logger.info(</span>"Error Message: " +<span style="color: #000000;"> e.getErrorMessage());
            logger.info(</span>"Msg ID: " +<span style="color: #000000;"> e.getMsgId());
            flag </span>= <span style="color: #0000ff;">false</span><span style="color: #000000;">;
        }
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> flag;
    }
}</span></code></pre>

<p>&nbsp;注意：appKey和masterSecret是从你创建应用的时候，生成的。</p>
<p><img src="./images/极光推送(JPush)开篇4.png" alt="" /></p>
<p>做完测试之后，推送的原理是什么？</p>
<h2>极光推送原理</h2>
<p>&nbsp;推送是手机中非常常见的功能了，可是在实现上iOS和Andriod却有很大的差别。</p>
<p><img src="./images/极光推送(JPush)开篇5.png" alt="" /></p>
<p>如上图：</p>
<p>1.你的IOS应用需要去注册APNS消息推送功能。</p>
<p>2.当苹果APNS推送服收到来自你应用的注册消息就会返回一串device token给你（很重要）</p>
<p>3.将应用收到的device Token传给你本地的Push服务器。</p>
<p>4.当你需要为应用推送消息的时候，你本地的推送服务器会将消息，以及Device Token打包发送到苹果的APNS服</p>
<p>5.APNS再将消息推送给目的iphone</p>

</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>