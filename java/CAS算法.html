<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修CAS算法' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>CAS算法</center></div><div class='banquan'>原文出处:本文由博客园博主源码复兴号提供。<br/>
原文连接:https://www.cnblogs.com/wildwolf0/p/11455796.html</div><br>
    <p><strong>前言</strong></p>
<blockquote>
<p>CAS，即 Compare And Swap(比较与交换)，是一种无锁算法，基于硬件原语实现，能够在不使用锁的情况下实现多线程之间的变量同步。jdk中的java.util.concurrent.atomic包中的原子类就是通过CAS来实现了乐观锁。</p>
</blockquote>
<p><strong>CAS算法过程</strong></p>
<p>算法涉及到三个操作数：</p>
<ul>
<li>需要读写的内存位置V</li>
<li>需要进行比较的预期值A</li>
<li>需要写入的新值U</li>
</ul>
<p>CAS算法解析：</p>
<p>CAS具体执行时，当且仅当预期值A符合内存地址V中存储的值时，就用新值U替换掉旧值，并写入到内存地址V中。否则不做更新。</p>
<p>CAS算法的运行原理如下如所示：</p>
<p><img src="./images/CAS算法0.png" alt="CAS算法图解" /></p>
<p><strong>CAS会有如下三个方面的问题：</strong></p>
<p>1.ABA问题，一个线程将内存值从A改为B，另一个线程又从B改回到A。</p>
<p>2.循环时间长开销大：CAS算法需要不断地自旋来读取最新的内存值，长时间读取不到就会造成不必要的CPU开销。</p>
<ol>
<li>只能保证一个共享变量的原子操作（jdk的AtomicReference来保证应用对象之间的原子性，可以把多个变量放在一个对象里来进行CAS操作，解决了这一问题）。</li>
</ol>
<p>ABA问题图解：</p>
<p><img src="./images/CAS算法1.png" alt="ABA问题图解" /></p>
<p>ABA问题解决方案：在变量前面添加版本号，每次变量更新的时候都将版本号加1，比如juc的原子包中的AtomicStampedReference类。</p>


</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>