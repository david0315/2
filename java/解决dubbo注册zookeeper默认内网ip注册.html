<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修解决dubbo注册zookeeper默认内网ip注册' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>解决dubbo注册zookeeper默认内网ip注册</center></div><div class='banquan'>原文出处:本文由博客园博主HuuuWnnn提供。<br/>
原文连接:https://www.cnblogs.com/HuuuWnnn/p/11833269.html</div><br>
    <p>　　<span style="font-size: 16px;">前端时间做新项目的时候遇到一个dubbo的一个问题，在我们项目搭建好后使用了其他同事的支付服务，支付服务架构的方式使用了dubbo服务的方式，使用zookeeper作为注册中心，我们新项目使用dubbo注解的方式引用dubbo服务，然后项目启动的时候发生了我们最不愿意看到的一件事，项目跑不起来了。查看了一下服务，确认服务没有挂，并且在dubbo的管理工具上也找到了这个服务，回到程序报错去看（测试服务器还在使用，就没还原报错信息），发现了一个没见过的IP，很明显是一个内网IP。支付服务跟注册中心都是在一台服务器，而服务的消费者是我的本机，所以内网IP是不能找到支付服务的。也就是说Zookeeper将Dubbo服务生产者的内网地址给了消费者，如果想使用支付服务将消费者放到同一台服务器上就可以找到了，但是这不是解决问题的根本方法，为什么会出现上面的情况，查看了hosts文件发现，是由于在服务器hosts配置的文件将主机名指向了内网IP地址</span></p>
<p>　　<img src="./images/解决dubbo注册zookeeper默认内网ip注册0.png" alt="" /></p>
<p>　　<span style="font-size: 16px;">如此zookeeper才会将内网IP提供给消费者，我们只需要加一个公网IP即可解决问题</span></p>
<p>　　<img src="./images/解决dubbo注册zookeeper默认内网ip注册1.png" alt="" /></p>
<p>&nbsp;　　<span style="font-size: 16px;">hosts文件修改后就能生效，然后重启zookeeper，重启dubbo服务，然后发现可以找到服务了（这里我马赛克了一下，大家也都能看懂，前面就是公网IP然后空格主机名称然后空格主及名称)</span></p>
<p><span style="font-size: 16px;">　　遇到dubbo找不到的问题的时候应该先确认所有提供者与注册中心是否正常，所有配置是不是正确，注册中心地址是不是一样的，检查防火墙是不是关闭，如果在还是没有找到提供者就可以看一下是不是内网IP的原因，这个其实也很好找，只要看控制台的打印就能知道消费者是去那个IP地址找消费者了。文章最后再提一下，有时候hosts修改可能不生效，可以重启一下。</span></p>
<p><span style="font-size: 16px;">　　如何查看自己是否修改成功 uname -a</span></p>
<p>　　<img src="./images/解决dubbo注册zookeeper默认内网ip注册2.png" alt="" /></p>
<p>&nbsp;　　<span style="font-size: 16px;">我打码的名字跟你配置的名字一样的时候就成功了，如果不成功重启一下网络就可以了</span></p>
<p><span style="font-size: 16px;">　　service network restart 当看到ok就重启成功了</span></p>
<p>　　<img id="uploading_image_51040" src="./images/解决dubbo注册zookeeper默认内网ip注册3.png" alt="" /></p>
<p>&nbsp;</p>
<p>　　</p>

</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>