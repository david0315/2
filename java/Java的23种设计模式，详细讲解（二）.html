<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修Java的23种设计模式，详细讲解（二）' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>Java的23种设计模式，详细讲解（二）</center></div><div class='banquan'>原文出处:本文由博客园博主Java博客手留余香提供。<br/>
原文连接:https://www.cnblogs.com/yuxiang1/p/11685297.html</div><br>
    <blockquote>
<h2><span style="font-size: 16px;"><span style="color: #ff0000;">本人免费整理了Java高级资料，涵盖了Java、Redis、MongoDB、MySQL、Zookeeper、Spring Cloud、Dubbo高并发分布式等教程，一共30G，需要自己领取。</span><br /><span style="color: #ff0000;">传送门：</span><a class=" wrap external" href="https://link.zhihu.com/?target=https%3A//links.jianshu.com/go%3Fto%3Dhttps%253A%252F%252Flink.zhihu.com%252F%253Ftarget%253Dhttps%25253A%252F%252Fmp.weixin.qq.com%252Fs%252FJzddfH-7yNudmkjT0IRL8Q" rel="nofollow noreferrer" target="_blank" data-za-detail-view-id="1043"><span style="color: #ff0000;">https</span>://mp.weixin.qq.com/s/JzddfH-7yNudmkjT0IRL8Q</a></span></h2>

</blockquote>
<h2><span style="font-size: 16px;">1. 责任链（Chain Of Responsibility）</span></h2>
<h3><span style="font-size: 16px;">Intent</span></h3>
<p><span style="font-size: 16px;">使多个对象都有机会处理请求，从而避免请求的发送者和接收者之间的耦合关系。将这些对象连成一条链，并沿着这条链发送该请求，直到有一个对象处理它为止。</span></p>
<h3><span style="font-size: 16px;">Class Diagram</span></h3>
<ul>
<li><span style="font-size: 16px;">Handler：定义处理请求的接口，并且实现后继链（successor）</span></li>

</ul>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<p><span style="font-size: 16px;"><img class="origin_image zh-lightbox-thumb lazy" src="./images/Java的23种设计模式，详细讲解（二）0.png" alt="" width="733" data-caption="" data-size="normal" data-rawwidth="733" data-rawheight="440" data-original="https://pic2.zhimg.com/v2-5171a035dc18457ff91d640a9a1d681d_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-5171a035dc18457ff91d640a9a1d681d_b.jpg" data-lazy-status="ok" /></span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<h3><span style="font-size: 16px;">Implementation</span></h3>
<src class="highlight">
<src class="cnblogs_code">
<pre><code><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">abstract</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Handler {

    </span><span style="color: #0000ff;">protected</span><span style="color: #000000;"> Handler successor;


    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> Handler(Handler successor) {
        </span><span style="color: #0000ff;">this</span>.successor =<span style="color: #000000;"> successor;
    }


    </span><span style="color: #0000ff;">protected</span> <span style="color: #0000ff;">abstract</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> handleRequest(Request request);
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> ConcreteHandler1 <span style="color: #0000ff;">extends</span><span style="color: #000000;"> Handler {

    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> ConcreteHandler1(Handler successor) {
        </span><span style="color: #0000ff;">super</span><span style="color: #000000;">(successor);
    }


    @Override
    </span><span style="color: #0000ff;">protected</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> handleRequest(Request request) {
        </span><span style="color: #0000ff;">if</span> (request.getType() ==<span style="color: #000000;"> RequestType.TYPE1) {
            System.out.println(request.getName() </span>+ " is handle by ConcreteHandler1"<span style="color: #000000;">);
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;">;
        }
        </span><span style="color: #0000ff;">if</span> (successor != <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
            successor.handleRequest(request);
        }
    }
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> ConcreteHandler2 <span style="color: #0000ff;">extends</span><span style="color: #000000;"> Handler {

    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> ConcreteHandler2(Handler successor) {
        </span><span style="color: #0000ff;">super</span><span style="color: #000000;">(successor);
    }


    @Override
    </span><span style="color: #0000ff;">protected</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> handleRequest(Request request) {
        </span><span style="color: #0000ff;">if</span> (request.getType() ==<span style="color: #000000;"> RequestType.TYPE2) {
            System.out.println(request.getName() </span>+ " is handle by ConcreteHandler2"<span style="color: #000000;">);
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;">;
        }
        </span><span style="color: #0000ff;">if</span> (successor != <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
            successor.handleRequest(request);
        }
    }
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Request {

    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> RequestType type;
    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> String name;


    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> Request(RequestType type, String name) {
        </span><span style="color: #0000ff;">this</span>.type =<span style="color: #000000;"> type;
        </span><span style="color: #0000ff;">this</span>.name =<span style="color: #000000;"> name;
    }


    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> RequestType getType() {
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> type;
    }


    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> String getName() {
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> name;
    }
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">enum</span><span style="color: #000000;"> RequestType {
    TYPE1, TYPE2
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Client {

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> main(String[] args) {

        Handler handler1 </span>= <span style="color: #0000ff;">new</span> ConcreteHandler1(<span style="color: #0000ff;">null</span><span style="color: #000000;">);
        Handler handler2 </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> ConcreteHandler2(handler1);

        Request request1 </span>= <span style="color: #0000ff;">new</span> Request(RequestType.TYPE1, "request1"<span style="color: #000000;">);
        handler2.handleRequest(request1);

        Request request2 </span>= <span style="color: #0000ff;">new</span> Request(RequestType.TYPE2, "request2"<span style="color: #000000;">);
        handler2.handleRequest(request2);
    }
}
request1 is handle by ConcreteHandler1
request2 is handle by ConcreteHandler2</span></code></pre>

<p>&nbsp;</p>

<h3><span style="font-size: 16px;">JDK</span></h3>
<ul>
<li><span style="font-size: 16px;"><a class=" wrap external" href="https://link.zhihu.com/?target=http%3A//docs.oracle.com/javase/8/docs/api/java/util/logging/Logger.html%23log%2528java.util.logging.Level%2C%2520java.lang.String%2529" rel="nofollow noreferrer" target="_blank" data-za-detail-view-id="1043">java.util.logging.Logger#log()</a></span></li>
<li><span style="font-size: 16px;"><a class=" wrap external" href="https://link.zhihu.com/?target=https%3A//commons.apache.org/proper/commons-chain/index.html" rel="nofollow noreferrer" target="_blank" data-za-detail-view-id="1043">Apache Commons Chain</a></span></li>
<li><span style="font-size: 16px;"><a class=" wrap external" href="https://link.zhihu.com/?target=http%3A//docs.oracle.com/javaee/7/api/javax/servlet/Filter.html%23doFilter-javax.servlet.ServletRequest-javax.servlet.ServletResponse-javax.servlet.FilterChain-" rel="nofollow noreferrer" target="_blank" data-za-detail-view-id="1043">javax.servlet.Filter#doFilter()</a></span></li>
</ul>
<h2><span style="font-size: 16px;">2. 命令（Command）</span></h2>
<h3><span style="font-size: 16px;">Intent</span></h3>
<p><span style="font-size: 16px;">将命令封装成对象中，具有以下作用：</span></p>
<ul>
<li><span style="font-size: 16px;">使用命令来参数化其它对象</span></li>
<li><span style="font-size: 16px;">将命令放入队列中进行排队</span></li>
<li><span style="font-size: 16px;">将命令的操作记录到日志中</span></li>
<li><span style="font-size: 16px;">支持可撤销的操作</span></li>
</ul>
<h3><span style="font-size: 16px;">Class Diagram</span></h3>
<ul>
<li><span style="font-size: 16px;">Command：命令</span></li>
<li><span style="font-size: 16px;">Receiver：命令接收者，也就是命令真正的执行者</span></li>
<li><span style="font-size: 16px;">Invoker：通过它来调用命令</span></li>
<li><span style="font-size: 16px;">Client：可以设置命令与命令的接收者</span></li>
</ul>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<p><span style="font-size: 16px;"><img class="origin_image zh-lightbox-thumb lazy" src="./images/Java的23种设计模式，详细讲解（二）1.png" alt="" width="874" data-caption="" data-size="normal" data-rawwidth="874" data-rawheight="436" data-original="https://pic1.zhimg.com/v2-a235ec6bc753fab9081c09257b5f2888_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-a235ec6bc753fab9081c09257b5f2888_b.jpg" data-lazy-status="ok" /></span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<h3><span style="font-size: 16px;">Implementation</span></h3>
<p><span style="font-size: 16px;">设计一个遥控器，可以控制电灯开关。</span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<p><span style="font-size: 16px;"><img class="origin_image zh-lightbox-thumb lazy" src="./images/Java的23种设计模式，详细讲解（二）2.png" alt="" width="866" data-caption="" data-size="normal" data-rawwidth="866" data-rawheight="702" data-original="https://pic1.zhimg.com/v2-c43b1dd52e0a6bada3f9afa8440b7b74_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-c43b1dd52e0a6bada3f9afa8440b7b74_b.jpg" data-lazy-status="ok" /></span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<src class="highlight">
<src class="cnblogs_code">
<pre><code><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> Command {
    </span><span style="color: #0000ff;">void</span><span style="color: #000000;"> execute();
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> LightOnCommand <span style="color: #0000ff;">implements</span><span style="color: #000000;"> Command {
    Light light;

    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> LightOnCommand(Light light) {
        </span><span style="color: #0000ff;">this</span>.light =<span style="color: #000000;"> light;
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> execute() {
        light.on();
    }
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> LightOffCommand <span style="color: #0000ff;">implements</span><span style="color: #000000;"> Command {
    Light light;

    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> LightOffCommand(Light light) {
        </span><span style="color: #0000ff;">this</span>.light =<span style="color: #000000;"> light;
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> execute() {
        light.off();
    }
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Light {

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> on() {
        System.out.println(</span>"Light is on!"<span style="color: #000000;">);
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> off() {
        System.out.println(</span>"Light is off!"<span style="color: #000000;">);
    }
}
</span><span style="color: #008000;">/**</span><span style="color: #008000;">
 * 遥控器
 </span><span style="color: #008000;">*/</span>
<span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Invoker {
    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> Command[] onCommands;
    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> Command[] offCommands;
    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">int</span> slotNum = 7<span style="color: #000000;">;

    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> Invoker() {
        </span><span style="color: #0000ff;">this</span>.onCommands = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Command[slotNum];
        </span><span style="color: #0000ff;">this</span>.offCommands = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Command[slotNum];
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> setOnCommand(Command command, <span style="color: #0000ff;">int</span><span style="color: #000000;"> slot) {
        onCommands[slot] </span>=<span style="color: #000000;"> command;
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> setOffCommand(Command command, <span style="color: #0000ff;">int</span><span style="color: #000000;"> slot) {
        offCommands[slot] </span>=<span style="color: #000000;"> command;
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onButtonWasPushed(<span style="color: #0000ff;">int</span><span style="color: #000000;"> slot) {
        onCommands[slot].execute();
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> offButtonWasPushed(<span style="color: #0000ff;">int</span><span style="color: #000000;"> slot) {
        offCommands[slot].execute();
    }
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Client {
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> main(String[] args) {
        Invoker invoker </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> Invoker();
        Light light </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> Light();
        Command lightOnCommand </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> LightOnCommand(light);
        Command lightOffCommand </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> LightOffCommand(light);
        invoker.setOnCommand(lightOnCommand, </span>0<span style="color: #000000;">);
        invoker.setOffCommand(lightOffCommand, </span>0<span style="color: #000000;">);
        invoker.onButtonWasPushed(</span>0<span style="color: #000000;">);
        invoker.offButtonWasPushed(</span>0<span style="color: #000000;">);
    }
}</span></code></pre>

<p>&nbsp;</p>

<h3><span style="font-size: 16px;">JDK</span></h3>
<ul>
<li><span style="font-size: 16px;"><a class=" wrap external" href="https://link.zhihu.com/?target=http%3A//docs.oracle.com/javase/8/docs/api/java/lang/Runnable.html" rel="nofollow noreferrer" target="_blank" data-za-detail-view-id="1043">java.lang.Runnable</a></span></li>
<li><span style="font-size: 16px;"><a class=" wrap external" href="https://link.zhihu.com/?target=https%3A//github.com/Netflix/Hystrix/wiki" rel="nofollow noreferrer" target="_blank" data-za-detail-view-id="1043">Netflix Hystrix</a></span></li>
<li><span style="font-size: 16px;"><a class=" wrap external" href="https://link.zhihu.com/?target=http%3A//docs.oracle.com/javase/8/docs/api/javax/swing/Action.html" rel="nofollow noreferrer" target="_blank" data-za-detail-view-id="1043">javax.swing.Action</a></span></li>
</ul>
<h2><span style="font-size: 16px;">3. 解释器（Interpreter）</span></h2>
<h3><span style="font-size: 16px;">Intent</span></h3>
<p><span style="font-size: 16px;">为语言创建解释器，通常由语言的语法和语法分析来定义。</span></p>
<h3><span style="font-size: 16px;">Class Diagram</span></h3>
<ul>
<li><span style="font-size: 16px;">TerminalExpression：终结符表达式，每个终结符都需要一个 TerminalExpression。</span></li>
<li><span style="font-size: 16px;">Context：上下文，包含解释器之外的一些全局信息。</span></li>
</ul>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<p><span style="font-size: 16px;"><img class="origin_image zh-lightbox-thumb lazy" src="./images/Java的23种设计模式，详细讲解（二）3.png" alt="" width="804" data-caption="" data-size="normal" data-rawwidth="804" data-rawheight="505" data-original="https://pic3.zhimg.com/v2-43c55de26c19a9c033aa08d6402da38e_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-43c55de26c19a9c033aa08d6402da38e_b.jpg" data-lazy-status="ok" /></span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<h3><span style="font-size: 16px;">Implementation</span></h3>
<p><span style="font-size: 16px;">以下是一个规则检验器实现，具有 and 和 or 规则，通过规则可以构建一颗解析树，用来检验一个文本是否满足解析树定义的规则。</span></p>
<p><span style="font-size: 16px;">例如一颗解析树为 D And (A Or (B C))，文本 "D A" 满足该解析树定义的规则。</span></p>
<p><span style="font-size: 16px;">这里的 Context 指的是 String。</span></p>
<src class="highlight">
<src class="cnblogs_code">
<pre><code><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">abstract</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Expression {
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">abstract</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> interpret(String str);
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> TerminalExpression <span style="color: #0000ff;">extends</span><span style="color: #000000;"> Expression {

    </span><span style="color: #0000ff;">private</span> String literal = <span style="color: #0000ff;">null</span><span style="color: #000000;">;

    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> TerminalExpression(String str) {
        literal </span>=<span style="color: #000000;"> str;
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> interpret(String str) {
        StringTokenizer st </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> StringTokenizer(str);
        </span><span style="color: #0000ff;">while</span><span style="color: #000000;"> (st.hasMoreTokens()) {
            String test </span>=<span style="color: #000000;"> st.nextToken();
            </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (test.equals(literal)) {
                </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span><span style="color: #000000;">;
            }
        }
        </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;
    }
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> AndExpression <span style="color: #0000ff;">extends</span><span style="color: #000000;"> Expression {

    </span><span style="color: #0000ff;">private</span> Expression expression1 = <span style="color: #0000ff;">null</span><span style="color: #000000;">;
    </span><span style="color: #0000ff;">private</span> Expression expression2 = <span style="color: #0000ff;">null</span><span style="color: #000000;">;

    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> AndExpression(Expression expression1, Expression expression2) {
        </span><span style="color: #0000ff;">this</span>.expression1 =<span style="color: #000000;"> expression1;
        </span><span style="color: #0000ff;">this</span>.expression2 =<span style="color: #000000;"> expression2;
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> interpret(String str) {
        </span><span style="color: #0000ff;">return</span> expression1.interpret(str) &amp;&amp;<span style="color: #000000;"> expression2.interpret(str);
    }
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> OrExpression <span style="color: #0000ff;">extends</span><span style="color: #000000;"> Expression {
    </span><span style="color: #0000ff;">private</span> Expression expression1 = <span style="color: #0000ff;">null</span><span style="color: #000000;">;
    </span><span style="color: #0000ff;">private</span> Expression expression2 = <span style="color: #0000ff;">null</span><span style="color: #000000;">;

    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> OrExpression(Expression expression1, Expression expression2) {
        </span><span style="color: #0000ff;">this</span>.expression1 =<span style="color: #000000;"> expression1;
        </span><span style="color: #0000ff;">this</span>.expression2 =<span style="color: #000000;"> expression2;
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> interpret(String str) {
        </span><span style="color: #0000ff;">return</span> expression1.interpret(str) ||<span style="color: #000000;"> expression2.interpret(str);
    }
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Client {

    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     * 构建解析树
     </span><span style="color: #008000;">*/</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span><span style="color: #000000;"> Expression buildInterpreterTree() {
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> Literal</span>
        Expression terminal1 = <span style="color: #0000ff;">new</span> TerminalExpression("A"<span style="color: #000000;">);
        Expression terminal2 </span>= <span style="color: #0000ff;">new</span> TerminalExpression("B"<span style="color: #000000;">);
        Expression terminal3 </span>= <span style="color: #0000ff;">new</span> TerminalExpression("C"<span style="color: #000000;">);
        Expression terminal4 </span>= <span style="color: #0000ff;">new</span> TerminalExpression("D"<span style="color: #000000;">);
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> B C</span>
        Expression alternation1 = <span style="color: #0000ff;">new</span><span style="color: #000000;"> OrExpression(terminal2, terminal3);
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> A Or (B C)</span>
        Expression alternation2 = <span style="color: #0000ff;">new</span><span style="color: #000000;"> OrExpression(terminal1, alternation1);
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> D And (A Or (B C))</span>
        <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> AndExpression(terminal4, alternation2);
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> main(String[] args) {
        Expression define </span>=<span style="color: #000000;"> buildInterpreterTree();
        String context1 </span>= "D A"<span style="color: #000000;">;
        String context2 </span>= "A B"<span style="color: #000000;">;
        System.out.println(define.interpret(context1));
        System.out.println(define.interpret(context2));
    }
}
</span><span style="color: #0000ff;">true</span>
<span style="color: #0000ff;">false</span></code></pre>

<p>&nbsp;</p>

<h3><span style="font-size: 16px;">JDK</span></h3>
<ul>
<li><span style="font-size: 16px;"><a class=" wrap external" href="https://link.zhihu.com/?target=http%3A//docs.oracle.com/javase/8/docs/api/java/util/regex/Pattern.html" rel="nofollow noreferrer" target="_blank" data-za-detail-view-id="1043">java.util.Pattern</a></span></li>
<li><span style="font-size: 16px;"><a class=" wrap external" href="https://link.zhihu.com/?target=http%3A//docs.oracle.com/javase/8/docs/api/java/text/Normalizer.html" rel="nofollow noreferrer" target="_blank" data-za-detail-view-id="1043">java.text.Normalizer</a></span></li>
<li><span style="font-size: 16px;">All subclasses of&nbsp;<a class=" wrap external" href="https://link.zhihu.com/?target=http%3A//docs.oracle.com/javase/8/docs/api/java/text/Format.html" rel="nofollow noreferrer" target="_blank" data-za-detail-view-id="1043">java.text.Format</a></span></li>
<li><span style="font-size: 16px;"><a class=" wrap external" href="https://link.zhihu.com/?target=http%3A//docs.oracle.com/javaee/7/api/javax/el/ELResolver.html" rel="nofollow noreferrer" target="_blank" data-za-detail-view-id="1043">javax.el.ELResolver</a></span></li>
</ul>
<h2><span style="font-size: 16px;">4. 迭代器（Iterator）</span></h2>
<h3><span style="font-size: 16px;">Intent</span></h3>
<p><span style="font-size: 16px;">提供一种顺序访问聚合对象元素的方法，并且不暴露聚合对象的内部表示。</span></p>
<h3><span style="font-size: 16px;">Class Diagram</span></h3>
<ul>
<li><span style="font-size: 16px;">Aggregate 是聚合类，其中 createIterator() 方法可以产生一个 Iterator；</span></li>
<li><span style="font-size: 16px;">Iterator 主要定义了 hasNext() 和 next() 方法。</span></li>
<li><span style="font-size: 16px;">Client 组合了 Aggregate，为了迭代遍历 Aggregate，也需要组合 Iterator。</span></li>
</ul>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<p><span style="font-size: 16px;"><img class="origin_image zh-lightbox-thumb lazy" src="./images/Java的23种设计模式，详细讲解（二）4.png" alt="" width="915" data-caption="" data-size="normal" data-rawwidth="915" data-rawheight="421" data-original="https://pic2.zhimg.com/v2-ef15ac1aee95498ba0ac9ad2da0c5fd5_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-ef15ac1aee95498ba0ac9ad2da0c5fd5_b.jpg" data-lazy-status="ok" /></span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<h3><span style="font-size: 16px;">Implementation</span></h3>
<src class="highlight">
<src class="cnblogs_code">
<pre><code><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> Aggregate {
    Iterator createIterator();
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> ConcreteAggregate <span style="color: #0000ff;">implements</span><span style="color: #000000;"> Aggregate {

    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> Integer[] items;

    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> ConcreteAggregate() {
        items </span>= <span style="color: #0000ff;">new</span> Integer[10<span style="color: #000000;">];
        </span><span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i = 0; i &lt; items.length; i++<span style="color: #000000;">) {
            items[i] </span>=<span style="color: #000000;"> i;
        }
    }

    @Override
    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> Iterator createIterator() {
        </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span> ConcreteIterator&lt;Integer&gt;<span style="color: #000000;">(items);
    }
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span> Iterator&lt;Item&gt;<span style="color: #000000;"> {

    Item next();

    </span><span style="color: #0000ff;">boolean</span><span style="color: #000000;"> hasNext();
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> ConcreteIterator&lt;Item&gt; <span style="color: #0000ff;">implements</span><span style="color: #000000;"> Iterator {

    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> Item[] items;
    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span> position = 0<span style="color: #000000;">;

    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> ConcreteIterator(Item[] items) {
        </span><span style="color: #0000ff;">this</span>.items =<span style="color: #000000;"> items;
    }

    @Override
    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> Object next() {
        </span><span style="color: #0000ff;">return</span> items[position++<span style="color: #000000;">];
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> hasNext() {
        </span><span style="color: #0000ff;">return</span> position &lt;<span style="color: #000000;"> items.length;
    }
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Client {

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> main(String[] args) {
        Aggregate aggregate </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> ConcreteAggregate();
        Iterator</span>&lt;Integer&gt; iterator =<span style="color: #000000;"> aggregate.createIterator();
        </span><span style="color: #0000ff;">while</span><span style="color: #000000;"> (iterator.hasNext()) {
            System.out.println(iterator.next());
        }
    }
}</span></code></pre>

<p>&nbsp;</p>

<h3><span style="font-size: 16px;">JDK</span></h3>
<ul>
<li><span style="font-size: 16px;"><a class=" wrap external" href="https://link.zhihu.com/?target=http%3A//docs.oracle.com/javase/8/docs/api/java/util/Iterator.html" rel="nofollow noreferrer" target="_blank" data-za-detail-view-id="1043">java.util.Iterator</a></span></li>
<li><span style="font-size: 16px;"><a class=" wrap external" href="https://link.zhihu.com/?target=http%3A//docs.oracle.com/javase/8/docs/api/java/util/Enumeration.html" rel="nofollow noreferrer" target="_blank" data-za-detail-view-id="1043">java.util.Enumeration</a></span></li>
</ul>
<h2><span style="font-size: 16px;">5. 中介者（Mediator）</span></h2>
<h3><span style="font-size: 16px;">Intent</span></h3>
<p><span style="font-size: 16px;">集中相关对象之间复杂的沟通和控制方式。</span></p>
<h3><span style="font-size: 16px;">Class Diagram</span></h3>
<ul>
<li><span style="font-size: 16px;">Mediator：中介者，定义一个接口用于与各同事（Colleague）对象通信。</span></li>
<li><span style="font-size: 16px;">Colleague：同事，相关对象</span></li>
</ul>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<p><span style="font-size: 16px;"><img class="origin_image zh-lightbox-thumb lazy" src="./images/Java的23种设计模式，详细讲解（二）5.png" alt="" width="794" data-caption="" data-size="normal" data-rawwidth="794" data-rawheight="402" data-original="https://pic4.zhimg.com/v2-60b594517e5163179185f674beb2af8f_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-60b594517e5163179185f674beb2af8f_b.jpg" data-lazy-status="ok" /></span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<h3><span style="font-size: 16px;">Implementation</span></h3>
<p><span style="font-size: 16px;">Alarm（闹钟）、CoffeePot（咖啡壶）、Calendar（日历）、Sprinkler（喷头）是一组相关的对象，在某个对象的事件产生时需要去操作其它对象，形成了下面这种依赖结构：</span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<p><span style="font-size: 16px;"><img class="content_image lazy" src="./images/Java的23种设计模式，详细讲解（二）6.png" alt="" width="368" data-caption="" data-size="normal" data-rawwidth="368" data-rawheight="378" data-actualsrc="https://pic4.zhimg.com/v2-ac85597131d631ba5274eaa1813b665b_b.jpg" data-lazy-status="ok" /></span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<p><span style="font-size: 16px;">使用中介者模式可以将复杂的依赖结构变成星形结构：</span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<p><span style="font-size: 16px;"><img class="content_image lazy" src="./images/Java的23种设计模式，详细讲解（二）7.png" alt="" width="324" data-caption="" data-size="normal" data-rawwidth="324" data-rawheight="471" data-actualsrc="https://pic2.zhimg.com/v2-155936b94b09621523a429b293ddd455_b.jpg" data-lazy-status="ok" /></span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<src class="highlight">
<src class="cnblogs_code">
<pre><code><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">abstract</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Colleague {
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">abstract</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onEvent(Mediator mediator);
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> Alarm <span style="color: #0000ff;">extends</span><span style="color: #000000;"> Colleague {

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onEvent(Mediator mediator) {
        mediator.doEvent(</span>"alarm"<span style="color: #000000;">);
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> doAlarm() {
        System.out.println(</span>"doAlarm()"<span style="color: #000000;">);
    }
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> CoffeePot <span style="color: #0000ff;">extends</span><span style="color: #000000;"> Colleague {
    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onEvent(Mediator mediator) {
        mediator.doEvent(</span>"coffeePot"<span style="color: #000000;">);
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> doCoffeePot() {
        System.out.println(</span>"doCoffeePot()"<span style="color: #000000;">);
    }
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> Calender <span style="color: #0000ff;">extends</span><span style="color: #000000;"> Colleague {
    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onEvent(Mediator mediator) {
        mediator.doEvent(</span>"calender"<span style="color: #000000;">);
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> doCalender() {
        System.out.println(</span>"doCalender()"<span style="color: #000000;">);
    }
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> Sprinkler <span style="color: #0000ff;">extends</span><span style="color: #000000;"> Colleague {
    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onEvent(Mediator mediator) {
        mediator.doEvent(</span>"sprinkler"<span style="color: #000000;">);
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> doSprinkler() {
        System.out.println(</span>"doSprinkler()"<span style="color: #000000;">);
    }
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">abstract</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Mediator {
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">abstract</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> doEvent(String eventType);
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> ConcreteMediator <span style="color: #0000ff;">extends</span><span style="color: #000000;"> Mediator {
    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> Alarm alarm;
    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> CoffeePot coffeePot;
    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> Calender calender;
    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> Sprinkler sprinkler;

    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> ConcreteMediator(Alarm alarm, CoffeePot coffeePot, Calender calender, Sprinkler sprinkler) {
        </span><span style="color: #0000ff;">this</span>.alarm =<span style="color: #000000;"> alarm;
        </span><span style="color: #0000ff;">this</span>.coffeePot =<span style="color: #000000;"> coffeePot;
        </span><span style="color: #0000ff;">this</span>.calender =<span style="color: #000000;"> calender;
        </span><span style="color: #0000ff;">this</span>.sprinkler =<span style="color: #000000;"> sprinkler;
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> doEvent(String eventType) {
        </span><span style="color: #0000ff;">switch</span><span style="color: #000000;"> (eventType) {
            </span><span style="color: #0000ff;">case</span> "alarm"<span style="color: #000000;">:
                doAlarmEvent();
                </span><span style="color: #0000ff;">break</span><span style="color: #000000;">;
            </span><span style="color: #0000ff;">case</span> "coffeePot"<span style="color: #000000;">:
                doCoffeePotEvent();
                </span><span style="color: #0000ff;">break</span><span style="color: #000000;">;
            </span><span style="color: #0000ff;">case</span> "calender"<span style="color: #000000;">:
                doCalenderEvent();
                </span><span style="color: #0000ff;">break</span><span style="color: #000000;">;
            </span><span style="color: #0000ff;">default</span><span style="color: #000000;">:
                doSprinklerEvent();
        }
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> doAlarmEvent() {
        alarm.doAlarm();
        coffeePot.doCoffeePot();
        calender.doCalender();
        sprinkler.doSprinkler();
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> doCoffeePotEvent() {
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> ...</span>
<span style="color: #000000;">    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> doCalenderEvent() {
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> ...</span>
<span style="color: #000000;">    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> doSprinklerEvent() {
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> ...</span>
<span style="color: #000000;">    }
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Client {
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> main(String[] args) {
        Alarm alarm </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> Alarm();
        CoffeePot coffeePot </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> CoffeePot();
        Calender calender </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> Calender();
        Sprinkler sprinkler </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> Sprinkler();
        Mediator mediator </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> ConcreteMediator(alarm, coffeePot, calender, sprinkler);
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> 闹钟事件到达，调用中介者就可以操作相关对象</span>
<span style="color: #000000;">        alarm.onEvent(mediator);
    }
}
doAlarm()
doCoffeePot()
doCalender()</span></code></pre>

<p>&nbsp;</p>
<pre><code><span style="font-size: 16px;"><code class="language-java"><span class="kd"><span class="kd"><span class="kd"><span class="nc"><span class="o"><span class="kd"><span class="kd"><span class="kt"><span class="nf"><span class="o"><span class="n"><span class="n"><span class="o"><span class="o"><span class="kd"><span class="kd"><span class="nc"><span class="kd"><span class="n"><span class="o"><span class="nd"><span class="kd"><span class="kt"><span class="nf"><span class="o"><span class="n"><span class="n"><span class="o"><span class="o"><span class="n"><span class="o"><span class="na"><span class="o"><span class="s"><span class="o"><span class="o"><span class="kd"><span class="kt"><span class="nf"><span class="o"><span class="o"><span class="n"><span class="o"><span class="na"><span class="o"><span class="na"><span class="o"><span class="s"><span class="o"><span class="o"><span class="o"><span class="kd"><span class="kd"><span class="nc"><span class="kd"><span class="n"><span class="o"><span class="nd"><span class="kd"><span class="kt"><span class="nf"><span class="o"><span class="n"><span class="n"><span class="o"><span class="o"><span class="n"><span class="o"><span class="na"><span class="o"><span class="s"><span class="o"><span class="o"><span class="kd"><span class="kt"><span class="nf"><span class="o"><span class="o"><span class="n"><span class="o"><span class="na"><span class="o"><span class="na"><span class="o"><span class="s"><span class="o"><span class="o"><span class="o"><span class="kd"><span class="kd"><span class="nc"><span class="kd"><span class="n"><span class="o"><span class="nd"><span class="kd"><span class="kt"><span class="nf"><span class="o"><span class="n"><span class="n"><span class="o"><span class="o"><span class="n"><span class="o"><span class="na"><span class="o"><span class="s"><span class="o"><span class="o"><span class="kd"><span class="kt"><span class="nf"><span class="o"><span class="o"><span class="n"><span class="o"><span class="na"><span class="o"><span class="na"><span class="o"><span class="s"><span class="o"><span class="o"><span class="o"><span class="kd"><span class="kd"><span class="nc"><span class="kd"><span class="n"><span class="o"><span class="nd"><span class="kd"><span class="kt"><span class="nf"><span class="o"><span class="n"><span class="n"><span class="o"><span class="o"><span class="n"><span class="o"><span class="na"><span class="o"><span class="s"><span class="o"><span class="o"><span class="kd"><span class="kt"><span class="nf"><span class="o"><span class="o"><span class="n"><span class="o"><span class="na"><span class="o"><span class="na"><span class="o"><span class="s"><span class="o"><span class="o"><span class="o"><span class="kd"><span class="kd"><span class="kd"><span class="nc"><span class="o"><span class="kd"><span class="kd"><span class="kt"><span class="nf"><span class="o"><span class="n"><span class="n"><span class="o"><span class="o"><span class="kd"><span class="kd"><span class="nc"><span class="kd"><span class="n"><span class="o"><span class="kd"><span class="n"><span class="n"><span class="o"><span class="kd"><span class="n"><span class="n"><span class="o"><span class="kd"><span class="n"><span class="n"><span class="o"><span class="kd"><span class="n"><span class="n"><span class="o"><span class="kd"><span class="nf"><span class="o"><span class="n"><span class="n"><span class="o"><span class="n"><span class="n"><span class="o"><span class="n"><span class="n"><span class="o"><span class="n"><span class="n"><span class="o"><span class="o"><span class="k"><span class="o"><span class="na"><span class="o"><span class="n"><span class="o"><span class="k"><span class="o"><span class="na"><span class="o"><span class="n"><span class="o"><span class="k"><span class="o"><span class="na"><span class="o"><span class="n"><span class="o"><span class="k"><span class="o"><span class="na"><span class="o"><span class="n"><span class="o"><span class="o"><span class="nd"><span class="kd"><span class="kt"><span class="nf"><span class="o"><span class="n"><span class="n"><span class="o"><span class="o"><span class="k"><span class="o"><span class="n"><span class="o"><span class="o"><span class="k"><span class="s"><span class="o"><span class="n"><span class="o"><span class="k"><span class="o"><span class="k"><span class="s"><span class="o"><span class="n"><span class="o"><span class="k"><span class="o"><span class="k"><span class="s"><span class="o"><span class="n"><span class="o"><span class="k"><span class="o"><span class="nl"><span class="nl"><span class="n"><span class="o"><span class="o"><span class="o"><span class="kd"><span class="kt"><span class="nf"><span class="o"><span class="o"><span class="n"><span class="o"><span class="na"><span class="o"><span class="n"><span class="o"><span class="na"><span class="o"><span class="n"><span class="o"><span class="na"><span class="o"><span class="n"><span class="o"><span class="na"><span class="o"><span class="o"><span class="kd"><span class="kt"><span class="nf"><span class="o"><span class="o"><span class="c1"><span class="c1"><span class="o"><span class="kd"><span class="kt"><span class="nf"><span class="o"><span class="o"><span class="c1"><span class="c1"><span class="o"><span class="kd"><span class="kt"><span class="nf"><span class="o"><span class="o"><span class="c1"><span class="c1"><span class="o"><span class="o"><span class="kd"><span class="kd"><span class="nc"><span class="o"><span class="kd"><span class="kd"><span class="kt"><span class="nf"><span class="o"><span class="n"><span class="o"><span class="n"><span class="o"><span class="o"><span class="n"><span class="n"><span class="o"><span class="k"><span class="n"><span class="o"><span class="n"><span class="n"><span class="o"><span class="k"><span class="n"><span class="o"><span class="n"><span class="n"><span class="o"><span class="k"><span class="n"><span class="o"><span class="n"><span class="n"><span class="o"><span class="k"><span class="n"><span class="o"><span class="n"><span class="n"><span class="o"><span class="k"><span class="n"><span class="o"><span class="n"><span class="o"><span class="n"><span class="o"><span class="n"><span class="o"><span class="n"><span class="o"><span class="c1"><span class="c1"><span class="n"><span class="o"><span class="na"><span class="o"><span class="n"><span class="o"><span class="o"><span class="o"><span class="n"><span class="o"><span class="n"><span class="o"><span class="n"><span class="o">
<span class="n">doSprinkler<span class="o">()</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></span></code></pre>

<h3><span style="font-size: 16px;">JDK</span></h3>
<ul>
<li><span style="font-size: 16px;">All scheduleXXX() methods of&nbsp;<a class=" wrap external" href="https://link.zhihu.com/?target=http%3A//docs.oracle.com/javase/8/docs/api/java/util/Timer.html" rel="nofollow noreferrer" target="_blank" data-za-detail-view-id="1043">java.util.Timer</a></span></li>
<li><span style="font-size: 16px;"><a class=" wrap external" href="https://link.zhihu.com/?target=http%3A//docs.oracle.com/javase/8/docs/api/java/util/concurrent/Executor.html%23execute-java.lang.Runnable-" rel="nofollow noreferrer" target="_blank" data-za-detail-view-id="1043">java.util.concurrent.Executor#execute()</a></span></li>
<li><span style="font-size: 16px;">submit() and invokeXXX() methods of&nbsp;<a class=" wrap external" href="https://link.zhihu.com/?target=http%3A//docs.oracle.com/javase/8/docs/api/java/util/concurrent/ExecutorService.html" rel="nofollow noreferrer" target="_blank" data-za-detail-view-id="1043">java.util.concurrent.ExecutorService</a></span></li>
<li><span style="font-size: 16px;">scheduleXXX() methods of&nbsp;<a class=" wrap external" href="https://link.zhihu.com/?target=http%3A//docs.oracle.com/javase/8/docs/api/java/util/concurrent/ScheduledExecutorService.html" rel="nofollow noreferrer" target="_blank" data-za-detail-view-id="1043">java.util.concurrent.ScheduledExecutorService</a></span></li>
<li><span style="font-size: 16px;"><a class=" wrap external" href="https://link.zhihu.com/?target=http%3A//docs.oracle.com/javase/8/docs/api/java/lang/reflect/Method.html%23invoke-java.lang.Object-java.lang.Object...-" rel="nofollow noreferrer" target="_blank" data-za-detail-view-id="1043">java.lang.reflect.Method#invoke()</a></span></li>
</ul>
<h2><span style="font-size: 16px;">6. 备忘录（Memento）</span></h2>
<h3><span style="font-size: 16px;">Intent</span></h3>
<p><span style="font-size: 16px;">在不违反封装的情况下获得对象的内部状态，从而在需要时可以将对象恢复到最初状态。</span></p>
<h3><span style="font-size: 16px;">Class Diagram</span></h3>
<ul>
<li><span style="font-size: 16px;">Originator：原始对象</span></li>
<li><span style="font-size: 16px;">Caretaker：负责保存好备忘录</span></li>
<li><span style="font-size: 16px;">Menento：备忘录，存储原始对象的的状态。备忘录实际上有两个接口，一个是提供给 Caretaker 的窄接口：它只能将备忘录传递给其它对象；一个是提供给 Originator 的宽接口，允许它访问到先前状态所需的所有数据。理想情况是只允许 Originator 访问本备忘录的内部状态。</span></li>
</ul>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<p><span style="font-size: 16px;"><img class="origin_image zh-lightbox-thumb lazy" src="./images/Java的23种设计模式，详细讲解（二）8.png" alt="" width="893" data-caption="" data-size="normal" data-rawwidth="893" data-rawheight="203" data-original="https://pic1.zhimg.com/v2-a19ea624647ef368e0dea1bf15fe7148_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-a19ea624647ef368e0dea1bf15fe7148_b.jpg" data-lazy-status="ok" /></span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<h3><span style="font-size: 16px;">Implementation</span></h3>
<p><span style="font-size: 16px;">以下实现了一个简单计算器程序，可以输入两个值，然后计算这两个值的和。备忘录模式允许将这两个值存储起来，然后在某个时刻用存储的状态进行恢复。</span></p>
<p><span style="font-size: 16px;">实现参考：<a class=" wrap external" href="https://link.zhihu.com/?target=https%3A//www.oodesign.com/memento-pattern-calculator-example-java-sourcecode.html" rel="nofollow noreferrer" target="_blank" data-za-detail-view-id="1043">Memento Pattern - Calculator Example - Java Sourcecode</a></span></p>
<src class="highlight">
<src class="cnblogs_code">
<pre><code><span style="color: #008000;">/**</span><span style="color: #008000;">
 * Originator Interface
 </span><span style="color: #008000;">*/</span>
<span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> Calculator {

    </span><span style="color: #008000;">//</span><span style="color: #008000;"> Create Memento</span>
<span style="color: #000000;">    PreviousCalculationToCareTaker backupLastCalculation();

    </span><span style="color: #008000;">//</span><span style="color: #008000;"> setMemento</span>
    <span style="color: #0000ff;">void</span><span style="color: #000000;"> restorePreviousCalculation(PreviousCalculationToCareTaker memento);

    </span><span style="color: #0000ff;">int</span><span style="color: #000000;"> getCalculationResult();

    </span><span style="color: #0000ff;">void</span> setFirstNumber(<span style="color: #0000ff;">int</span><span style="color: #000000;"> firstNumber);

    </span><span style="color: #0000ff;">void</span> setSecondNumber(<span style="color: #0000ff;">int</span><span style="color: #000000;"> secondNumber);
}
</span><span style="color: #008000;">/**</span><span style="color: #008000;">
 * Originator Implementation
 </span><span style="color: #008000;">*/</span>
<span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> CalculatorImp <span style="color: #0000ff;">implements</span><span style="color: #000000;"> Calculator {

    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> firstNumber;
    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> secondNumber;

    @Override
    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> PreviousCalculationToCareTaker backupLastCalculation() {
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> create a memento object used for restoring two numbers</span>
        <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> PreviousCalculationImp(firstNumber, secondNumber);
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> restorePreviousCalculation(PreviousCalculationToCareTaker memento) {
        </span><span style="color: #0000ff;">this</span>.firstNumber =<span style="color: #000000;"> ((PreviousCalculationToOriginator) memento).getFirstNumber();
        </span><span style="color: #0000ff;">this</span>.secondNumber =<span style="color: #000000;"> ((PreviousCalculationToOriginator) memento).getSecondNumber();
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> getCalculationResult() {
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> result is adding two numbers</span>
        <span style="color: #0000ff;">return</span> firstNumber +<span style="color: #000000;"> secondNumber;
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> setFirstNumber(<span style="color: #0000ff;">int</span><span style="color: #000000;"> firstNumber) {
        </span><span style="color: #0000ff;">this</span>.firstNumber =<span style="color: #000000;"> firstNumber;
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> setSecondNumber(<span style="color: #0000ff;">int</span><span style="color: #000000;"> secondNumber) {
        </span><span style="color: #0000ff;">this</span>.secondNumber =<span style="color: #000000;"> secondNumber;
    }
}
</span><span style="color: #008000;">/**</span><span style="color: #008000;">
 * Memento Interface to Originator
 *
 * This interface allows the originator to restore its state
 </span><span style="color: #008000;">*/</span>
<span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> PreviousCalculationToOriginator {
    </span><span style="color: #0000ff;">int</span><span style="color: #000000;"> getFirstNumber();
    </span><span style="color: #0000ff;">int</span><span style="color: #000000;"> getSecondNumber();
}
</span><span style="color: #008000;">/**</span><span style="color: #008000;">
 *  Memento interface to CalculatorOperator (Caretaker)
 </span><span style="color: #008000;">*/</span>
<span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> PreviousCalculationToCareTaker {
    </span><span style="color: #008000;">//</span><span style="color: #008000;"> no operations permitted for the caretaker</span>
<span style="color: #000000;">}
</span><span style="color: #008000;">/**</span><span style="color: #008000;">
 * Memento Object Implementation
 * &lt;p&gt;
 * Note that this object implements both interfaces to Originator and CareTaker
 </span><span style="color: #008000;">*/</span>
<span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> PreviousCalculationImp <span style="color: #0000ff;">implements</span><span style="color: #000000;"> PreviousCalculationToCareTaker,
        PreviousCalculationToOriginator {

    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> firstNumber;
    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> secondNumber;

    </span><span style="color: #0000ff;">public</span> PreviousCalculationImp(<span style="color: #0000ff;">int</span> firstNumber, <span style="color: #0000ff;">int</span><span style="color: #000000;"> secondNumber) {
        </span><span style="color: #0000ff;">this</span>.firstNumber =<span style="color: #000000;"> firstNumber;
        </span><span style="color: #0000ff;">this</span>.secondNumber =<span style="color: #000000;"> secondNumber;
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> getFirstNumber() {
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> firstNumber;
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> getSecondNumber() {
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> secondNumber;
    }
}
</span><span style="color: #008000;">/**</span><span style="color: #008000;">
 * CareTaker object
 </span><span style="color: #008000;">*/</span>
<span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Client {

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> main(String[] args) {
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> program starts</span>
        Calculator calculator = <span style="color: #0000ff;">new</span><span style="color: #000000;"> CalculatorImp();

        </span><span style="color: #008000;">//</span><span style="color: #008000;"> assume user enters two numbers</span>
        calculator.setFirstNumber(10<span style="color: #000000;">);
        calculator.setSecondNumber(</span>100<span style="color: #000000;">);

        </span><span style="color: #008000;">//</span><span style="color: #008000;"> find result</span>
<span style="color: #000000;">        System.out.println(calculator.getCalculationResult());

        </span><span style="color: #008000;">//</span><span style="color: #008000;"> Store result of this calculation in case of error</span>
        PreviousCalculationToCareTaker memento =<span style="color: #000000;"> calculator.backupLastCalculation();

        </span><span style="color: #008000;">//</span><span style="color: #008000;"> user enters a number</span>
        calculator.setFirstNumber(17<span style="color: #000000;">);

        </span><span style="color: #008000;">//</span><span style="color: #008000;"> user enters a wrong second number and calculates result</span>
        calculator.setSecondNumber(-290<span style="color: #000000;">);

        </span><span style="color: #008000;">//</span><span style="color: #008000;"> calculate result</span>
<span style="color: #000000;">        System.out.println(calculator.getCalculationResult());

        </span><span style="color: #008000;">//</span><span style="color: #008000;"> user hits CTRL + Z to undo last operation and see last result</span>
<span style="color: #000000;">        calculator.restorePreviousCalculation(memento);

        </span><span style="color: #008000;">//</span><span style="color: #008000;"> result restored</span>
<span style="color: #000000;">        System.out.println(calculator.getCalculationResult());
    }
}
</span>110
-273
110</code></pre>

<p>&nbsp;</p>

<h3><span style="font-size: 16px;">JDK</span></h3>
<ul>
<li><span style="font-size: 16px;">java.io.Serializable</span></li>
</ul>
<h2><span style="font-size: 16px;">7. 观察者（Observer）</span></h2>
<h3><span style="font-size: 16px;">Intent</span></h3>
<p><span style="font-size: 16px;">定义对象之间的一对多依赖，当一个对象状态改变时，它的所有依赖都会收到通知并且自动更新状态。</span></p>
<p><span style="font-size: 16px;">主题（Subject）是被观察的对象，而其所有依赖者（Observer）称为观察者。</span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<p><span style="font-size: 16px;"><img class="origin_image zh-lightbox-thumb lazy" src="./images/Java的23种设计模式，详细讲解（二）9.png" alt="" width="653" data-caption="" data-size="normal" data-rawwidth="653" data-rawheight="454" data-original="https://pic1.zhimg.com/v2-e22be753cfaa279a6d12ee816fb2f9f8_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-e22be753cfaa279a6d12ee816fb2f9f8_b.jpg" data-lazy-status="ok" /></span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<h3><span style="font-size: 16px;">Class Diagram</span></h3>
<p><span style="font-size: 16px;">主题（Subject）具有注册和移除观察者、并通知所有观察者的功能，主题是通过维护一张观察者列表来实现这些操作的。</span></p>
<p><span style="font-size: 16px;">观察者（Observer）的注册功能需要调用主题的 registerObserver() 方法。</span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<p><span style="font-size: 16px;"><img class="origin_image zh-lightbox-thumb lazy" src="./images/Java的23种设计模式，详细讲解（二）10.png" alt="" width="709" data-caption="" data-size="normal" data-rawwidth="709" data-rawheight="447" data-original="https://pic1.zhimg.com/v2-c13b353d5d95092599c9dc7f8a95cb9c_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-c13b353d5d95092599c9dc7f8a95cb9c_b.jpg" data-lazy-status="ok" /></span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<h3><span style="font-size: 16px;">Implementation</span></h3>
<p><span style="font-size: 16px;">天气数据布告板会在天气信息发生改变时更新其内容，布告板有多个，并且在将来会继续增加。</span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<p><span style="font-size: 16px;"><img class="content_image lazy" src="./images/Java的23种设计模式，详细讲解（二）11.png" alt="" width="348" data-caption="" data-size="normal" data-rawwidth="348" data-rawheight="451" data-actualsrc="https://pic1.zhimg.com/v2-a222c2bb5084453c056fc38000dc9298_b.jpg" data-lazy-status="ok" /></span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<src class="highlight">
<src class="cnblogs_code">
<pre><code><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> Subject {
    </span><span style="color: #0000ff;">void</span><span style="color: #000000;"> registerObserver(Observer o);

    </span><span style="color: #0000ff;">void</span><span style="color: #000000;"> removeObserver(Observer o);

    </span><span style="color: #0000ff;">void</span><span style="color: #000000;"> notifyObserver();
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> WeatherData <span style="color: #0000ff;">implements</span><span style="color: #000000;"> Subject {
    </span><span style="color: #0000ff;">private</span> List&lt;Observer&gt;<span style="color: #000000;"> observers;
    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">float</span><span style="color: #000000;"> temperature;
    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">float</span><span style="color: #000000;"> humidity;
    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">float</span><span style="color: #000000;"> pressure;

    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> WeatherData() {
        observers </span>= <span style="color: #0000ff;">new</span> ArrayList&lt;&gt;<span style="color: #000000;">();
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> setMeasurements(<span style="color: #0000ff;">float</span> temperature, <span style="color: #0000ff;">float</span> humidity, <span style="color: #0000ff;">float</span><span style="color: #000000;"> pressure) {
        </span><span style="color: #0000ff;">this</span>.temperature =<span style="color: #000000;"> temperature;
        </span><span style="color: #0000ff;">this</span>.humidity =<span style="color: #000000;"> humidity;
        </span><span style="color: #0000ff;">this</span>.pressure =<span style="color: #000000;"> pressure;
        notifyObserver();
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> registerObserver(Observer o) {
        observers.add(o);
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> removeObserver(Observer o) {
        </span><span style="color: #0000ff;">int</span> i =<span style="color: #000000;"> observers.indexOf(o);
        </span><span style="color: #0000ff;">if</span> (i &gt;= 0<span style="color: #000000;">) {
            observers.remove(i);
        }
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> notifyObserver() {
        </span><span style="color: #0000ff;">for</span><span style="color: #000000;"> (Observer o : observers) {
            o.update(temperature, humidity, pressure);
        }
    }
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> Observer {
    </span><span style="color: #0000ff;">void</span> update(<span style="color: #0000ff;">float</span> temp, <span style="color: #0000ff;">float</span> humidity, <span style="color: #0000ff;">float</span><span style="color: #000000;"> pressure);
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> StatisticsDisplay <span style="color: #0000ff;">implements</span><span style="color: #000000;"> Observer {

    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> StatisticsDisplay(Subject weatherData) {
        weatherData.reisterObserver(</span><span style="color: #0000ff;">this</span><span style="color: #000000;">);
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> update(<span style="color: #0000ff;">float</span> temp, <span style="color: #0000ff;">float</span> humidity, <span style="color: #0000ff;">float</span><span style="color: #000000;"> pressure) {
        System.out.println(</span>"StatisticsDisplay.update: " + temp + " " + humidity + " " +<span style="color: #000000;"> pressure);
    }
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> CurrentConditionsDisplay <span style="color: #0000ff;">implements</span><span style="color: #000000;"> Observer {

    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> CurrentConditionsDisplay(Subject weatherData) {
        weatherData.registerObserver(</span><span style="color: #0000ff;">this</span><span style="color: #000000;">);
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> update(<span style="color: #0000ff;">float</span> temp, <span style="color: #0000ff;">float</span> humidity, <span style="color: #0000ff;">float</span><span style="color: #000000;"> pressure) {
        System.out.println(</span>"CurrentConditionsDisplay.update: " + temp + " " + humidity + " " +<span style="color: #000000;"> pressure);
    }
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> WeatherStation {
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> main(String[] args) {
        WeatherData weatherData </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> WeatherData();
        CurrentConditionsDisplay currentConditionsDisplay </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> CurrentConditionsDisplay(weatherData);
        StatisticsDisplay statisticsDisplay </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> StatisticsDisplay(weatherData);

        weatherData.setMeasurements(</span>0, 0, 0<span style="color: #000000;">);
        weatherData.setMeasurements(</span>1, 1, 1<span style="color: #000000;">);
    }
}
CurrentConditionsDisplay.update: </span>0.0 0.0 0.0<span style="color: #000000;">
StatisticsDisplay.update: </span>0.0 0.0 0.0<span style="color: #000000;">
CurrentConditionsDisplay.update: </span>1.0 1.0 1.0<span style="color: #000000;">
StatisticsDisplay.update: </span>1.0 1.0 1.0</code></pre>

<p>&nbsp;</p>

<h3><span style="font-size: 16px;">JDK</span></h3>
<ul>
<li><span style="font-size: 16px;"><a class=" wrap external" href="https://link.zhihu.com/?target=http%3A//docs.oracle.com/javase/8/docs/api/java/util/Observer.html" rel="nofollow noreferrer" target="_blank" data-za-detail-view-id="1043">java.util.Observer</a></span></li>
<li><span style="font-size: 16px;"><a class=" wrap external" href="https://link.zhihu.com/?target=http%3A//docs.oracle.com/javase/8/docs/api/java/util/EventListener.html" rel="nofollow noreferrer" target="_blank" data-za-detail-view-id="1043">java.util.EventListener</a></span></li>
<li><span style="font-size: 16px;"><a class=" wrap external" href="https://link.zhihu.com/?target=http%3A//docs.oracle.com/javaee/7/api/javax/servlet/http/HttpSessionBindingListener.html" rel="nofollow noreferrer" target="_blank" data-za-detail-view-id="1043">javax.servlet.http.HttpSessionBindingListener</a></span></li>
<li><span style="font-size: 16px;"><a class=" wrap external" href="https://link.zhihu.com/?target=https%3A//github.com/ReactiveX/RxJava" rel="nofollow noreferrer" target="_blank" data-za-detail-view-id="1043">RxJava</a></span></li>
</ul>
<h2><span style="font-size: 16px;">8. 状态（State）</span></h2>
<h3><span style="font-size: 16px;">Intent</span></h3>
<p><span style="font-size: 16px;">允许对象在内部状态改变时改变它的行为，对象看起来好像修改了它所属的类。</span></p>
<h3><span style="font-size: 16px;">Class Diagram</span></h3>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<p><span style="font-size: 16px;"><img class="origin_image zh-lightbox-thumb lazy" src="./images/Java的23种设计模式，详细讲解（二）12.png" alt="" width="871" data-caption="" data-size="normal" data-rawwidth="871" data-rawheight="383" data-original="https://pic4.zhimg.com/v2-d0d2fa97b45a6f4239827434afd380db_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-d0d2fa97b45a6f4239827434afd380db_b.jpg" data-lazy-status="ok" /></span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<h3><span style="font-size: 16px;">Implementation</span></h3>
<p><span style="font-size: 16px;">糖果销售机有多种状态，每种状态下销售机有不同的行为，状态可以发生转移，使得销售机的行为也发生改变。</span></p>
<p><span style="font-size: 16px;"><img class="origin_image zh-lightbox-thumb lazy" src="./images/Java的23种设计模式，详细讲解（二）13.png" alt="" width="866" data-caption="" data-size="normal" data-rawwidth="866" data-rawheight="604" data-original="https://pic2.zhimg.com/v2-1f5b1ee35f7acff56ecb22127d038a71_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-1f5b1ee35f7acff56ecb22127d038a71_b.jpg" data-lazy-status="ok" /></span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<src class="highlight">
<src class="cnblogs_code">
<pre><code><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> State {
    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     * 投入 25 分钱
     </span><span style="color: #008000;">*/</span>
    <span style="color: #0000ff;">void</span><span style="color: #000000;"> insertQuarter();

    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     * 退回 25 分钱
     </span><span style="color: #008000;">*/</span>
    <span style="color: #0000ff;">void</span><span style="color: #000000;"> ejectQuarter();

    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     * 转动曲柄
     </span><span style="color: #008000;">*/</span>
    <span style="color: #0000ff;">void</span><span style="color: #000000;"> turnCrank();

    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     * 发放糖果
     </span><span style="color: #008000;">*/</span>
    <span style="color: #0000ff;">void</span><span style="color: #000000;"> dispense();
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> HasQuarterState <span style="color: #0000ff;">implements</span><span style="color: #000000;"> State {

    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> GumballMachine gumballMachine;

    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> HasQuarterState(GumballMachine gumballMachine) {
        </span><span style="color: #0000ff;">this</span>.gumballMachine =<span style="color: #000000;"> gumballMachine;
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> insertQuarter() {
        System.out.println(</span>"You can't insert another quarter"<span style="color: #000000;">);
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> ejectQuarter() {
        System.out.println(</span>"Quarter returned"<span style="color: #000000;">);
        gumballMachine.setState(gumballMachine.getNoQuarterState());
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> turnCrank() {
        System.out.println(</span>"You turned..."<span style="color: #000000;">);
        gumballMachine.setState(gumballMachine.getSoldState());
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> dispense() {
        System.out.println(</span>"No gumball dispensed"<span style="color: #000000;">);
    }
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> NoQuarterState <span style="color: #0000ff;">implements</span><span style="color: #000000;"> State {

    GumballMachine gumballMachine;

    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> NoQuarterState(GumballMachine gumballMachine) {
        </span><span style="color: #0000ff;">this</span>.gumballMachine =<span style="color: #000000;"> gumballMachine;
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> insertQuarter() {
        System.out.println(</span>"You insert a quarter"<span style="color: #000000;">);
        gumballMachine.setState(gumballMachine.getHasQuarterState());
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> ejectQuarter() {
        System.out.println(</span>"You haven't insert a quarter"<span style="color: #000000;">);
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> turnCrank() {
        System.out.println(</span>"You turned, but there's no quarter"<span style="color: #000000;">);
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> dispense() {
        System.out.println(</span>"You need to pay first"<span style="color: #000000;">);
    }
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> SoldOutState <span style="color: #0000ff;">implements</span><span style="color: #000000;"> State {

    GumballMachine gumballMachine;

    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> SoldOutState(GumballMachine gumballMachine) {
        </span><span style="color: #0000ff;">this</span>.gumballMachine =<span style="color: #000000;"> gumballMachine;
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> insertQuarter() {
        System.out.println(</span>"You can't insert a quarter, the machine is sold out"<span style="color: #000000;">);
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> ejectQuarter() {
        System.out.println(</span>"You can't eject, you haven't inserted a quarter yet"<span style="color: #000000;">);
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> turnCrank() {
        System.out.println(</span>"You turned, but there are no gumballs"<span style="color: #000000;">);
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> dispense() {
        System.out.println(</span>"No gumball dispensed"<span style="color: #000000;">);
    }
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> SoldState <span style="color: #0000ff;">implements</span><span style="color: #000000;"> State {

    GumballMachine gumballMachine;

    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> SoldState(GumballMachine gumballMachine) {
        </span><span style="color: #0000ff;">this</span>.gumballMachine =<span style="color: #000000;"> gumballMachine;
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> insertQuarter() {
        System.out.println(</span>"Please wait, we're already giving you a gumball"<span style="color: #000000;">);
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> ejectQuarter() {
        System.out.println(</span>"Sorry, you already turned the crank"<span style="color: #000000;">);
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> turnCrank() {
        System.out.println(</span>"Turning twice doesn't get you another gumball!"<span style="color: #000000;">);
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> dispense() {
        gumballMachine.releaseBall();
        </span><span style="color: #0000ff;">if</span> (gumballMachine.getCount() &gt; 0<span style="color: #000000;">) {
            gumballMachine.setState(gumballMachine.getNoQuarterState());
        } </span><span style="color: #0000ff;">else</span><span style="color: #000000;"> {
            System.out.println(</span>"Oops, out of gumballs"<span style="color: #000000;">);
            gumballMachine.setState(gumballMachine.getSoldOutState());
        }
    }
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> GumballMachine {

    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> State soldOutState;
    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> State noQuarterState;
    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> State hasQuarterState;
    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> State soldState;

    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> State state;
    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span> count = 0<span style="color: #000000;">;

    </span><span style="color: #0000ff;">public</span> GumballMachine(<span style="color: #0000ff;">int</span><span style="color: #000000;"> numberGumballs) {
        count </span>=<span style="color: #000000;"> numberGumballs;
        soldOutState </span>= <span style="color: #0000ff;">new</span> SoldOutState(<span style="color: #0000ff;">this</span><span style="color: #000000;">);
        noQuarterState </span>= <span style="color: #0000ff;">new</span> NoQuarterState(<span style="color: #0000ff;">this</span><span style="color: #000000;">);
        hasQuarterState </span>= <span style="color: #0000ff;">new</span> HasQuarterState(<span style="color: #0000ff;">this</span><span style="color: #000000;">);
        soldState </span>= <span style="color: #0000ff;">new</span> SoldState(<span style="color: #0000ff;">this</span><span style="color: #000000;">);

        </span><span style="color: #0000ff;">if</span> (numberGumballs &gt; 0<span style="color: #000000;">) {
            state </span>=<span style="color: #000000;"> noQuarterState;
        } </span><span style="color: #0000ff;">else</span><span style="color: #000000;"> {
            state </span>=<span style="color: #000000;"> soldOutState;
        }
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> insertQuarter() {
        state.insertQuarter();
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> ejectQuarter() {
        state.ejectQuarter();
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> turnCrank() {
        state.turnCrank();
        state.dispense();
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> setState(State state) {
        </span><span style="color: #0000ff;">this</span>.state =<span style="color: #000000;"> state;
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> releaseBall() {
        System.out.println(</span>"A gumball comes rolling out the slot..."<span style="color: #000000;">);
        </span><span style="color: #0000ff;">if</span> (count != 0<span style="color: #000000;">) {
            count </span>-= 1<span style="color: #000000;">;
        }
    }

    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> State getSoldOutState() {
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> soldOutState;
    }

    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> State getNoQuarterState() {
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> noQuarterState;
    }

    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> State getHasQuarterState() {
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> hasQuarterState;
    }

    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> State getSoldState() {
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> soldState;
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> getCount() {
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> count;
    }
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Client {

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> main(String[] args) {
        GumballMachine gumballMachine </span>= <span style="color: #0000ff;">new</span> GumballMachine(5<span style="color: #000000;">);

        gumballMachine.insertQuarter();
        gumballMachine.turnCrank();

        gumballMachine.insertQuarter();
        gumballMachine.ejectQuarter();
        gumballMachine.turnCrank();

        gumballMachine.insertQuarter();
        gumballMachine.turnCrank();
        gumballMachine.insertQuarter();
        gumballMachine.turnCrank();
        gumballMachine.ejectQuarter();

        gumballMachine.insertQuarter();
        gumballMachine.insertQuarter();
        gumballMachine.turnCrank();
        gumballMachine.insertQuarter();
        gumballMachine.turnCrank();
        gumballMachine.insertQuarter();
        gumballMachine.turnCrank();
    }
}
You insert a quarter
You turned...
A gumball comes rolling out the slot...
You insert a quarter
Quarter returned
You turned, but there</span>'s no quarter
<span style="color: #000000;">You need to pay first
You insert a quarter
You turned...
A gumball comes rolling out the slot...
You insert a quarter
You turned...
A gumball comes rolling out the slot...
You haven</span>'t insert a quarter
<span style="color: #000000;">You insert a quarter
You can</span>'t insert another quarter
<span style="color: #000000;">You turned...
A gumball comes rolling out the slot...
You insert a quarter
You turned...
A gumball comes rolling out the slot...
Oops, out of gumballs
You can</span>'t insert a quarter, the machine is sold out
<span style="color: #000000;">You turned, but there are no gumballs
No gumball dispensed</span></code></pre>

<p>&nbsp;</p>

<h2><span style="font-size: 16px;">9. 策略（Strategy）</span></h2>
<h3><span style="font-size: 16px;">Intent</span></h3>
<p><span style="font-size: 16px;">定义一系列算法，封装每个算法，并使它们可以互换。</span></p>
<p><span style="font-size: 16px;">策略模式可以让算法独立于使用它的客户端。</span></p>
<h3><span style="font-size: 16px;">Class Diagram</span></h3>
<ul>
<li><span style="font-size: 16px;">Strategy 接口定义了一个算法族，它们都实现了 behavior() 方法。</span></li>
<li><span style="font-size: 16px;">Context 是使用到该算法族的类，其中的 doSomething() 方法会调用 behavior()，setStrategy(Strategy) 方法可以动态地改变 strategy 对象，也就是说能动态地改变 Context 所使用的算法。</span></li>
</ul>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<p><span style="font-size: 16px;"><img class="origin_image zh-lightbox-thumb lazy" src="./images/Java的23种设计模式，详细讲解（二）14.png" alt="" width="961" data-caption="" data-size="normal" data-rawwidth="961" data-rawheight="357" data-original="https://pic2.zhimg.com/v2-ff5ffa12c9ec19e277cfefef17cc4305_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-ff5ffa12c9ec19e277cfefef17cc4305_b.jpg" data-lazy-status="ok" /></span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<h3><span style="font-size: 16px;">与状态模式的比较</span></h3>
<p><span style="font-size: 16px;">状态模式的类图和策略模式类似，并且都是能够动态改变对象的行为。但是状态模式是通过状态转移来改变 Context 所组合的 State 对象，而策略模式是通过 Context 本身的决策来改变组合的 Strategy 对象。所谓的状态转移，是指 Context 在运行过程中由于一些条件发生改变而使得 State 对象发生改变，注意必须要是在运行过程中。</span></p>
<p><span style="font-size: 16px;">状态模式主要是用来解决状态转移的问题，当状态发生转移了，那么 Context 对象就会改变它的行为；而策略模式主要是用来封装一组可以互相替代的算法族，并且可以根据需要动态地去替换 Context 使用的算法。</span></p>
<h3><span style="font-size: 16px;">Implementation</span></h3>
<p><span style="font-size: 16px;">设计一个鸭子，它可以动态地改变叫声。这里的算法族是鸭子的叫声行为。</span></p>
<src class="highlight">
<src class="cnblogs_code">
<pre><code><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> QuackBehavior {
    </span><span style="color: #0000ff;">void</span><span style="color: #000000;"> quack();
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> Quack <span style="color: #0000ff;">implements</span><span style="color: #000000;"> QuackBehavior {
    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> quack() {
        System.out.println(</span>"quack!"<span style="color: #000000;">);
    }
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> Squeak <span style="color: #0000ff;">implements</span><span style="color: #000000;"> QuackBehavior{
    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> quack() {
        System.out.println(</span>"squeak!"<span style="color: #000000;">);
    }
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Duck {

    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> QuackBehavior quackBehavior;

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> performQuack() {
        </span><span style="color: #0000ff;">if</span> (quackBehavior != <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
            quackBehavior.quack();
        }
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> setQuackBehavior(QuackBehavior quackBehavior) {
        </span><span style="color: #0000ff;">this</span>.quackBehavior =<span style="color: #000000;"> quackBehavior;
    }
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Client {

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> main(String[] args) {
        Duck duck </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> Duck();
        duck.setQuackBehavior(</span><span style="color: #0000ff;">new</span><span style="color: #000000;"> Squeak());
        duck.performQuack();
        duck.setQuackBehavior(</span><span style="color: #0000ff;">new</span><span style="color: #000000;"> Quack());
        duck.performQuack();
    }
}
squeak</span>!<span style="color: #000000;">
quack</span>!</code></pre>

<p>&nbsp;</p>

<h3><span style="font-size: 16px;">JDK</span></h3>
<ul>
<li><span style="font-size: 16px;">java.util.Comparator#compare()</span></li>
<li><span style="font-size: 16px;">javax.servlet.http.HttpServlet</span></li>
<li><span style="font-size: 16px;">javax.servlet.Filter#doFilter()</span></li>
</ul>
<h2><span style="font-size: 16px;">10. 模板方法（Template Method）</span></h2>
<h3><span style="font-size: 16px;">Intent</span></h3>
<p><span style="font-size: 16px;">定义算法框架，并将一些步骤的实现延迟到子类。</span></p>
<p><span style="font-size: 16px;">通过模板方法，子类可以重新定义算法的某些步骤，而不用改变算法的结构。</span></p>
<h3><span style="font-size: 16px;">Class Diagram</span></h3>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<p><span style="font-size: 16px;"><img class="origin_image zh-lightbox-thumb lazy" src="./images/Java的23种设计模式，详细讲解（二）15.png" alt="" width="711" data-caption="" data-size="normal" data-rawwidth="711" data-rawheight="439" data-original="https://pic2.zhimg.com/v2-09e8ca840dbc54991e9b2355d859eead_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-09e8ca840dbc54991e9b2355d859eead_b.jpg" data-lazy-status="ok" /></span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<h3><span style="font-size: 16px;">Implementation</span></h3>
<p><span style="font-size: 16px;">冲咖啡和冲茶都有类似的流程，但是某些步骤会有点不一样，要求复用那些相同步骤的代码。</span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<p><span style="font-size: 16px;"><img class="origin_image zh-lightbox-thumb lazy" src="./images/Java的23种设计模式，详细讲解（二）16.png" alt="" width="1014" data-caption="" data-size="normal" data-rawwidth="1014" data-rawheight="282" data-original="https://pic4.zhimg.com/v2-0be649be7df9b0f31b86eb16a6f87467_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-0be649be7df9b0f31b86eb16a6f87467_b.jpg" data-lazy-status="ok" /></span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<src class="highlight">
<src class="cnblogs_code">
<pre><code><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">abstract</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> CaffeineBeverage {

    </span><span style="color: #0000ff;">final</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> prepareRecipe() {
        boilWater();
        brew();
        pourInCup();
        addCondiments();
    }

    </span><span style="color: #0000ff;">abstract</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> brew();

    </span><span style="color: #0000ff;">abstract</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> addCondiments();

    </span><span style="color: #0000ff;">void</span><span style="color: #000000;"> boilWater() {
        System.out.println(</span>"boilWater"<span style="color: #000000;">);
    }

    </span><span style="color: #0000ff;">void</span><span style="color: #000000;"> pourInCup() {
        System.out.println(</span>"pourInCup"<span style="color: #000000;">);
    }
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> Coffee <span style="color: #0000ff;">extends</span><span style="color: #000000;"> CaffeineBeverage {
    @Override
    </span><span style="color: #0000ff;">void</span><span style="color: #000000;"> brew() {
        System.out.println(</span>"Coffee.brew"<span style="color: #000000;">);
    }

    @Override
    </span><span style="color: #0000ff;">void</span><span style="color: #000000;"> addCondiments() {
        System.out.println(</span>"Coffee.addCondiments"<span style="color: #000000;">);
    }
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> Tea <span style="color: #0000ff;">extends</span><span style="color: #000000;"> CaffeineBeverage {
    @Override
    </span><span style="color: #0000ff;">void</span><span style="color: #000000;"> brew() {
        System.out.println(</span>"Tea.brew"<span style="color: #000000;">);
    }

    @Override
    </span><span style="color: #0000ff;">void</span><span style="color: #000000;"> addCondiments() {
        System.out.println(</span>"Tea.addCondiments"<span style="color: #000000;">);
    }
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Client {
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> main(String[] args) {
        CaffeineBeverage caffeineBeverage </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> Coffee();
        caffeineBeverage.prepareRecipe();
        System.out.println(</span>"-----------"<span style="color: #000000;">);
        caffeineBeverage </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> Tea();
        caffeineBeverage.prepareRecipe();
    }
}
boilWater
Coffee.brew
pourInCup
Coffee.addCondiments
</span>-----------<span style="color: #000000;">
boilWater
Tea.brew
pourInCup
Tea.addCondiments</span></code></pre>

<p>&nbsp;</p>

<h3><span style="font-size: 16px;">JDK</span></h3>
<ul>
<li><span style="font-size: 16px;">java.util.Collections#sort()</span></li>
<li><span style="font-size: 16px;">java.io.InputStream#skip()</span></li>
<li><span style="font-size: 16px;">java.io.InputStream#read()</span></li>
<li><span style="font-size: 16px;">java.util.AbstractList#indexOf()</span></li>
</ul>
<h2><span style="font-size: 16px;">11. 访问者（Visitor）</span></h2>
<h3><span style="font-size: 16px;">Intent</span></h3>
<p><span style="font-size: 16px;">为一个对象结构（比如组合结构）增加新能力。</span></p>
<h3><span style="font-size: 16px;">Class Diagram</span></h3>
<ul>
<li><span style="font-size: 16px;">Visitor：访问者，为每一个 ConcreteElement 声明一个 visit 操作</span></li>
<li><span style="font-size: 16px;">ConcreteVisitor：具体访问者，存储遍历过程中的累计结果</span></li>
<li><span style="font-size: 16px;">ObjectStructure：对象结构，可以是组合结构，或者是一个集合。</span></li>
</ul>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<p><span style="font-size: 16px;"><img class="origin_image zh-lightbox-thumb lazy" src="./images/Java的23种设计模式，详细讲解（二）17.png" alt="" width="891" data-caption="" data-size="normal" data-rawwidth="891" data-rawheight="711" data-original="https://pic1.zhimg.com/v2-106c648f106ec2c195a8c1adb9cb6a54_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-106c648f106ec2c195a8c1adb9cb6a54_b.jpg" data-lazy-status="ok" /></span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<h3><span style="font-size: 16px;">Implementation</span></h3>
<src class="highlight">
<src class="cnblogs_code">
<pre><code><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> Element {
    </span><span style="color: #0000ff;">void</span><span style="color: #000000;"> accept(Visitor visitor);
}
</span><span style="color: #0000ff;">class</span><span style="color: #000000;"> CustomerGroup {

    </span><span style="color: #0000ff;">private</span> List&lt;Customer&gt; customers = <span style="color: #0000ff;">new</span> ArrayList&lt;&gt;<span style="color: #000000;">();

    </span><span style="color: #0000ff;">void</span><span style="color: #000000;"> accept(Visitor visitor) {
        </span><span style="color: #0000ff;">for</span><span style="color: #000000;"> (Customer customer : customers) {
            customer.accept(visitor);
        }
    }

    </span><span style="color: #0000ff;">void</span><span style="color: #000000;"> addCustomer(Customer customer) {
        customers.add(customer);
    }
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> Customer <span style="color: #0000ff;">implements</span><span style="color: #000000;"> Element {

    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> String name;
    </span><span style="color: #0000ff;">private</span> List&lt;Order&gt; orders = <span style="color: #0000ff;">new</span> ArrayList&lt;&gt;<span style="color: #000000;">();

    Customer(String name) {
        </span><span style="color: #0000ff;">this</span>.name =<span style="color: #000000;"> name;
    }

    String getName() {
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> name;
    }

    </span><span style="color: #0000ff;">void</span><span style="color: #000000;"> addOrder(Order order) {
        orders.add(order);
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> accept(Visitor visitor) {
        visitor.visit(</span><span style="color: #0000ff;">this</span><span style="color: #000000;">);
        </span><span style="color: #0000ff;">for</span><span style="color: #000000;"> (Order order : orders) {
            order.accept(visitor);
        }
    }
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> Order <span style="color: #0000ff;">implements</span><span style="color: #000000;"> Element {

    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> String name;
    </span><span style="color: #0000ff;">private</span> List&lt;Item&gt; items = <span style="color: #0000ff;">new</span><span style="color: #000000;"> ArrayList();

    Order(String name) {
        </span><span style="color: #0000ff;">this</span>.name =<span style="color: #000000;"> name;
    }

    Order(String name, String itemName) {
        </span><span style="color: #0000ff;">this</span>.name =<span style="color: #000000;"> name;
        </span><span style="color: #0000ff;">this</span>.addItem(<span style="color: #0000ff;">new</span><span style="color: #000000;"> Item(itemName));
    }

    String getName() {
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> name;
    }

    </span><span style="color: #0000ff;">void</span><span style="color: #000000;"> addItem(Item item) {
        items.add(item);
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> accept(Visitor visitor) {
        visitor.visit(</span><span style="color: #0000ff;">this</span><span style="color: #000000;">);

        </span><span style="color: #0000ff;">for</span><span style="color: #000000;"> (Item item : items) {
            item.accept(visitor);
        }
    }
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> Item <span style="color: #0000ff;">implements</span><span style="color: #000000;"> Element {

    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> String name;

    Item(String name) {
        </span><span style="color: #0000ff;">this</span>.name =<span style="color: #000000;"> name;
    }

    String getName() {
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> name;
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> accept(Visitor visitor) {
        visitor.visit(</span><span style="color: #0000ff;">this</span><span style="color: #000000;">);
    }
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> Visitor {
    </span><span style="color: #0000ff;">void</span><span style="color: #000000;"> visit(Customer customer);

    </span><span style="color: #0000ff;">void</span><span style="color: #000000;"> visit(Order order);

    </span><span style="color: #0000ff;">void</span><span style="color: #000000;"> visit(Item item);
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> GeneralReport <span style="color: #0000ff;">implements</span><span style="color: #000000;"> Visitor {

    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> customersNo;
    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> ordersNo;
    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> itemsNo;

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> visit(Customer customer) {
        System.out.println(customer.getName());
        customersNo</span>++<span style="color: #000000;">;
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> visit(Order order) {
        System.out.println(order.getName());
        ordersNo</span>++<span style="color: #000000;">;
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> visit(Item item) {
        System.out.println(item.getName());
        itemsNo</span>++<span style="color: #000000;">;
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> displayResults() {
        System.out.println(</span>"Number of customers: " +<span style="color: #000000;"> customersNo);
        System.out.println(</span>"Number of orders:    " +<span style="color: #000000;"> ordersNo);
        System.out.println(</span>"Number of items:     " +<span style="color: #000000;"> itemsNo);
    }
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Client {
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> main(String[] args) {
        Customer customer1 </span>= <span style="color: #0000ff;">new</span> Customer("customer1"<span style="color: #000000;">);
        customer1.addOrder(</span><span style="color: #0000ff;">new</span> Order("order1", "item1"<span style="color: #000000;">));
        customer1.addOrder(</span><span style="color: #0000ff;">new</span> Order("order2", "item1"<span style="color: #000000;">));
        customer1.addOrder(</span><span style="color: #0000ff;">new</span> Order("order3", "item1"<span style="color: #000000;">));

        Order order </span>= <span style="color: #0000ff;">new</span> Order("order_a"<span style="color: #000000;">);
        order.addItem(</span><span style="color: #0000ff;">new</span> Item("item_a1"<span style="color: #000000;">));
        order.addItem(</span><span style="color: #0000ff;">new</span> Item("item_a2"<span style="color: #000000;">));
        order.addItem(</span><span style="color: #0000ff;">new</span> Item("item_a3"<span style="color: #000000;">));
        Customer customer2 </span>= <span style="color: #0000ff;">new</span> Customer("customer2"<span style="color: #000000;">);
        customer2.addOrder(order);

        CustomerGroup customers </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> CustomerGroup();
        customers.addCustomer(customer1);
        customers.addCustomer(customer2);

        GeneralReport visitor </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> GeneralReport();
        customers.accept(visitor);
        visitor.displayResults();
    }
}
customer1
order1
item1
order2
item1
order3
item1
customer2
order_a
item_a1
item_a2
item_a3
Number of customers: </span>2<span style="color: #000000;">
Number of orders:    </span>4<span style="color: #000000;">
Number of items:     </span>6</code></pre>

<p>&nbsp;</p>

<h3><span style="font-size: 16px;">JDK</span></h3>
<ul>
<li><span style="font-size: 16px;">javax.lang.model.element.Element and javax.lang.model.element.ElementVisitor</span></li>
<li><span style="font-size: 16px;">javax.lang.model.type.TypeMirror and javax.lang.model.type.TypeVisitor</span></li>
</ul>
<h2><span style="font-size: 16px;">12. 空对象（Null）</span></h2>
<h3><span style="font-size: 16px;">Intent</span></h3>
<p><span style="font-size: 16px;">使用什么都不做的空对象来代替 NULL。</span></p>
<p><span style="font-size: 16px;">一个方法返回 NULL，意味着方法的调用端需要去检查返回值是否是 NULL，这么做会导致非常多的冗余的检查代码。并且如果某一个调用端忘记了做这个检查返回值，而直接使用返回的对象，那么就有可能抛出空指针异常。</span></p>
<h3><span style="font-size: 16px;">Class Diagram</span></h3>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<p><span style="font-size: 16px;"><img class="origin_image zh-lightbox-thumb lazy" src="./images/Java的23种设计模式，详细讲解（二）18.png" alt="" width="1033" data-caption="" data-size="normal" data-rawwidth="1033" data-rawheight="441" data-original="https://pic4.zhimg.com/v2-614b62ca32bd42a2d9930fe033c55583_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-614b62ca32bd42a2d9930fe033c55583_b.jpg" data-lazy-status="ok" /></span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<p class="ztext-empty-paragraph"><span style="font-size: 16px;">&nbsp;</span></p>
<h3><span style="font-size: 16px;">Implementation</span></h3>
<src class="highlight">
<src class="cnblogs_code">
<pre><code><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">abstract</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> AbstractOperation {
    </span><span style="color: #0000ff;">abstract</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> request();
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> RealOperation <span style="color: #0000ff;">extends</span><span style="color: #000000;"> AbstractOperation {
    @Override
    </span><span style="color: #0000ff;">void</span><span style="color: #000000;"> request() {
        System.out.println(</span>"do something"<span style="color: #000000;">);
    }
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> NullOperation <span style="color: #0000ff;">extends</span><span style="color: #000000;"> AbstractOperation{
    @Override
    </span><span style="color: #0000ff;">void</span><span style="color: #000000;"> request() {
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> do nothing</span>
<span style="color: #000000;">    }
}
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Client {
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> main(String[] args) {
        AbstractOperation abstractOperation </span>= func(-1<span style="color: #000000;">);
        abstractOperation.request();
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> AbstractOperation func(<span style="color: #0000ff;">int</span><span style="color: #000000;"> para) {
        </span><span style="color: #0000ff;">if</span> (para &lt; 0<span style="color: #000000;">) {
            </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> NullOperation();
        }
        </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> RealOperation();
    }
}</span></code></pre>

<p>&nbsp;</p>


</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>