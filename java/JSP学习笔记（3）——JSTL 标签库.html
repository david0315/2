<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修JSP学习笔记（3）——JSTL 标签库' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>JSP学习笔记（3）——JSTL 标签库</center></div><div class='banquan'>原文出处:本文由博客园博主Stars-one提供。<br/>
原文连接:https://www.cnblogs.com/kexing/p/11311008.html</div><br>
    <p>JSP Standard Tag Lib，名为JSP标准标签库，<strong>设计的目的主要用来方便我们将数据输出</strong>，而不是使用JSP中的语法<code>&lt;% %&gt; &lt;%= %&gt; &lt;%! %&gt;</code>。</p>
<p>平常使用的话，我们会在JSP在嵌套HTML代码来实现数据的获取，比如说把一个list中的内容转换为表格显示，需要使用到循环，还要在循环中嵌套HTML代码，看起来很不优雅，而且代码不好阅读。</p>
<p>根据JSTL标签所提供的功能，可以将其分为5个类别。</p>
<ul>
<li>核心标签 c.tld</li>
<li>格式化标签 f.tld</li>
<li>SQL 标签 s.tl</li>
<li>XML 标签 x.tld</li>
<li>JSTL 函数</li>
</ul>
<p><strong>标签库可以和EL表达式联用</strong></p>
<h2 id="核心标签库-c.tld">核心标签库 c.tld</h2>
<p><img src="./images/JSP学习笔记（3）——JSTL 标签库0.png" /></p>
<h3 id="set">set</h3>
<p>相当于setAttribute方法</p>
<p><strong>语法:</strong></p>
<pre><code><code>&lt;c:set
   var=&quot;&lt;string&gt;&quot;
   value=&quot;&lt;string&gt;&quot;
   target=&quot;&lt;string&gt;&quot;
   property=&quot;&lt;string&gt;&quot;
   scope=&quot;page|requset|session|application&quot;/&gt;</code></code></pre>
<table>
<thead>
<tr class="header">
<th>属性</th>
<th>描述</th>
<th>是否必要</th>
<th>默认值</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>value</td>
<td>要存储的值</td>
<td>否</td>
<td>主体的内容</td>
</tr>
<tr class="even">
<td>target</td>
<td>要修改的属性所属的对象</td>
<td>否</td>
<td>无</td>
</tr>
<tr class="odd">
<td>property</td>
<td>要修改的属性</td>
<td>否</td>
<td>无</td>
</tr>
<tr class="even">
<td>var</td>
<td>存储信息的变量</td>
<td>否</td>
<td>无</td>
</tr>
<tr class="odd">
<td>scope</td>
<td>var属性的作用域</td>
<td>否</td>
<td>Page</td>
</tr>
</tbody>
</table>
<p><strong>scope属性有四种选择：page,requset,session,application</strong></p>
<pre><code><code>//下面的标签相当于pageContext.setAttribute(&quot;html&quot;);
&lt;c:set var=&quot;html&quot; value=&quot;&lt;h1&gt;hello&lt;/h1&gt;&quot;/&gt;

&lt;c:set var=&quot;html&quot; value=&quot;&lt;h1&gt;hello&lt;/h1&gt;&quot; score=&quot;request&quot;/&gt;</code></code></pre>
<h3 id="out">out</h3>
<p><strong>语法：</strong></p>
<pre><code><code>&lt;c:out value=&quot;&lt;string&gt;&quot; default=&quot;&lt;string&gt;&quot; escapeXml=&quot;&lt;true|false&gt;&quot;/&gt;</code></code></pre>
<table>
<thead>
<tr class="header">
<th>属性</th>
<th>描述</th>
<th>是否必要</th>
<th>默认值</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>value</td>
<td>要输出的内容</td>
<td>是</td>
<td>无</td>
</tr>
<tr class="even">
<td>default</td>
<td>输出的默认值</td>
<td>否</td>
<td>主体中的内容</td>
</tr>
<tr class="odd">
<td>escapeXml</td>
<td>是否忽略XML特殊字符</td>
<td>否</td>
<td>true</td>
</tr>
</tbody>
</table>
<pre><code><code>//html是上面set的内容
//输出&lt;h1&gt;hello&lt;/h1&gt;，忽略了转义
&lt;c:out value=&quot;${pageScope.html}&quot;&gt;&lt;/c:out&gt;
//输出显示一级标题hello
&lt;c:out value=&quot;${pageScope.html}&quot; escapeXml=&quot;false&quot;&gt;&lt;/c:out&gt;</code></code></pre>
<h3 id="if">if</h3>
<p><c:if>标签判断表达式的值，如果表达式的值为 true 则执行其主体内容</p>
<p><strong>语法：</strong></p>
<pre><code><code>&lt;c:if test=&quot;&lt;boolean&gt;&quot; var=&quot;&lt;string&gt;&quot; scope=&quot;&lt;string&gt;&quot;&gt;
   ...
&lt;/c:if&gt;</code></code></pre>
<table>
<thead>
<tr class="header">
<th>属性</th>
<th>描述</th>
<th>是否必要</th>
<th>默认值</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>test</td>
<td>条件</td>
<td>是</td>
<td>无</td>
</tr>
<tr class="even">
<td>var</td>
<td>用于存储条件结果的变量</td>
<td>否</td>
<td>无</td>
</tr>
<tr class="odd">
<td>scope</td>
<td>var属性的作用域</td>
<td>否</td>
<td>page</td>
</tr>
</tbody>
</table>
<pre><code><code>&lt;c:if test=&quot;${&quot;hello&quot;.startWith(&quot;h&quot;)}&quot; var=&quot;flag&quot; &gt;
   &lt;p&gt;hello以h开头&lt;/p&gt;
&lt;/c:if&gt;

//if-else语句
&lt;c:if test=&quot;${&quot;hello&quot;.startWith(&quot;h&quot;)}&quot; var=&quot;flag&quot; &gt;
   &lt;p&gt;hello以h开头&lt;/p&gt;
&lt;/c:if&gt;
&lt;c:if test=&quot;${flag}&quot;&gt;
   &lt;p&gt;hello不以h开头&lt;/p&gt;
&lt;/c:if&gt;</code></code></pre>
<h3 id="remove">remove</h3>
<p><c:remove>标签用于移除一个变量（删除数据），可以指定这个变量的作用域，若未指定，则默认为变量第一次出现的作用域。</p>
<p>语法：</p>
<pre><code><code>//相当于xx.removeAttrbute
&lt;c:remove var=&quot;&lt;string&gt;&quot; scope=&quot;&lt;string&gt;&quot;/&gt;</code></code></pre>
<h3 id="choose">choose</h3>
<pre><code><code>&lt;c:set value=&quot;3000&quot; var=&quot;sal&quot; /&gt;
&lt;c:choose&gt;
    &lt;c:when test=&quot;${sal &lt;3000}&quot;&gt;
        &lt;p&gt;z混日子&lt;/p&gt;
    &lt;/c:when&gt;
    &lt;c:when test=&quot;${sal &gt;=300 and sal &lt;5000}&quot;&gt;
        &lt;p&gt;还算凑合&lt;/p&gt;
    &lt;/c:when&gt;
    &lt;c:otherwise&gt;
        &lt;p&gt;富有&lt;/p&gt;
    &lt;/c:otherwise&gt;
&lt;/c:choose&gt;</code></code></pre>
<h3 id="import">import</h3>
<p>相当于指令 &lt;%@ include<br />
<a href="https://www.runoob.com/jsp/jstl-core-import-tag.html">菜鸟 JSTL-import</a></p>
<h3 id="redirect">redirect</h3>
<p>重定向</p>
<h3 id="url">url</h3>
<p>用于生成url，优点是可以把url存在变量中，之后便于引用</p>
<p><a href="https://www.runoob.com/jsp/jstl-core-url-tag.html">菜鸟 JSTL——url</a></p>
<h3 id="param">param</h3>
<p>可作为上面import,redirect,url中的子标签，表明带参</p>
<h3 id="foreach">forEach</h3>
<p><strong>语法：</strong></p>
<pre><code><code>&lt;c:forEach
    items=&quot;&lt;object&gt;&quot;
    begin=&quot;&lt;int&gt;&quot;
    end=&quot;&lt;int&gt;&quot;
    step=&quot;&lt;int&gt;&quot;
    var=&quot;&lt;string&gt;&quot;
    varStatus=&quot;&lt;string&gt;&quot;&gt;</code></code></pre>
<table>
<thead>
<tr class="header">
<th>属性</th>
<th>描述</th>
<th>是否必要</th>
<th>默认值</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>items</td>
<td>要被循环的信息</td>
<td>否</td>
<td>无</td>
</tr>
<tr class="even">
<td>begin</td>
<td>开始的元素（0=第一个元素，1=第二个元素）</td>
<td>否</td>
<td>0</td>
</tr>
<tr class="odd">
<td>end</td>
<td>最后一个元素（0=第一个元素，1=第二个元素）</td>
<td>否</td>
<td>Last element</td>
</tr>
<tr class="even">
<td>step</td>
<td>每一次迭代的步长</td>
<td>否</td>
<td>1</td>
</tr>
<tr class="odd">
<td>var</td>
<td>代表当前条目的变量名称</td>
<td>否</td>
<td>无</td>
</tr>
<tr class="even">
<td>varStatus</td>
<td>代表循环状态的变量名称</td>
<td>否</td>
<td>无</td>
</tr>
</tbody>
</table>
<pre><code><code>&lt;c:forEach var=&quot;item&quot; items=&quot;${lists}&quot; varStatus=&quot;staus&quot;&gt;
    ${item}
    staus.index 当前的下标 0开始
    staus.count 从1开始
&lt;/c:forEach&gt;</code></code></pre>
<h3 id="fortokens">forTokens</h3>
<p>属性和forEach用于，不过多了一个属性delims，表明分隔符,有多个分隔符使用空格隔开</p>
<pre><code><code>&lt;c:set var=&quot;token&quot; value=&quot;2010,2,3.25,47,58:62&quot;/&gt;
&lt;c:forTokens items=&quot;${token}&quot; delims=&quot;, . :&quot; var=&quot;item&quot;&gt;
    &lt;p&gt;${item}&lt;/p&gt;
&lt;/c:forTokens&gt;</code></code></pre>
<h2 id="格式化标签">格式化标签</h2>
<p><strong>引用：</strong></p>
<pre><code><code>&lt;%@ taglib prefix=&quot;fmt&quot; uri=&quot;http://java.sun.com/jsp/jstl/fmt&quot; %&gt;</code></code></pre>
<h3 id="requestencoding">requestEncoding</h3>
<p>使用<code>&lt;fmt:requestEncoding&gt;</code>标签来指定字符集，用于解码来自表单的数据。在字符集不是ISO-8859-1时必须使用这个标签。</p>
<pre><code><code>&lt;fmt:requestEncoding value=&quot;UTF-8&quot; /&gt;</code></code></pre>
<h3 id="formatnumber">formatNumber</h3>
<pre><code><code>&lt;fmt:formatNumber
  value=&quot;&lt;string&gt;&quot;
  type=&quot;&lt;string&gt;&quot;
  pattern=&quot;&lt;string&gt;&quot;
  currencyCode=&quot;&lt;string&gt;&quot;
  currencySymbol=&quot;&lt;string&gt;&quot;
  groupingUsed=&quot;&lt;string&gt;&quot;
  maxIntegerDigits=&quot;&lt;string&gt;&quot;
  minIntegerDigits=&quot;&lt;string&gt;&quot;
  maxFractionDigits=&quot;&lt;string&gt;&quot;
  minFractionDigits=&quot;&lt;string&gt;&quot;
  var=&quot;&lt;string&gt;&quot;
  scope=&quot;&lt;string&gt;&quot;/&gt;</code></code></pre>
<table>
<thead>
<tr class="header">
<th>属性</th>
<th>描述</th>
<th>是否必要</th>
<th>默认值</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>value</td>
<td>要显示的数字</td>
<td>是</td>
<td>无</td>
</tr>
<tr class="even">
<td>type</td>
<td>NUMBER，CURRENCY，或 PERCENT类型</td>
<td>否</td>
<td>Number</td>
</tr>
<tr class="odd">
<td>pattern</td>
<td>指定一个自定义的格式化模式用与输出</td>
<td>否</td>
<td>无</td>
</tr>
<tr class="even">
<td>currencyCode</td>
<td>货币码（当type=&quot;currency&quot;时）</td>
<td>否</td>
<td>取决于默认区域</td>
</tr>
<tr class="odd">
<td>currencySymbol</td>
<td>货币符号 (当 type=&quot;currency&quot;时)</td>
<td>否</td>
<td>取决于默认区域</td>
</tr>
<tr class="even">
<td>groupingUsed</td>
<td>是否对数字分组 (TRUE 或 FALSE)</td>
<td>否</td>
<td>true</td>
</tr>
<tr class="odd">
<td>maxIntegerDigits</td>
<td>整型数最大的位数</td>
<td>否</td>
<td>无</td>
</tr>
<tr class="even">
<td>minIntegerDigits</td>
<td>整型数最小的位数</td>
<td>否</td>
<td>无</td>
</tr>
<tr class="odd">
<td>maxFractionDigits</td>
<td>小数点后最大的位数</td>
<td>否</td>
<td>无</td>
</tr>
<tr class="even">
<td>minFractionDigits</td>
<td>小数点后最小的位数</td>
<td>否</td>
<td>无</td>
</tr>
<tr class="odd">
<td>var</td>
<td>存储格式化数字的变量</td>
<td>否</td>
<td>Print to page</td>
</tr>
<tr class="even">
<td>scope</td>
<td>var属性的作用域</td>
<td>否</td>
<td>page</td>
</tr>
</tbody>
</table>
<h3 id="fromatdata">fromatData</h3>
<pre><code><code>&lt;fmt:formatDate
  value=&quot;&lt;string&gt;&quot;
  type=&quot;&lt;string&gt;&quot;
  dateStyle=&quot;&lt;string&gt;&quot;
  timeStyle=&quot;&lt;string&gt;&quot;
  pattern=&quot;&lt;string&gt;&quot;
  timeZone=&quot;&lt;string&gt;&quot;
  var=&quot;&lt;string&gt;&quot;
  scope=&quot;&lt;string&gt;&quot;/&gt;</code></code></pre>
<table>
<thead>
<tr class="header">
<th>属性</th>
<th>描述</th>
<th>是否必要</th>
<th>默认值</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>value</td>
<td>要显示的日期</td>
<td>是</td>
<td>无</td>
</tr>
<tr class="even">
<td>type</td>
<td>DATE, TIME, 或 BOTH</td>
<td>否</td>
<td>date</td>
</tr>
<tr class="odd">
<td>dateStyle</td>
<td>FULL, LONG, MEDIUM, SHORT, 或 DEFAULT</td>
<td>否</td>
<td>default</td>
</tr>
<tr class="even">
<td>timeStyle</td>
<td>FULL, LONG, MEDIUM, SHORT, 或 DEFAULT</td>
<td>否</td>
<td>default</td>
</tr>
<tr class="odd">
<td>pattern</td>
<td>自定义格式模式</td>
<td>否</td>
<td>无</td>
</tr>
<tr class="even">
<td>timeZone</td>
<td>显示日期的时区</td>
<td>否</td>
<td>默认时区</td>
</tr>
<tr class="odd">
<td>var</td>
<td>存储格式化日期的变量名</td>
<td>否</td>
<td>显示在页面</td>
</tr>
<tr class="even">
<td>scope</td>
<td>存储格式化日志变量的范围</td>
<td>否</td>
<td>页面</td>
</tr>
</tbody>
</table>
<h2 id="数据库连接">数据库连接</h2>
<p><strong>引用：</strong></p>
<pre><code><code>&lt;%@ taglib prefix=&quot;sql&quot; uri=&quot;http://java.sun.com/jsp/jstl/sql&quot; %&gt;</code></code></pre>
<table>
<thead>
<tr class="header">
<th>标签</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><sql:setDataSource></td>
<td>指定数据源</td>
</tr>
<tr class="even">
<td><sql:query></td>
<td>运行SQL查询语句</td>
</tr>
<tr class="odd">
<td><sql:update></td>
<td>运行SQL更新语句</td>
</tr>
<tr class="even">
<td><sql:param></td>
<td>将SQL语句中的参数设为指定值</td>
</tr>
<tr class="odd">
<td><sql:dateParam></td>
<td>将SQL语句中的日期参数设为指定的java.util.Date 对象值</td>
</tr>
<tr class="even">
<td><sql:transaction></td>
<td>在共享数据库连接中提供嵌套的数据库行为元素，将所有语句以一个事务的形式来运行</td>
</tr>
</tbody>
</table>
<h3 id="连接数据库">连接数据库</h3>
<pre><code><code>&lt;sql:setDataSource var=&quot;myDb&quot;
                       driver=&quot;oracle.jdbc.driver.OracleDriver&quot;
                       url=&quot;jdbc:oracle:thin:@localhost:1521:ORCL&quot;
                       user=&quot;xx&quot;
                       password=&quot;xx&quot;
                       scope=&quot;application&quot;/&gt;</code></code></pre>
<h3 id="查询">查询</h3>
<pre><code><code>&lt;sql:query var=&quot;resultSet&quot; dataSource=&quot;${myDb}&quot;&gt;
        select * from employee  where ename like ? and sal&gt;=? and hiredate&lt;?
        &lt;%--这里的顺序与上面的？顺序相同 --%&gt;
        &lt;sql:param value=&quot;%A%&quot;/&gt;
        &lt;sql:param&gt;1000.0&lt;/sql:param&gt;
        &lt;sql:dateParam value=&quot;${hiredate}&quot;/&gt;
    &lt;/sql:query&gt;</code></code></pre>
<p><strong>注意：结果集对象的类型不是java.sql.ResulSet 的实例，而是javax.servlet.jsp.jstl.sql.Result 的实例</strong></p>
<h3 id="获取数据">获取数据</h3>
<pre><code><code>&lt;c:forEach var=&quot;emp&quot; items=&quot;${resultSet.rows}&quot;&gt;
        &lt;tr&gt;
            &lt;td&gt;${emp.empno}&lt;/td&gt;
            &lt;td&gt;${emp.ename}&lt;/td&gt;
            &lt;td&gt;${emp.job}&lt;/td&gt;
            &lt;td&gt;${emp.mgr}&lt;/td&gt;
            &lt;td&gt;&lt;fmt:formatDate value=&quot;${emp.hiredate}&quot; pattern=&quot;yyyy年MM月dd日&quot;/&gt;&lt;/td&gt;
            &lt;td&gt;&lt;fmt:formatNumber value=&quot;${emp.sal}&quot; type=&quot;currency&quot; /&gt; &lt;/td&gt;
            &lt;td&gt;${emp[&#39;comm&#39;]}&lt;/td&gt;
            &lt;td&gt;${emp[&#39;deptno&#39;]}&lt;/td&gt;
        &lt;/tr&gt;
      &lt;/c:forEach&gt;</code></code></pre>
<h2 id="自定义jstl标签">自定义JSTL标签</h2>
<h3 id="定义类">1. 定义类</h3>
<p>定义一个类，继承与<code>javax.servlet.jsp.tagext.SimpleTagSupport</code>（简单标签的支持类，不允许标签内有主体内容）</p>
<p>重写<code>doTag</code>方法，标签解析之后会自动执行此方法</p>
<p>类中的成员属性名需要与标签的属性名一致，成员属性需要有get/set方法</p>
<p><strong>获得JSP中的out对象：</strong></p>
<pre><code><code>JspContext jspcontext = this.getJspContext();
JspWriter out = jspcontext.getOut();
out.println(s);
</code></code></pre>
<h3 id="编写tlc文件">2. 编写tlc文件</h3>
<p>在web-inf目录下新建tld文件，文件名随意。tlc文件主要说明标签如何使用，是由哪一个类实现和一些标签的属性配置。</p>
<pre><code><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;

&lt;taglib xmlns=&quot;http://java.sun.com/xml/ns/javaee&quot;
        xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
        xsi:schemaLocation=&quot;http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-jsptaglibrary_2_1.xsd&quot;
        version=&quot;2.1&quot;&gt;

    &lt;tlib-version&gt;1.0&lt;/tlib-version&gt;
    &lt;!--下面的两个属性，之后引用需要用到--&gt;
    &lt;short-name&gt;lq&lt;/short-name&gt;
    &lt;uri&gt;http://www.lanqiao.com/tag&lt;/uri&gt;

    &lt;tag&gt;
        &lt;description&gt;完成日期的格式化输出&lt;/description&gt;
        &lt;!--标签名--&gt;
        &lt;name&gt;printDate&lt;/name&gt;
        &lt;!--标签实现类--&gt;
        &lt;tag-class&gt;com.lanqiao.tag.PrintDateTag&lt;/tag-class&gt;
        &lt;!--标签主休形式--&gt;
        &lt;body-content&gt;empty&lt;/body-content&gt;
        &lt;attribute&gt;
            &lt;name&gt;date&lt;/name&gt;
            &lt;!--属性是否必须--&gt;
            &lt;required&gt;false&lt;/required&gt;
            &lt;!--是否可使用EL或脚本求值--&gt;
            &lt;rtexprvalue&gt;true&lt;/rtexprvalue&gt;
            &lt;type&gt;java.util.Date&lt;/type&gt;
        &lt;/attribute&gt;
        &lt;attribute&gt;
            &lt;name&gt;pattern&lt;/name&gt;
            &lt;!--属性是否必须--&gt;
            &lt;required&gt;false&lt;/required&gt;
            &lt;!--是否可使用EL或脚本求值--&gt;
            &lt;rtexprvalue&gt;false&lt;/rtexprvalue&gt;
            &lt;type&gt;java.lang.String&lt;/type&gt;
        &lt;/attribute&gt;
    &lt;/tag&gt;

&lt;/taglib&gt;
</code></code></pre>
<h3 id="引用自定义标签">3. 引用自定义标签</h3>
<p>jsp中使用&lt;%@ taglib prefix=”Short-Name” uri=”uri”%&gt;指令引入标签库才能使用。</p>
<h3 id="使用">4. 使用</h3>
<pre><code><code>request.setAttribute(&quot;now&quot;,new Data());
&lt;lq:printDate date=&quot;${now}&quot;/&gt;</code></code></pre>


</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>