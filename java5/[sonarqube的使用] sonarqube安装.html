<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修[sonarqube的使用] sonarqube安装' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>[sonarqube的使用] sonarqube安装</center></div><div class='banquan'>原文出处:本文由博客园博主alterem提供。<br/>
原文连接:https://www.cnblogs.com/alterem/p/11589690.html</div><br>
    <h3 id="一-.-sonarqube代码质量检查工具简介">一 . SonarQube代码质量检查工具简介</h3>
<blockquote>
<p>Sonar (SonarQube)是一个开源平台，用于管理源代码的质量</p>
<p>Sonar 不只是一个质量数据报告工具，更是代码质量管理平台</p>
</blockquote>
<p>支持Java, C#, C/C++, PL/SQL, Cobol, JavaScrip, Groovy 等等二十几种编程语言的代码质量管理与检测。</p>
<p>Sonar可以从以下七个维度检测代码质量，而作为开发人员至少需要处理前5种代码质量问题。</p>
<ol>
<li><p>不遵循代码标准</p></li>
<li><p>sonar可以通过PMD,CheckStyle,Findbugs等等代码规则检测工具规范代码编写。</p></li>
<li><p>潜在的缺陷</p>
<p>sonar可以通过PMD,CheckStyle,Findbugs等等代码规则检测工具检 测出潜在的缺陷。</p></li>
<li><p>糟糕的复杂度分布</p>
<p>文件、类、方法等，如果复杂度过高将难以改变，这会使得开发人员 难以理解它们, 且如果没有自动化的单元测试，对于程</p>
<p>序中的任何组件的改变都将可能导致需要全面的回归测试。</p></li>
<li><p>重复</p>
<p>显然程序中包含大量复制粘贴的代码是质量低下的，sonar可以展示 源码中重复严重的地方。</p></li>
<li><p>注释不足或者过多</p>
<p>没有注释将使代码可读性变差，特别是当不可避免地出现人员变动 时，程序的可读性将大幅下降 而过多的注释又会使得开发人员将精力过多地花费在阅读注释上，亦违背初衷。</p></li>
<li><p>缺乏单元测试</p>
<p>sonar可以很方便地统计并展示单元测试覆盖率。</p></li>
<li><p>糟糕的设计</p>
<p>通过sonar可以找出循环，展示包与包、类与类之间的相互依赖关系，可以检测自定义的架构规则 通过sonar可以管理第三方</p>
<p>的jar包，可以利用LCOM4检测单个任务规则的应用情况， 检测藕合。</p>
<h4 id="为什么要选择sonarqube">为什么要选择sonarQube?</h4></li>
</ol>
<p>个人使用之后认为 : sonarQube的优势如下(相比于阿里编码规约这种市面上常见类似软件):</p>
<ol>
<li><p>更加优秀的图形化界面</p>
<p>基本上通过界面就可以对自己项目的代码状况一目了然</p></li>
<li><p>可以查询出其它软件难以定位到的问题</p>
<p>比如 :</p>
<p>可能导致空指针异常的问题 (对象在进行使用前没有加空的判断)</p>
<p>可能导致内存泄漏的问题, 在try catch 块里面,直接使用e.printStackTrace()将堆栈信息打印到内存的</p>
<p>可能导致的漏洞 : 成员变量使用public定义的</p>
<p>还有诸如 : 流等未关闭或者是非正常关闭都能够检测出来!</p>
<p>功能非常强大!!</p></li>
</ol>
<h3 id="二.-安装">二. 安装：</h3>
<h4 id="安装sonarqube-web-server">2.1 安装SonarQube web server</h4>
<ol>
<li><p>首先确保安装了jdk1.8 +</p></li>
<li><p>到此链接 https://www.sonarqube.org/downloads/</p></li>
</ol>
<p>下载sonalqube(下载社区版,是开源的),</p>
<p>我下载的是sonarqube-7.2.1，因为最新版<strong>7.9.1</strong>需要<strong>jdk11</strong>支持</p>
<p>并解压,解压完之后的目录如下 :</p>
<p><img src="./images/[sonarqube的使用] sonarqube安装0.png" /></p>
<ol>
<li>到解压目录的bin\macosx-universal-64(对应系统)目录下:</li>
</ol>
<p>linux、Mac <code>sh sonar.sh start</code>启动</p>
<p>windows 双击<code>StartSonar.bat</code> 启动</p>
<ol>
<li><p>到浏览器界面,输入 : http://localhost:9000</p>
<p>如果能访问表明安装成功</p></li>
</ol>
<h4 id="安装数据库">2.2 安装数据库</h4>
<ol>
<li><p>版本要求:</p>
<p>在conf目录下的sonar.properties文件下:</p>
<p>有这样一行配置 :</p>
<pre><code><code>#----- MySQL &gt;=5.6 &amp;&amp; &lt; 8.0</code></code></pre></li>
<li><p>为sonarqube 创建一个数据库</p></li>
</ol>
<pre class="sql"><code>create database sonar;
-- 创建数据库</code></code></pre>
<ol>
<li>创建sonarqube用户并进行授权</li>
</ol>
<pre class="sql"><code>CREATE USER &#39;username&#39;@&#39;host&#39; IDENTIFIED BY &#39;password&#39;; 
-- 创建用户并设置密码
-- username 为创建的用户名
-- host 为对应的主机地址,本地就是localhost
-- password 为设置的密码
GRANT ALL ON *.* TO &#39;username&#39;@&#39;localhost&#39;;
-- 对用户进行授权操作</code></code></pre>
<ol>
<li>修改SonarQube配置文件,添加Mysql相关配置</li>
</ol>
<pre><code><code>sonar.jdbc.url=jdbc:mysql://localhost:3306/sonar?useUnicode=true&amp;characterEncoding=utf8&amp;rewriteBatchedStatements=true&amp;useConfigs=maxPerformance&amp;useSSL=false
# 刚刚创建的sonarQube用户
sonar.jdbc.username=sonar
# 创建用户对应的密码
sonar.jdbc.password=sonar
# 设置编码格式为UTF-8
sonar.sorceEncoding=UTF-8
# sonar登陆用户名
sonar.login=admin
# sonar登陆密码
sonar.password=admin</code></code></pre>
<h4 id="重新启动服务端">2.3 重新启动服务端</h4>
<ol>
<li>退出 SonarQube 服务端</li>
</ol>
<p>在之前弹出的cmd窗口执行ctrl + c,</p>
<p>弹出来的提示选择Y,退出SonarQube服务</p>
<ol>
<li>双击StartSonar.bat文件, 重新启动SonarQube</li>
</ol>
<p>这次因为要进行数据库的初始化操作,所以需要的时间可能稍微久一点</p>
<ol>
<li><p>启动成功后,浏览器输入 : http://localhost:9000 进入界面</p></li>
<li><p>登录</p>
<p>点击界面右上角的登录按钮, 进行登录 :</p>
<p>初始的账户名 : admin</p>
<p>初始的密码 : admin</p>
<p>附 : 一些关键配置的修改,如 主机地址,context,端口号等:</p>
<p>通常情况下使用默认的配置即可!</p>
<p>文件 /conf/sonar.properties</p>
<pre><code><code>#sonar.web.host=0.0.0.0 
#sonar.web.context=
#sonar.web.port=9000</code></code></pre></li>
</ol>
<h3 id="三.-使用">三. 使用</h3>
<h4 id="安装必要的插件-汉化包举例">3.1. 安装必要的插件 (汉化包举例)</h4>
<p>点击 导航栏的 Administration, 选择Marketplace</p>
<p>搜索 Chinese pack, 点击install进行安装</p>
<p>安装成功后, 重启 SonarQube !</p>
<p><img src="./images/[sonarqube的使用] sonarqube安装1.png" alt="pack" /></p>
<h4 id="开始分析项目代码源代码">3.2. 开始分析项目代码源代码</h4>
<p>使用maven的方式进行分析</p>
<h5 id="编辑maven-的settings.xml文件">3.2.1 编辑maven 的settings.xml文件</h5>
<pre class="xml"><code>&lt;settings&gt;
    &lt;pluginGroups&gt;
        &lt;pluginGroup&gt;org.sonarsource.scanner.maven&lt;/pluginGroup&gt;
    &lt;/pluginGroups&gt;
    &lt;profiles&gt;
        &lt;profile&gt;
            &lt;id&gt;sonar&lt;/id&gt;
            &lt;activation&gt;
                &lt;activeByDefault&gt;true&lt;/activeByDefault&gt;
            &lt;/activation&gt;
            &lt;properties&gt;
                &lt;sonar.host.url&gt;http://loaclhost:9000&lt;/sonar.host.url&gt;
            &lt;/properties&gt;
        &lt;/profile&gt;
     &lt;/profiles&gt;
&lt;/settings&gt;</code></code></pre>
<p>其中sonar.host.url 值就是 上文启动的sonar 服务器地址。</p>
<h5 id="对maven项目进行分析">3.2.2 对maven项目进行分析</h5>
<p>到项目所在的文件路径下:</p>
<p>使用命令提示符或者是power shell执行 如下命令:</p>
<pre class="shell"><code>mvn org.sonarsource.scanner.maven:sonar-maven-plugin:3.6.0.1398:sonar</code></code></pre>
<p>出现: BUILD SUCCESS 标识之后</p>
<p><img src="./images/[sonarqube的使用] sonarqube安装2.png" alt="BUILD SUCCESS" /></p>
<p>刷新界面查看 :</p>
<p><img src="./images/[sonarqube的使用] sonarqube安装3.png" /></p>
<p><img src="./images/[sonarqube的使用] sonarqube安装4.png" /></p>
<h4 id="配置分析参数">3.3 配置分析参数</h4>
<p>强制参数：</p>
<ol>
<li>Server<br />
sonar.host.url http://localhost:9000</li>
<li>Project Configuration<br />
sonar.projectKey Maven <groupId>:<artifactId><br />
sonar.sources Maven 默认的源码路径</li>
</ol>
<p>可以配置的参数：</p>
<ol>
<li><p>Project identity<br />
sonar.projectName 项目名称<br />
sonar.projectversion 项目版本</p></li>
<li><p>Authentication<br />
sonar.login 分析该项目的用户名称<br />
sonar.password 分析该项目的用户密码</p>
<h4 id="程序员用户使用说明">3.4. 程序员用户使用说明</h4></li>
</ol>
<p>SonarQube Web管理者通过配置和设置以下参数值对项目源代码进行：</p>
<p>复杂度、覆盖率、文档、重复、问题、可维护性、可靠性、安全性、大小等约束和规范。</p>
<p>sonar中的质量阈管理以下内容。</p>
<pre class="scheme"><code>复杂度
                    复杂度
                    复杂度/类
                    复杂度/文件
                    复杂度/方法
                覆盖率
                    分支覆盖
                    集成测试的新分支覆盖
                    新代码的分支覆盖率
                    覆盖率
                    新集成测试覆盖
                    新覆盖率
                    集成测试分支覆盖
                    集成测试覆盖
                    集成测试覆盖行
                    集成测试未覆盖分支
                    集成测试未覆盖行
                    代码覆盖率
                    集成测试的新行覆盖
                    新代码覆盖率
                    代码行
                    集成测试的新行覆盖
                    覆盖的新代码
                    总体分支覆盖率
                    总体新分支覆盖率
                    总体覆盖率
                    总体新覆盖率
                    总体代码覆盖率
                    总体新代码覆盖率
                    总体覆盖的新行数
                    总体未覆盖分支
                    总体未覆盖的新分支
                    总体未覆盖代码
                    总体未覆盖新行数
                    单元测试忽略数
                    未覆盖分支
                    集成测试未覆盖的新分支
                    未覆盖新分支
                    未覆盖的代码
                    集成测试未覆盖的行
                    未覆盖的新代码
                    单元测试持续时间
                    单元测试错误数
                    单元测试失败数
                    单元测试成功 (%)
                    单元测试数
                文档
                    注释行
                    注释 (%)
                    公共API
                    公共注释的API (%)
                    公共未注释的API
                重复
                    重复块
                    重复文件
                    重复行
                    重复行(%)
                问题
                    阻断违规
                    确认问题
                    严重违规
                    误判问题
                    提示违规
                    违规
                    主要违规
                    次要违规
                    新阻断违规
                    新严重违规
                    新提示违规
                    新违规
                    新主要违规
                    新次要违规
                    开启问题
                    重开问题
                    不修复的问题
                可维护性
                    新代码的技术债务
                    坏味道
                    达到可维护性A级所需的工作
                    新增坏味道
                    技术债务
                    技术债务比率
                    新代码技术债务比率
                    Management
                    Burned budget
                    Business value
                    Team size
                可靠性
                    Bugs
                    新增Bugs
                    可靠性修复工作
                    新代码的可靠性修复工作
                安全性
                    新增漏洞
                    安全修复工作
                    新代码的安全修复工作
                    漏洞
                大小
                    类
                    目录
                    文件
                    方法
                    生成的行数
                    生成的代码行数
                    行数
                    代码行数
                    项目
                    语句</code></code></pre>


</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>