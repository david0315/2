<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='ç”µè„‘,ç”µè„‘è®²è§£,ç”µè„‘æŠ€æœ¯,ç¼–ç¨‹,ç”µè„‘æ•…éšœç»´ä¿®SpringBoot æºç è§£æ ï¼ˆä¹ï¼‰----- Spring Bootçš„æ ¸å¿ƒèƒ½åŠ› - æ•´åˆMybatis' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>é¦–é¡µ</a></li>
</div><div onclick='hidden1()' >åˆ†äº«</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>SpringBoot æºç è§£æ ï¼ˆä¹ï¼‰----- Spring Bootçš„æ ¸å¿ƒèƒ½åŠ› - æ•´åˆMybatis</center></div><div class='banquan'>åŸæ–‡å‡ºå¤„:æœ¬æ–‡ç”±åšå®¢å›­åšä¸»chen_haoæä¾›ã€‚<br/>
åŸæ–‡è¿æ¥:https://www.cnblogs.com/java-chen-hao/p/11849869.html</div><br>
    <p>æœ¬ç¯‡æˆ‘ä»¬åœ¨SpringBootä¸­æ•´åˆMybatisè¿™ä¸ªormæ¡†æ¶ï¼Œæ¯•ç«Ÿåˆ†æä¸€ä¸‹å…¶è‡ªåŠ¨é…ç½®çš„æºç ï¼Œæˆ‘ä»¬å…ˆæ¥å›é¡¾ä¸€ä¸‹ä»¥å‰Springä¸­æ˜¯å¦‚ä½•æ•´åˆMybatisçš„ï¼Œå¤§å®¶å¯ä»¥çœ‹çœ‹æˆ‘è¿™ç¯‡æ–‡ç« <a class="entry" href="https://www.cnblogs.com/java-chen-hao/p/11833780.html" target="_blank">Mybaits æºç è§£æ ï¼ˆåï¼‰----- Spring-Mybatisæ¡†æ¶ä½¿ç”¨ä¸æºç è§£æ</a>&nbsp;</p>
<h2>Spring-Mybatisä½¿ç”¨</h2>
<h3>æ·»åŠ mavenä¾èµ–</h3>
<src class="cnblogs_code">
<pre><code><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">dependency</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>org.springframework<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>spring-jdbc<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">version</span><span style="color: #0000ff;">&gt;</span>4.3.8.RELEASE<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">version</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">dependency</span><span style="color: #0000ff;">&gt;</span>

<span style="color: #008000;">&lt;!--</span><span style="color: #008000;"> https://mvnrepository.com/artifact/org.mybatis/mybatis-spring </span><span style="color: #008000;">--&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">dependency</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>org.mybatis<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span><strong>mybatis-spring</strong><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">version</span><span style="color: #0000ff;">&gt;</span>1.3.2<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">version</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">dependency</span><span style="color: #0000ff;">&gt;</span></code></pre>

<h3>åœ¨src/main/resourcesä¸‹æ·»åŠ mybatis-config.xmlæ–‡ä»¶</h3>
<src class="cnblogs_code">
<pre><code><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="UTF-8"</span><span style="color: #0000ff;">?&gt;</span>
<span style="color: #0000ff;">&lt;!</span><span style="color: #ff00ff;">DOCTYPE configuration
        PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-config.dtd"</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">configuration</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">typeAliases</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">typeAlias </span><span style="color: #ff0000;">alias</span><span style="color: #0000ff;">="User"</span><span style="color: #ff0000;"> type</span><span style="color: #0000ff;">="com.chenhao.bean.User"</span> <span style="color: #0000ff;">/&gt;</span>
    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">typeAliases</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">plugins</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">plugin </span><span style="color: #ff0000;">interceptor</span><span style="color: #0000ff;">="com.github.pagehelper.PageInterceptor"</span><span style="color: #0000ff;">&gt;</span>
            <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">property </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">="helperDialect"</span><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">="mysql"</span><span style="color: #0000ff;">/&gt;</span>
        <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">plugin</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">plugins</span><span style="color: #0000ff;">&gt;</span>

<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">configuration</span><span style="color: #0000ff;">&gt;</span></code></pre>

<h3>åœ¨src/main/resources/mapperè·¯å¾„ä¸‹æ·»åŠ User.xml</h3>
<src class="cnblogs_code">
<pre><code><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="UTF-8"</span><span style="color: #0000ff;">?&gt;</span>
<span style="color: #0000ff;">&lt;!</span><span style="color: #ff00ff;">DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span><span style="color: #0000ff;">&gt;</span>
    
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">mapper </span><span style="color: #ff0000;">namespace</span><span style="color: #0000ff;">="com.chenhao.mapper.UserMapper"</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">select </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="getUser"</span><span style="color: #ff0000;"> parameterType</span><span style="color: #0000ff;">="int"</span><span style="color: #ff0000;">
        resultType</span><span style="color: #0000ff;">="com.chenhao.bean.User"</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
        SELECT *
        FROM USER
        WHERE id = #{id}
    </span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">select</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">mapper</span><span style="color: #0000ff;">&gt;</span></code></pre>

<h3>åœ¨src/main/resources/è·¯å¾„ä¸‹æ·»åŠ beans.xml</h3>
<src class="cnblogs_code">
<pre><code><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="UTF-8"</span><span style="color: #0000ff;">?&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">beans </span><span style="color: #ff0000;">xmlns</span><span style="color: #0000ff;">="http://www.springframework.org/schema/beans"</span><span style="color: #ff0000;">
    xmlns:xsi</span><span style="color: #0000ff;">="http://www.w3.org/2001/XMLSchema-instance"</span><span style="color: #ff0000;">
    xsi:schemaLocation</span><span style="color: #0000ff;">="http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd"</span><span style="color: #0000ff;">&gt;</span>
 
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">bean </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="dataSource"</span><span style="color: #ff0000;"> class</span><span style="color: #0000ff;">="org.springframework.jdbc.datasource.DriverManagerDataSource"</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">property </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">="driverClassName"</span><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">="com.mysql.jdbc.Driver"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">property</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">property </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">="url"</span><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">="jdbc:mysql://127.0.0.1:3306/test"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">property</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">property </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">="username"</span><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">="root"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">property</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">property </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">="password"</span><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">="root"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">property</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">bean</span><span style="color: #0000ff;">&gt;</span>
 
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">bean </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="sqlSessionFactory"</span><span style="color: #ff0000;"> class</span><span style="color: #0000ff;">="org.mybatis.spring.SqlSessionFactoryBean"</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">property </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">="configLocation"</span><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">="classpath:mybatis-config.xml"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">property</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">property </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">="dataSource"</span><span style="color: #ff0000;"> ref</span><span style="color: #0000ff;">="dataSource"</span> <span style="color: #0000ff;">/&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">property </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">="mapperLocations"</span><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">="classpath:mapper/*.xml"</span> <span style="color: #0000ff;">/&gt;</span>
    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">bean</span><span style="color: #0000ff;">&gt;</span>
    
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">bean </span><span style="color: #ff0000;">class</span><span style="color: #0000ff;">="org.mybatis.spring.mapper.MapperScannerConfigurer"</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">property </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">="basePackage"</span><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">="com.chenhao.mapper"</span> <span style="color: #0000ff;">/&gt;</span>
    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">bean</span><span style="color: #0000ff;">&gt;</span>
 
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">beans</span><span style="color: #0000ff;">&gt;</span></code></pre>

<h3>æ³¨è§£çš„æ–¹å¼</h3>
<ul>
<li>ä»¥ä¸Šåˆ†æéƒ½æ˜¯åœ¨springçš„XMLé…ç½®æ–‡ä»¶applicationContext.xmlè¿›è¡Œé…ç½®çš„ï¼Œmybatis-springä¹Ÿæä¾›äº†åŸºäºæ³¨è§£çš„æ–¹å¼æ¥é…ç½®sqlSessionFactoryå’ŒMapperæ¥å£ã€‚</li>
<li>sqlSessionFactoryä¸»è¦æ˜¯åœ¨@Configurationæ³¨è§£çš„é…ç½®ç±»ä¸­ä½¿ç”¨@Beanæ³¨è§£çš„åä¸ºsqlSessionFactoryçš„æ–¹æ³•æ¥é…ç½®ï¼›</li>
<li>Mapperæ¥å£ä¸»è¦æ˜¯é€šè¿‡åœ¨@Configurationæ³¨è§£çš„é…ç½®ç±»ä¸­ç»“åˆ@MapperScanæ³¨è§£æ¥æŒ‡å®šéœ€è¦æ‰«æè·å–mapperæ¥å£çš„åŒ…ã€‚</li>
</ul>
<src class="cnblogs_code">
<pre><code><span style="color: #000000;">@Configuration
<strong>@MapperScan(</strong></span><strong>"com.chenhao.mapper"<span style="color: #000000;">)
</span></strong><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> AppConfig {

  @Bean
  </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> DataSource dataSource() {
     </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> EmbeddedDatabaseBuilder()
            .addScript(</span>"schema.sql"<span style="color: #000000;">)
            .build();
  }
 
  @Bean
  </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> DataSourceTransactionManager transactionManager() {
    </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> DataSourceTransactionManager(dataSource());
  }
 
  @Bean
  </span><span style="color: #0000ff;">public</span> SqlSessionFactory sqlSessionFactory() <span style="color: #0000ff;">throws</span><span style="color: #000000;"> Exception {
    </span><strong><span style="color: #008000;">//</span><span style="color: #008000;">åˆ›å»ºSqlSessionFactoryBeanå¯¹è±¡</span>
    SqlSessionFactoryBean sessionFactory = <span style="color: #0000ff;">new</span><span style="color: #000000;"> SqlSessionFactoryBean();
    </span><span style="color: #008000;">//</span><span style="color: #008000;">è®¾ç½®æ•°æ®æº</span>
<span style="color: #000000;">    sessionFactory.setDataSource(dataSource());
    </span><span style="color: #008000;">//</span><span style="color: #008000;">è®¾ç½®Mapper.xmlè·¯å¾„</span>
    sessionFactory.setMapperLocations(<span style="color: #0000ff;">new</span> PathMatchingResourcePatternResolver().getResources("classpath:mapper/*.xml"<span style="color: #000000;">));
    </span></strong><span style="color: #008000;">//</span><span style="color: #008000;"> è®¾ç½®MyBatisåˆ†é¡µæ’ä»¶</span>
    PageInterceptor pageInterceptor = <span style="color: #0000ff;">new</span><span style="color: #000000;"> PageInterceptor();
    Properties properties </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> Properties();
    properties.setProperty(</span>"helperDialect", "mysql"<span style="color: #000000;">);
    pageInterceptor.setProperties(properties);
    sessionFactory.setPlugins(</span><span style="color: #0000ff;">new</span><span style="color: #000000;"> Interceptor[]{pageInterceptor});
    </span><span style="color: #0000ff;">return</span><span style="color: #000000;"><strong> sessionFactory.getObject();</strong>
  }
}</span></code></pre>

<p>æœ€æ ¸å¿ƒçš„æœ‰ä¸¤ç‚¹ï¼š</p>
<ul>
<li>åˆ›å»ºä¸€ä¸ªSqlSessionFactoryBeanï¼Œå¹¶è®¾ç½®æ•°æ®æºå’ŒMapper.xmlè·¯å¾„ï¼Œå…¶ä¸­ä¼šè§£æMapper.xmlæ–‡ä»¶ï¼Œæœ€åé€šè¿‡getObject()è¿”å›ä¸€ä¸ªSqlSessionFactory æ³¨å…¥Springå®¹å™¨ä¸­</li>
<li>é€šè¿‡@MapperScanæ‰«ææ‰€æœ‰Mapperæ¥å£ï¼Œæ‰«æè¿‡ç¨‹ä¼šå°†Mapperæ¥å£ç”ŸæˆMapperFactoryBeanè¿™ä¸ªç‰¹æ®Šçš„Beanï¼Œå¹¶ä¸”åœ¨å…¶getObject()é€šè¿‡SqlSession().getMapper(this.mapperInterface)ç”Ÿæˆæ¯ä¸ªmapperæ¥å£çœŸå®çš„ä»£ç†ç±»</li>
</ul>
<p><strong>MapperFactoryBean</strong></p>
<src class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;">æœ€ç»ˆæ³¨å…¥Springå®¹å™¨çš„å°±æ˜¯è¿™é‡Œçš„è¿”å›å¯¹è±¡</span>
<span style="color: #0000ff;">public</span> T getObject() <span style="color: #0000ff;">throws</span><span style="color: #000000;"> Exception {
    </span><span style="color: #008000;">//</span><span style="color: #008000;">è·å–çˆ¶ç±»setSqlSessionFactoryæ–¹æ³•ä¸­åˆ›å»ºçš„SqlSessionTemplate
    </span><span style="color: #008000;">//</span><span style="color: #008000;">é€šè¿‡SqlSessionTemplateè·å–mapperInterfaceçš„ä»£ç†ç±»
    </span><span style="color: #008000;">//</span><span style="color: #008000;">æˆ‘ä»¬ä¾‹å­ä¸­å°±æ˜¯é€šè¿‡SqlSessionTemplateè·å–com.chenhao.mapper.UserMapperçš„ä»£ç†ç±»
    </span><span style="color: #008000;">//</span><span style="color: #008000;">è·å–åˆ°Mapperæ¥å£çš„ä»£ç†ç±»åï¼Œå°±æŠŠè¿™ä¸ªMapperçš„ä»£ç†ç±»å¯¹è±¡æ³¨å…¥Springå®¹å™¨</span>
    <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">this</span>.getSqlSession().getMapper(<span style="color: #0000ff;">this</span><span style="color: #000000;">.mapperInterface);
}</span></code></pre>

<p>æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹SpringBootæ˜¯å¦‚ä½•å¼•å…¥Mybatisçš„</p>
<h2>SpringBootå¼•å…¥Mybatis</h2>
<h3>æ·»åŠ mybatisä¾èµ–</h3>
<src class="cnblogs_code">
<pre><code><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">dependency</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>com.alibaba<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>druid<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">version</span><span style="color: #0000ff;">&gt;</span>1.1.9<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">version</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">dependency</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">dependency</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>org.mybatis.spring.boot<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span><strong>mybatis-spring-boot-starter</strong><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">version</span><span style="color: #0000ff;">&gt;</span>1.3.2<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">version</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">dependency</span><span style="color: #0000ff;">&gt;</span></code></pre>

<h3>å…¨å±€é…ç½®æ–‡ä»¶ä¸­é…ç½®æ•°æ®æºå’Œmybatiså±æ€§</h3>
<src class="cnblogs_code">
<pre><code><strong><span style="color: #000000;">spring:
  datasource:
    url: jdbc:mysql:</span>///<span style="color: #000000;">springboot
    username: root
    password: admin
    </span><span style="color: #ff00ff;">type</span><span style="color: #000000;">: com.alibaba.druid.pool.DruidDataSource
    initialSize: </span><span style="color: #800080;">5</span><span style="color: #000000;">
    minIdle: </span><span style="color: #800080;">5</span><span style="color: #000000;">
    maxActive: </span><span style="color: #800080;">20</span><span style="color: #000000;">
mybatis:
  config</span>-location: classpath:mybatis/mybatis-<span style="color: #000000;">config.xml
  mapper</span>-locations: classpath:mybatis/mapper/*<span style="color: #000000;">.xml
  </span><span style="color: #ff00ff;">type</span>-aliases-package: org.com.cay.spring.boot.entity</strong></code></pre>

<h3><span>åŠ å…¥Mapperæ‰«ææ³¨è§£@MapperScan</span></h3>
<src class="cnblogs_code">
<pre><code><span style="color: #000000;">@SpringBootApplication
@EnableScheduling
@ServletComponentScan
<strong>@MapperScan(</strong></span><strong>"com.supplychain.app.mapper"<span style="color: #000000;">)
</span></strong><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Application {

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> main(String[] args) {
        TimeZone.setDefault(TimeZone.getTimeZone(</span>"GMT+8"<span style="color: #000000;">));
        System.setProperty(</span>"user.timezone", "GMT+8"<span style="color: #000000;">);
        SpringApplication.run(Application.</span><span style="color: #0000ff;">class</span><span style="color: #000000;">, args);
    }
}</span></code></pre>

<h2>æºç è§£æ</h2>
<h3><strong>mybatis-spring-boot-starter</strong></h3>
<p><img src="./images/SpringBoot æºç è§£æ ï¼ˆä¹ï¼‰----- Spring Bootçš„æ ¸å¿ƒèƒ½åŠ› - æ•´åˆMybatis0.png" alt="" /></p>
<p>æˆ‘ä»¬çœ‹åˆ°mybatis-spring-boot-starterå®é™…ä¸Šå¼•å…¥äº†jdbcçš„åœºæ™¯å¯åŠ¨å™¨ï¼Œè¿™ä¸€å—æˆ‘ä»¬ä¸Šä¸€ç¯‡æ–‡ç« å·²ç»åˆ†æè¿‡äº†ï¼Œè¿˜å¼•å…¥äº†mybatis-springçš„ä¾èµ–ï¼Œæœ€ç»ˆè¿˜å¼•å…¥äº†mybatis-spring-boot-autoconfigureè¿™ä¸ªä¾èµ–ï¼Œå…¶å®mybatis-spring-boot-starteråªæ˜¯å¼•å…¥å„ç§éœ€è¦çš„ä¾èµ–ï¼Œæœ€æ ¸å¿ƒçš„ä»£ç æ˜¯åœ¨å¼•å…¥çš„mybatis-spring-boot-autoconfigureè¿™ä¸ªé¡¹ç›®å½“ä¸­ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹è¿™ä¸ªé¡¹ç›®</p>
<p><img src="./images/SpringBoot æºç è§£æ ï¼ˆä¹ï¼‰----- Spring Bootçš„æ ¸å¿ƒèƒ½åŠ› - æ•´åˆMybatis1.png" alt="" /><img src="./images/SpringBoot æºç è§£æ ï¼ˆä¹ï¼‰----- Spring Bootçš„æ ¸å¿ƒèƒ½åŠ› - æ•´åˆMybatis2.png" alt="" /></p>
<p>æˆ‘ä»¬çœ‹åˆ°mybatis-spring-boot-autoconfigureä¹Ÿåƒspring-boot-autoconfigureä¸€æ ·é…ç½®äº†spring.factoriesè¿™ä¸ªé…ç½®æ–‡ä»¶ï¼Œå¹¶ä¸”åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®äº†MybatisAutoConfigurationè¿™ä¸ªè‡ªåŠ¨é…ç½®ç±»ï¼Œæˆ‘ä»¬çŸ¥é“SpringBootå¯åŠ¨æ—¶ä¼šè·å–æ‰€æœ‰spring.factoriesé…ç½®æ–‡ä»¶ä¸­çš„è‡ªåŠ¨é…ç½®ç±»å¹¶ä¸”è¿›è¡Œè§£æå…¶ä¸­çš„Beanï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æ¥çœ‹çœ‹MybatisAutoConfigurationè¿™ä¸ªè‡ªåŠ¨é…ç½®ç±»åšäº†å•¥ï¼Ÿ</p>
<h3>MybatisAutoConfiguration</h3>
<src class="cnblogs_code">
<pre><code><span style="color: #008080;"> 1</span> <span style="color: #000000;">@org.springframework.context.annotation.Configuration
</span><span style="color: #008080;"> 2</span> @ConditionalOnClass({ SqlSessionFactory.<span style="color: #0000ff;">class</span>, SqlSessionFactoryBean.<span style="color: #0000ff;">class</span><span style="color: #000000;"> })
</span><span style="color: #008080;"> 3</span> @ConditionalOnBean(DataSource.<span style="color: #0000ff;">class</span><span style="color: #000000;">)
</span><strong><span style="color: #008080;"> 4</span> <span style="color: #008000;">//</span><span style="color: #008000;">å¼•å…¥MybatisPropertiesé…ç½®ç±»</span>
<span style="color: #008080;"> 5</span> @EnableConfigurationProperties(MybatisProperties.<span style="color: #0000ff;">class</span><span style="color: #000000;">)
</span></strong><span style="color: #008080;"> 6</span> @AutoConfigureAfter(DataSourceAutoConfiguration.<span style="color: #0000ff;">class</span><span style="color: #000000;">)
</span><span style="color: #008080;"> 7</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> MybatisAutoConfiguration {
</span><span style="color: #008080;"> 8</span> 
<span style="color: #008080;"> 9</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">final</span><span style="color: #000000;"> MybatisProperties properties;
</span><span style="color: #008080;">10</span> 
<span style="color: #008080;">11</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">final</span><span style="color: #000000;"> Interceptor[] interceptors;
</span><span style="color: #008080;">12</span> 
<span style="color: #008080;">13</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">final</span><span style="color: #000000;"> ResourceLoader resourceLoader;
</span><span style="color: #008080;">14</span> 
<span style="color: #008080;">15</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">final</span><span style="color: #000000;"> DatabaseIdProvider databaseIdProvider;
</span><span style="color: #008080;">16</span> 
<span style="color: #008080;">17</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">final</span> List&lt;ConfigurationCustomizer&gt;<span style="color: #000000;"> configurationCustomizers;
</span><span style="color: #008080;">18</span> 
<span style="color: #008080;">19</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> MybatisAutoConfiguration(MybatisProperties properties,
</span><span style="color: #008080;">20</span>                                     ObjectProvider&lt;Interceptor[]&gt;<span style="color: #000000;"> interceptorsProvider,
</span><span style="color: #008080;">21</span> <span style="color: #000000;">                                    ResourceLoader resourceLoader,
</span><span style="color: #008080;">22</span>                                     ObjectProvider&lt;DatabaseIdProvider&gt;<span style="color: #000000;"> databaseIdProvider,
</span><span style="color: #008080;">23</span>                                     ObjectProvider&lt;List&lt;ConfigurationCustomizer&gt;&gt;<span style="color: #000000;"> configurationCustomizersProvider) {
</span><span style="color: #008080;">24</span>         <span style="color: #0000ff;">this</span>.properties =<span style="color: #000000;"> properties;
</span><span style="color: #008080;">25</span>         <span style="color: #0000ff;">this</span>.interceptors =<span style="color: #000000;"> interceptorsProvider.getIfAvailable();
</span><span style="color: #008080;">26</span>         <span style="color: #0000ff;">this</span>.resourceLoader =<span style="color: #000000;"> resourceLoader;
</span><span style="color: #008080;">27</span>         <span style="color: #0000ff;">this</span>.databaseIdProvider =<span style="color: #000000;"> databaseIdProvider.getIfAvailable();
</span><span style="color: #008080;">28</span>         <span style="color: #0000ff;">this</span>.configurationCustomizers =<span style="color: #000000;"> configurationCustomizersProvider.getIfAvailable();
</span><span style="color: #008080;">29</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">30</span> 
<span style="color: #008080;">31</span> <span style="color: #000000;">    @Bean
</span><span style="color: #008080;">32</span> <span style="color: #000000;">    @ConditionalOnMissingBean
</span><span style="color: #008080;">33</span>    <strong> <span style="color: #008000;">//</span><span style="color: #008000;">å¾€Springå®¹å™¨ä¸­æ³¨å…¥SqlSessionFactoryå¯¹è±¡
</span><span style="color: #008080;">34</span>     <span style="color: #008000;">//</span><span style="color: #008000;">å¹¶ä¸”è®¾ç½®æ•°æ®æºã€MapperLocations(Mapper.xmlè·¯å¾„)ç­‰</span></strong>
<span style="color: #008080;">35</span>     <span style="color: #0000ff;">public</span> SqlSessionFactory sqlSessionFactory(DataSource dataSource) <span style="color: #0000ff;">throws</span><span style="color: #000000;"> Exception {
</span><span style="color: #008080;">36</span>        <strong> SqlSessionFactoryBean factory = <span style="color: #0000ff;">new</span><span style="color: #000000;"> SqlSessionFactoryBean();
</span></strong><span style="color: #008080;">37</span> <strong><span style="color: #000000;">        factory.setDataSource(dataSource);
</span></strong><span style="color: #008080;">38</span>         factory.setVfs(SpringBootVFS.<span style="color: #0000ff;">class</span><span style="color: #000000;">);
</span><span style="color: #008080;">39</span>         <span style="color: #0000ff;">if</span> (StringUtils.hasText(<span style="color: #0000ff;">this</span><span style="color: #000000;">.properties.getConfigLocation())) {
</span><span style="color: #008080;">40</span>             factory.setConfigLocation(<span style="color: #0000ff;">this</span>.resourceLoader.getResource(<span style="color: #0000ff;">this</span><span style="color: #000000;">.properties.getConfigLocation()));
</span><span style="color: #008080;">41</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">42</span>         Configuration configuration = <span style="color: #0000ff;">this</span><span style="color: #000000;">.properties.getConfiguration();
</span><span style="color: #008080;">43</span>         <span style="color: #0000ff;">if</span> (configuration == <span style="color: #0000ff;">null</span> &amp;&amp; !StringUtils.hasText(<span style="color: #0000ff;">this</span><span style="color: #000000;">.properties.getConfigLocation())) {
</span><span style="color: #008080;">44</span>             configuration = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Configuration();
</span><span style="color: #008080;">45</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">46</span>         <span style="color: #0000ff;">if</span> (configuration != <span style="color: #0000ff;">null</span> &amp;&amp; !CollectionUtils.isEmpty(<span style="color: #0000ff;">this</span><span style="color: #000000;">.configurationCustomizers)) {
</span><span style="color: #008080;">47</span>             <span style="color: #0000ff;">for</span> (ConfigurationCustomizer customizer : <span style="color: #0000ff;">this</span><span style="color: #000000;">.configurationCustomizers) {
</span><span style="color: #008080;">48</span> <span style="color: #000000;">                customizer.customize(configuration);
</span><span style="color: #008080;">49</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">50</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">51</span> <span style="color: #000000;">        factory.setConfiguration(configuration);
</span><span style="color: #008080;">52</span>         <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">this</span>.properties.getConfigurationProperties() != <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
</span><span style="color: #008080;">53</span>             factory.setConfigurationProperties(<span style="color: #0000ff;">this</span><span style="color: #000000;">.properties.getConfigurationProperties());
</span><span style="color: #008080;">54</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">55</span>         <span style="color: #0000ff;">if</span> (!ObjectUtils.isEmpty(<span style="color: #0000ff;">this</span><span style="color: #000000;">.interceptors)) {
</span><span style="color: #008080;">56</span>             factory.setPlugins(<span style="color: #0000ff;">this</span><span style="color: #000000;">.interceptors);
</span><span style="color: #008080;">57</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">58</span>         <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">this</span>.databaseIdProvider != <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
</span><span style="color: #008080;">59</span>             factory.setDatabaseIdProvider(<span style="color: #0000ff;">this</span><span style="color: #000000;">.databaseIdProvider);
</span><span style="color: #008080;">60</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">61</span>         <span style="color: #0000ff;">if</span> (StringUtils.hasLength(<span style="color: #0000ff;">this</span><span style="color: #000000;">.properties.getTypeAliasesPackage())) {
</span><span style="color: #008080;">62</span>             factory.setTypeAliasesPackage(<span style="color: #0000ff;">this</span><span style="color: #000000;">.properties.getTypeAliasesPackage());
</span><span style="color: #008080;">63</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">64</span>         <span style="color: #0000ff;">if</span> (StringUtils.hasLength(<span style="color: #0000ff;">this</span><span style="color: #000000;">.properties.getTypeHandlersPackage())) {
</span><span style="color: #008080;">65</span>             factory.setTypeHandlersPackage(<span style="color: #0000ff;">this</span><span style="color: #000000;">.properties.getTypeHandlersPackage());
</span><span style="color: #008080;">66</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">67</span>         <span style="color: #0000ff;">if</span> (!ObjectUtils.isEmpty(<span style="color: #0000ff;">this</span><span style="color: #000000;">.properties.resolveMapperLocations())) {
</span><span style="color: #008080;">68</span>         <strong>    factory.setMapperLocations(<span style="color: #0000ff;">this</span><span style="color: #000000;">.properties.resolveMapperLocations());
</span></strong><span style="color: #008080;">69</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">70</span>       <strong>  <span style="color: #008000;">//</span><span style="color: #008000;">è·å–SqlSessionFactoryBeançš„getObject()ä¸­çš„å¯¹è±¡æ³¨å…¥Springå®¹å™¨ï¼Œä¹Ÿå°±æ˜¯SqlSessionFactoryå¯¹è±¡</span>
<span style="color: #008080;">71</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> factory.getObject();
</span></strong><span style="color: #008080;">72</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">73</span> 
<span style="color: #008080;">74</span> <span style="color: #000000;">    @Bean
</span><span style="color: #008080;">75</span> <span style="color: #000000;">    @ConditionalOnMissingBean
</span><span style="color: #008080;">76</span>     <span style="color: #008000;">//</span><span style="color: #008000;">å¾€Springå®¹å™¨ä¸­æ³¨å…¥SqlSessionTemplateå¯¹è±¡</span>
<span style="color: #008080;">77</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> SqlSessionTemplate sqlSessionTemplate(SqlSessionFactory sqlSessionFactory) {
</span><span style="color: #008080;">78</span>         ExecutorType executorType = <span style="color: #0000ff;">this</span><span style="color: #000000;">.properties.getExecutorType();
</span><span style="color: #008080;">79</span>         <span style="color: #0000ff;">if</span> (executorType != <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
</span><span style="color: #008080;">80</span>           <strong>  <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> SqlSessionTemplate(sqlSessionFactory, executorType);
</span></strong><span style="color: #008080;">81</span>         } <span style="color: #0000ff;">else</span><span style="color: #000000;"> {
</span><span style="color: #008080;">82</span>             <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> SqlSessionTemplate(sqlSessionFactory);
</span><span style="color: #008080;">83</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">84</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">85</span>     
<span style="color: #008080;">86</span>     <span style="color: #008000;">//</span><span style="color: #008000;">other code...</span>
<span style="color: #008080;">87</span> }</code></pre>

<p>åœ¨è‡ªåŠ¨é…ç½®çš„æ—¶å€™ä¼šå¯¼å…¥ä¸€ä¸ªPropertiesé…ç½®ç±»MybatisPropertiesï¼Œå’±ä»¬æ¥çœ‹ä¸€ä¸‹</p>
<src class="cnblogs_code">
<pre><code>@ConfigurationProperties(prefix =<span style="color: #000000;"> MybatisProperties.MYBATIS_PREFIX)
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> MybatisProperties {

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> String MYBATIS_PREFIX = "mybatis"<span style="color: #000000;">;

    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     * Location of MyBatis xml config file.
     </span><span style="color: #008000;">*/</span>
<strong>    <span style="color: #0000ff;">private</span><span style="color: #000000;"> String configLocation;

    </span></strong><span style="color: #008000;">/**</span><span style="color: #008000;">
     * Locations of MyBatis mapper files.
     </span><span style="color: #008000;">*/</span>
 <strong>   <span style="color: #0000ff;">private</span><span style="color: #000000;"> String[] mapperLocations;

    </span></strong><span style="color: #008000;">/**</span><span style="color: #008000;">
     * Packages to search type aliases. (Package delimiters are ",; \t\n")
     </span><span style="color: #008000;">*/</span>
   <strong> <span style="color: #0000ff;">private</span><span style="color: #000000;"> String typeAliasesPackage;

    </span></strong><span style="color: #008000;">/**</span><span style="color: #008000;">
     * Packages to search for type handlers. (Package delimiters are ",; \t\n")
     </span><span style="color: #008000;">*/</span>
    <span style="color: #0000ff;">private</span><span style="color: #000000;"> String typeHandlersPackage;

    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     * Indicates whether perform presence check of the MyBatis xml config file.
     </span><span style="color: #008000;">*/</span>
    <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">boolean</span> checkConfigLocation = <span style="color: #0000ff;">false</span><span style="color: #000000;">;

    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     * Execution mode for {</span><span style="color: #808080;">@link</span><span style="color: #008000;"> org.mybatis.spring.SqlSessionTemplate}.
     </span><span style="color: #008000;">*/</span>
    <span style="color: #0000ff;">private</span><span style="color: #000000;"> ExecutorType executorType;

    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     * Externalized properties for MyBatis configuration.
     </span><span style="color: #008000;">*/</span>
    <span style="color: #0000ff;">private</span><span style="color: #000000;"> Properties configurationProperties;

    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     * A Configuration object for customize default settings. If {</span><span style="color: #808080;">@link</span><span style="color: #008000;"> #configLocation}
     * is specified, this property is not used.
     </span><span style="color: #008000;">*/</span><span style="color: #000000;">
    @NestedConfigurationProperty
    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> Configuration configuration;

    </span><span style="color: #008000;">//</span><span style="color: #008000;">other code...</span>
}</code></pre>

<p>â€‹è¯¥Propertiesé…ç½®ç±»ä½œç”¨ä¸»è¦ç”¨äºä¸yml/propertiesä¸­ä»¥mybatiså¼€å¤´çš„å±æ€§è¿›è¡Œä¸€ä¸€å¯¹åº”ï¼Œå¦‚ä¸‹</p>
<src class="cnblogs_code">
<pre><code><strong><span style="color: #000000;">mybatis:
  config-location: classpath:mybatis/mybatis-config.xml
  mapper-locations: classpath:mybatis/mapper/*.xml
  type-aliases-package: org.com.cay.spring.boot.entity</span></strong></code></pre>

<src>â€‹åœ¨<strong>MybatisAutoConfiguration</strong>è‡ªåŠ¨é…ç½®ç±»ä¸­ï¼ŒSpringBooté»˜è®¤è‡ªåŠ¨é…ç½®äº†ä¸¤ä¸ªBeanï¼Œåˆ†åˆ«æ˜¯<strong>SqlSessionFactory</strong>å’Œ<strong>SqlSessionTemplate</strong>ã€‚æˆ‘ä»¬çœ‹åˆ°ä¸Šé¢ä»£ç ä¸­ç¬¬71è¡Œï¼Œå…¶å®æ˜¯è¿”å›çš„factory.getObject();ï¼Œä¹Ÿå°±æ˜¯æ³¨å…¥Springå®¹å™¨ä¸­çš„æ˜¯SqlSessionFactoryå¯¹è±¡ï¼ŒSqlSessionFactoryä¸»è¦æ˜¯å°†Propertiesé…ç½®ç±»ä¸­çš„å±æ€§èµ‹å€¼åˆ°SqlSessionFactoryBeanä¸­ï¼Œç±»ä¼¼ä»¥å‰xmlä¸­é…ç½®çš„SqlSessionFactory
<src class="cnblogs_code">
<pre><code><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">bean </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="sqlSessionFactory"</span><span style="color: #ff0000;"> class</span><span style="color: #0000ff;">="org.mybatis.spring.SqlSessionFactoryBean"</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">property </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">="dataSource"</span><span style="color: #ff0000;"> ref</span><span style="color: #0000ff;">="<strong>dataSource</strong>"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">property</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #008000;">&lt;!--</span><span style="color: #008000;"> è‡ªåŠ¨æ‰«æmapping.xmlæ–‡ä»¶ </span><span style="color: #008000;">--&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">property </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">="<strong>mapperLocations</strong>"</span><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">="classpath:com/cn/mapper/*.xml"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">property</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
        ...
</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">bean</span><span style="color: #0000ff;">&gt;</span></code></pre>

<p>å¦å¤–ä¸€ä¸ªBeanä¸ºSqlSessionTemplateï¼Œé€šè¿‡SqlSessionFactoryæ¥ç”ŸæˆSqlSessionä»£ç†ç±»ï¼š</p>
<src class="cnblogs_code">
<pre><code><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> SqlSessionTemplate <span style="color: #0000ff;">implements</span><span style="color: #000000;"> SqlSession, DisposableBean {

    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">final</span><span style="color: #000000;"> SqlSessionFactory sqlSessionFactory;

    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">final</span><span style="color: #000000;"> ExecutorType executorType;

    </span><strong><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">final</span><span style="color: #000000;"> SqlSession sqlSessionProxy;

    </span></strong><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">final</span><span style="color: #000000;"> PersistenceExceptionTranslator exceptionTranslator;

    </span><span style="color: #008000;">//</span><span style="color: #008000;">other code...</span>
    
    <span style="color: #0000ff;">public</span><span style="color: #000000;"> SqlSessionTemplate(SqlSessionFactory sqlSessionFactory, ExecutorType executorType,
          PersistenceExceptionTranslator exceptionTranslator) {

        notNull(sqlSessionFactory, </span>"Property 'sqlSessionFactory' is required"<span style="color: #000000;">);
        notNull(executorType, </span>"Property 'executorType' is required"<span style="color: #000000;">);

        </span><span style="color: #0000ff;">this</span>.sqlSessionFactory =<span style="color: #000000;"> sqlSessionFactory;
        </span><span style="color: #0000ff;">this</span>.executorType =<span style="color: #000000;"> executorType;
        </span><span style="color: #0000ff;">this</span>.exceptionTranslator =<span style="color: #000000;"> exceptionTranslator;
        
        </span><strong><span style="color: #008000;">//</span><span style="color: #008000;">ç”ŸæˆSqlSessioinä»£ç†ç±»</span>
        <span style="color: #0000ff;">this</span>.sqlSessionProxy =<span style="color: #000000;"> (SqlSession) newProxyInstance(
            SqlSessionFactory.</span><span style="color: #0000ff;">class</span><span style="color: #000000;">.getClassLoader(),
            </span><span style="color: #0000ff;">new</span> Class[] { SqlSession.<span style="color: #0000ff;">class</span><span style="color: #000000;"> },
            </span><span style="color: #0000ff;">new</span></strong><span style="color: #000000;"><strong> SqlSessionInterceptor());</strong>
    }
}</span></code></pre>

<p>è€Œ@MapperScanæ³¨è§£æ˜¯å’ŒSpringæ•´åˆMybatisçš„ä½¿ç”¨æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯åœ¨é…ç½®ç±»ä¸ŠæŒ‡å®šMapperæ¥å£çš„è·¯å¾„ï¼Œå¤§å®¶å¯ä»¥çœ‹ä¸€ä¸‹æˆ‘ä»¥å‰çš„ä¸€ç¯‡æ–‡ç« <a class="entry" href="https://www.cnblogs.com/java-chen-hao/p/11839958.html" target="_blank">Mybaits æºç è§£æ ï¼ˆåä¸€ï¼‰----- @MapperScanå°†Mapperæ¥å£ç”Ÿæˆä»£ç†æ³¨å…¥åˆ°Spring-é™æ€ä»£ç†å’ŒåŠ¨æ€ä»£ç†ç»“åˆä½¿ç”¨</a></p>
<h2 id="h-24">æ—¥å¸¸æ±‚èµ</h2>
<p>å¥½äº†å„ä½ï¼Œä»¥ä¸Šå°±æ˜¯è¿™ç¯‡æ–‡ç« çš„å…¨éƒ¨å†…å®¹äº†ï¼Œèƒ½çœ‹åˆ°è¿™é‡Œçš„äººå‘€ï¼Œéƒ½æ˜¯äººæ‰ã€‚</p>
<p>å¦‚æœè¿™ä¸ªæ–‡ç« å†™å¾—è¿˜ä¸é”™ï¼Œè§‰å¾—å­¦åˆ°äº†ä¸€ç‚¹ä¸œè¥¿çš„è¯&nbsp;æ±‚ç‚¹èµğŸ‘&nbsp;å¯¹æˆ‘æ¥è¯´çœŸçš„&nbsp;éå¸¸æœ‰ç”¨ï¼ï¼ï¼</p>
<p>åˆ›ä½œä¸æ˜“ï¼Œå„ä½çš„æ”¯æŒå’Œè®¤å¯ï¼Œå°±æ˜¯æˆ‘åˆ›ä½œçš„æœ€å¤§åŠ¨åŠ›ï¼Œæˆ‘ä»¬ä¸‹ç¯‡æ–‡ç« è§ï¼</p>
<p>&nbsp;</p>

</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>