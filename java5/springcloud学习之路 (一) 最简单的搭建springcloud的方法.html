<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修springcloud学习之路 (一) 最简单的搭建springcloud的方法' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>springcloud学习之路 (一) 最简单的搭建springcloud的方法</center></div><div class='banquan'>原文出处:本文由博客园博主宅男大咖提供。<br/>
原文连接:https://www.cnblogs.com/zhainan-blog/p/11634621.html</div><br>
    <h2><span style="font-family: 'Microsoft YaHei';">参考资料:&nbsp;</span><a href="https://www.jianshu.com/p/a0365a635975" target="_blank">[JavaEE] 五分钟搭建SpringCloud环境, 进入微服务时代</a></h2>
<p><span style="font-family: 'Microsoft YaHei';">感谢上篇博文大佬带领走进springcloud世界, 本博文主要目的为记录自己学习springcloud的点点滴滴, 给自己的知识进行整理, 如果能帮助更多的小伙帮那就更好了.</span></p>
<p><span style="color: #ff0000;"><strong><span style="font-family: 'Microsoft YaHei';">ps: 本文主要作为备忘及快速搭建springcloud之用, 只记录主要步骤. 原文讲述更加细致, 想深入学习的同学推荐点击上方连接学习.</span></strong></span></p>
<p>操作系统: Windows 10</p>
<p>IDE: IntelliJ IDEA 2018.3.6</p>
<p>JAVA: JDK 1.8.X</p>
<p>Meave: 3.6.0</p>
<p>SpringBoot: 2.1.7</p>
<h3>1. 创建一个工程</h3>
<p><img src="./images/springcloud学习之路 (一) 最简单的搭建springcloud的方法0.png" alt="" /></p>
<p>创建springboot工程</p>
<p><img src="./images/springcloud学习之路 (一) 最简单的搭建springcloud的方法1.png" alt="" width="739" height="674" /></p>
<p><img src="./images/springcloud学习之路 (一) 最简单的搭建springcloud的方法2.png" alt="" width="733" height="668" /></p>
<p><img src="./images/springcloud学习之路 (一) 最简单的搭建springcloud的方法3.png" alt="" width="730" height="666" /></p>
<h3>&nbsp;2. 创建Eureka注册中心</h3>
<p><img src="./images/springcloud学习之路 (一) 最简单的搭建springcloud的方法4.png" alt="" /></p>
<p>&nbsp;依然选择springboot工程</p>
<p><img src="./images/springcloud学习之路 (一) 最简单的搭建springcloud的方法5.png" alt="" width="848" height="770" /></p>
<p><img src="./images/springcloud学习之路 (一) 最简单的搭建springcloud的方法6.png" alt="" width="847" height="770" /></p>
<p>&nbsp;选择eureka服务器</p>
<p><img src="./images/springcloud学习之路 (一) 最简单的搭建springcloud的方法7.png" alt="" width="847" height="770" /></p>
<p><img src="./images/springcloud学习之路 (一) 最简单的搭建springcloud的方法8.png" alt="" width="847" height="919" /></p>
<p>&nbsp;导包, 开启服务管理器</p>
<p>&nbsp;为eureka注册中心添加注解开启服务</p>
<p><img src="./images/springcloud学习之路 (一) 最简单的搭建springcloud的方法9.png" alt="" width="847" height="424" /></p>
<p>&nbsp;配置eureka注册中心配置文件</p>
<p><img src="./images/springcloud学习之路 (一) 最简单的搭建springcloud的方法10.png" alt="" width="849" height="456" /></p>
<src class="cnblogs_code">
<pre><code><span style="color: #000000;">server:
  # 配置服务端口
  port: </span>8081<span style="color: #000000;">
eureka:
  client:
    service</span>-<span style="color: #000000;">url:
      # 配置eureka服务器地址
      defaultZone: http:</span><span style="color: #008000;">//</span><span style="color: #008000;">127.0.0.1:8081/eureka</span>
<span style="color: #000000;">    #是否需要将自己注册到注册中心(注册中心集群需要设置为true)
    register</span>-with-eureka: <span style="color: #0000ff;">false</span><span style="color: #000000;">
    #是否需要搜索服务信息 因为自己是注册中心所以为false
    fetch</span>-registry: <span style="color: #0000ff;">false</span></code></pre>

<p><span style="color: #ff0000;"><strong>注意缩进, 因为<code>yml</code>使用缩进来区分不同字段的.</strong></span></p>
<p><span style="color: #ff0000;"><span style="color: #000000;">运行ServiceEurekaApplication文件启动项目, 访问注册中心</span><strong><br /></strong></span></p>
<p><span style="color: #ff0000;"><span style="color: #000000;"><a href="http://localhost:8081/" rel="nofollow" target="_blank">http://localhost:8081</a></span></span></p>
<p><span style="color: #ff0000;"><span style="color: #000000;"><img src="./images/springcloud学习之路 (一) 最简单的搭建springcloud的方法11.png" alt="" /></span></span></p>
<h3>&nbsp;3. 创建两个微服务service-a,service-b</h3>
<p><img src="./images/springcloud学习之路 (一) 最简单的搭建springcloud的方法12.png" alt="" /></p>
<p>创建一个springboot模块</p>
<p><img src="./images/springcloud学习之路 (一) 最简单的搭建springcloud的方法13.png" alt="" /></p>
<p>&nbsp;起个名字</p>
<p><img src="./images/springcloud学习之路 (一) 最简单的搭建springcloud的方法14.png" alt="" /></p>
<p>&nbsp;<img src="./images/springcloud学习之路 (一) 最简单的搭建springcloud的方法15.png" alt="" /></p>
<p>&nbsp;选择web</p>
<p>&nbsp;选择客户模块</p>
<p><img src="./images/springcloud学习之路 (一) 最简单的搭建springcloud的方法16.png" alt="" /></p>
<p>&nbsp;路由设置</p>
<p><img src="./images/springcloud学习之路 (一) 最简单的搭建springcloud的方法17.png" alt="" /></p>
<p>&nbsp;配置微服务的入口文件&nbsp;@EnableEurekaClient</p>
<p><img src="./images/springcloud学习之路 (一) 最简单的搭建springcloud的方法18.png" alt="" /></p>
<p>&nbsp;配置application.yml</p>
<p>service-a</p>
<src class="cnblogs_code">
<pre><code><span style="color: #000000;">server:
  # 服务端口号
  port: </span>8082<span style="color: #000000;">
spring:
  application:
    # 服务名称 </span>-<span style="color: #000000;"> 服务之间使用名称进行通讯
    name: service</span>-objcat-<span style="color: #000000;">a
eureka:
  client:
    service</span>-<span style="color: #000000;">url:
      # 填写注册中心服务器地址
      defaultZone: http:</span><span style="color: #008000;">//</span><span style="color: #008000;">localhost:8081/eureka</span>
<span style="color: #000000;">    # 是否需要将自己注册到注册中心
    register</span>-with-eureka: <span style="color: #0000ff;">true</span><span style="color: #000000;">
    # 是否需要搜索服务信息
    fetch</span>-registry: <span style="color: #0000ff;">true</span><span style="color: #000000;">
  instance:
    # 使用ip地址注册到注册中心
    prefer</span>-ip-address: <span style="color: #0000ff;">true</span><span style="color: #000000;">
    # 注册中心列表中显示的状态参数
    instance</span>-id: ${spring.cloud.client.ip-address}:${server.port}</code></pre>

<p>service-b</p>
<src class="cnblogs_code">
<pre><code><span style="color: #000000;">server:
  # 服务端口号
  port: </span>8083<span style="color: #000000;">
spring:
  application:
    # 服务名称 </span>-<span style="color: #000000;"> 服务之间使用名称进行通讯
    name: service</span>-objcat-<span style="color: #000000;">b
eureka:
  client:
    service</span>-<span style="color: #000000;">url:
      # 填写注册中心服务器地址
      defaultZone: http:</span><span style="color: #008000;">//</span><span style="color: #008000;">localhost:8081/eureka</span>
<span style="color: #000000;">    # 是否需要将自己注册到注册中心
    register</span>-with-eureka: <span style="color: #0000ff;">true</span><span style="color: #000000;">
    # 是否需要搜索服务信息
    fetch</span>-registry: <span style="color: #0000ff;">true</span><span style="color: #000000;">
  instance:
    # 使用ip地址注册到注册中心
    prefer</span>-ip-address: <span style="color: #0000ff;">true</span><span style="color: #000000;">
    # 注册中心列表中显示的状态参数
    instance</span>-id: ${spring.cloud.client.ip-address}:${server.port}</code></pre>

<p>运行微服务</p>
<p><img src="./images/springcloud学习之路 (一) 最简单的搭建springcloud的方法19.png" alt="" /></p>
<p>&nbsp;分别运行注册中心及微服务模块</p>
<p><img src="./images/springcloud学习之路 (一) 最简单的搭建springcloud的方法20.png" alt="" /></p>
<p>&nbsp;出现端口号表示启动成功</p>
<p><img src="./images/springcloud学习之路 (一) 最简单的搭建springcloud的方法21.png" alt="" /></p>
<p>&nbsp;编写测试接口</p>
<p><img src="./images/springcloud学习之路 (一) 最简单的搭建springcloud的方法22.png" alt="" /></p>
<src class="cnblogs_code">
<pre><code><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.web.bind.annotation.RequestMapping;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.web.bind.annotation.RestController;

@RestController
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> TestAController {

    @RequestMapping(</span>"testA"<span style="color: #000000;">)
    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> String TestAController(){
        </span><span style="color: #0000ff;">return</span> "Hello,SpringCloud for TestA"<span style="color: #000000;">;
    }
}</span></code></pre>

<p>重启服务</p>
<p><img src="./images/springcloud学习之路 (一) 最简单的搭建springcloud的方法23.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;访问下面地址</p>
<p><a href="http://localhost:8082/testA" target="_blank">http://localhost:8082/testA</a></p>
<p>访问成功</p>
<p><img src="./images/springcloud学习之路 (一) 最简单的搭建springcloud的方法24.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="font-family: 'Microsoft YaHei';">使用服务b调用服务a的接口</span><br /><span style="font-family: 'Microsoft YaHei';">这时我们就需要用到<code>eurka(注册中心)</code>和<code>feign</code>客户端了</span><br /><span style="font-family: 'Microsoft YaHei';">首先我们在service-b中创建<code>interface</code></span></p>
<p><span style="font-family: 'Microsoft YaHei';">在微服务b中, 创建一个ServiceAFeignClient接口</span></p>
<p><span style="font-family: 'Microsoft YaHei';"><img src="./images/springcloud学习之路 (一) 最简单的搭建springcloud的方法25.png" alt="" /></span></p>
<src class="cnblogs_code">
<pre><code><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.cloud.openfeign.FeignClient;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.web.bind.annotation.RequestMapping;

</span><span style="color: #008000;">//</span><span style="color: #008000;"> 填入注册中心中的应用名, 也就是要调用的微服务的应用名
</span><span style="color: #008000;">//</span><span style="color: #008000;"> 在eureka页面中可以找到</span>
@FeignClient("SERVICE-OBJCAT-A"<span style="color: #000000;">)
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> ServiceAFeignClient {
    @RequestMapping(</span>"testA"<span style="color: #000000;">)
    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> String TestAController();
}</span></code></pre>

<p>应用名可以在eureka中找到<br /><a href="http://localhost:8081/" rel="nofollow" target="_blank">http://localhost:8081</a></p>
<p><img src="./images/springcloud学习之路 (一) 最简单的搭建springcloud的方法26.png" alt="" /></p>
<p>在服务b中添加个控制器</p>
<p><img src="./images/springcloud学习之路 (一) 最简单的搭建springcloud的方法27.png" alt="" /></p>
<src class="cnblogs_code">
<pre><code><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.beans.factory.annotation.Autowired;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.cloud.netflix.eureka.EnableEurekaClient;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.cloud.openfeign.EnableFeignClients;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.web.bind.annotation.RequestMapping;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.web.bind.annotation.RestController;

@RestController
</span><span style="color: #008000;">//</span><span style="color: #008000;"> 添加注解声明是注册中心客户端</span>
<span style="color: #000000;">@EnableEurekaClient
</span><span style="color: #008000;">//</span><span style="color: #008000;"> 实现不同子服务调用</span>
<span style="color: #000000;">@EnableFeignClients
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> TestBController {

    @Autowired
    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> ServiceAFeignClient serviceAFeignClient;

    @RequestMapping(</span>"call"<span style="color: #000000;">)
    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> String call(){
        String result </span>=<span style="color: #000000;"> serviceAFeignClient.TestAController();
        </span><span style="color: #0000ff;">return</span> "b to a 访问结果 ---" +<span style="color: #000000;"> result;
    }
}</span></code></pre>

<p>解决@Autowired实例报错</p>
<p><img src="./images/springcloud学习之路 (一) 最简单的搭建springcloud的方法28.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><img src="./images/springcloud学习之路 (一) 最简单的搭建springcloud的方法29.png" alt="" /></p>
<p><span style="font-family: 'Microsoft YaHei';">重新运行服务b 在网站上访问试试吧</span></p>
<p><span style="font-family: 'Microsoft YaHei';"><a href="http://localhost:8083/call" rel="nofollow" target="_blank">http://localhost:8083/call</a></span></p>
<p><span style="font-family: 'Microsoft YaHei';">PS: 在springcloud中一个子服务调用另一个子服务默认超时时间是1s, 也就是说要是被调用的子服务返回超过一秒就会出现错误, 针对此问题需要修改调用服务的yml文件.&nbsp;</span></p>
<p><span style="font-family: 'Microsoft YaHei';">举例: 在本案例中, service-a是被调用者, service-b是调用者, 则在service-b的yml文件中加入</span></p>
<p>&nbsp;</p>
<src class="cnblogs_code">
<pre><code><span style="color: #000000;">ribbon:
  #建立连接超时时间
  ReadTimeout: </span>5000<span style="color: #000000;">
  #读取资源超时间
  ConnectTimeout: </span>5000</code></pre>

<p>&nbsp;</p>
<p>注意首行缩进, service-b完整配置如下</p>
<src class="cnblogs_code">
<pre><code><span style="color: #000000;">server:
  # 服务端口号
  port: </span>8083<span style="color: #000000;">
spring:
  application:
    # 服务名称 </span>-<span style="color: #000000;"> 服务之间使用名称进行通讯
    name: service</span>-objcat-<span style="color: #000000;">b
eureka:
  client:
    service</span>-<span style="color: #000000;">url:
      # 填写注册中心服务器地址
      defaultZone: http:</span><span style="color: #008000;">//</span><span style="color: #008000;">localhost:8081/eureka</span>
<span style="color: #000000;">    # 是否需要将自己注册到注册中心
    register</span>-with-eureka: <span style="color: #0000ff;">true</span><span style="color: #000000;">
    # 是否需要搜索服务信息
    fetch</span>-registry: <span style="color: #0000ff;">true</span><span style="color: #000000;">
  instance:
    # 使用ip地址注册到注册中心
    prefer</span>-ip-address: <span style="color: #0000ff;">true</span><span style="color: #000000;">
    # 注册中心列表中显示的状态参数
    instance</span>-id: ${spring.cloud.client.ip-<span style="color: #000000;">address}:${server.port}
ribbon:
  #建立连接超时时间
  ReadTimeout: </span>5000<span style="color: #000000;">
  #读取资源超时间
  ConnectTimeout: </span>5000</code></pre>

<p>&nbsp;<a href="https://github.com/qiuxinquan1014/springcloud.git" target="_blank">文中案例下载</a></p>

</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>