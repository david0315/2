<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修Java微服务（二）：服务消费者与提供者搭建' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>Java微服务（二）：服务消费者与提供者搭建</center></div><div class='banquan'>原文出处:本文由博客园博主从入门到到放弃提供。<br/>
原文连接:https://www.cnblogs.com/dz-boss/p/11485020.html</div><br>
    <p>　　本文接着上一篇写的《<a id="cb_post_title_url" class="postTitle2" href="https://www.cnblogs.com/dz-boss/p/11479717.html">Java微服务（一）：dubbo-admin控制台的使用</a>》，上篇文章介绍了docker，zookeeper环境的安装，并参考dubbo官网演示了dubbo-admin控制台的使用。上篇文章已经搭建好zookeeper服务注册中心，本片文章主要搭建服务消费者和服务提供者。按照微服务的原则，本文将demo分为3部分：服务接口、服务消费者、服务消费者。</p>
<p>　　服务接口：定义了系统所需要的全部接口。</p>
<p>　　服务提供者：主要是对接口的实现。</p>
<p>　　服务消费者：对接口的使用</p>
<p><strong><span style="font-size: 18pt;">1.Dubbo介绍</span></strong></p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="./images/Java微服务（二）：服务消费者与提供者搭建0.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<table style="height: 177px; width: 578px;">
<thead>
<tr><th>节点</th><th>角色说明</th></tr>
</thead>
<tbody>
<tr>
<td><code>Provider</code></td>
<td>暴露服务的服务提供方</td>
</tr>
<tr>
<td><code>Consumer</code></td>
<td>调用远程服务的服务消费方</td>
</tr>
<tr>
<td><code>Registry</code></td>
<td>服务注册与发现的注册中心</td>
</tr>
<tr>
<td><code>Monitor</code></td>
<td>统计服务的调用次数和调用时间的监控中心</td>
</tr>
<tr>
<td><code>Container</code></td>
<td>服务运行容器</td>
</tr>
</tbody>
</table>
<h5>&nbsp;</h5>
<p>　　Dubbo 架构具有以下几个特点，分别是连通性、健壮性、伸缩性、以及向未来架构的升级性。</p>
<h5>调用关系说明</h5>
<ol start="0">
<li>服务容器负责启动，加载，运行服务提供者。</li>
<li>服务提供者在启动时，向注册中心注册自己提供的服务。</li>
<li>服务消费者在启动时，向注册中心订阅自己所需的服务。</li>
<li>注册中心返回服务提供者地址列表给消费者，如果有变更，注册中心将基于长连接推送变更数据给消费者。</li>
<li>服务消费者，从提供者地址列表中，基于软负载均衡算法，选一台提供者进行调用，如果调用失败，再选另一台调用。</li>
<li>服务消费者和提供者，在内存中累计调用次数和调用时间，定时每分钟发送一次统计数据到监控中心。</li>
</ol>
<p>Dubbo 架构具有以下几个特点，分别是连通性、健壮性、伸缩性、以及向未来架构的升级性。</p>
<p>更详细的介绍，请参考官网：<a href="http://dubbo.apache.org/en-us/">http://dubbo.apache.org/en-us/</a></p>
<p><span style="font-size: 18pt;"><strong>2.服务接口</strong></span></p>
<p>　　通过idea创建一个jar工程，创建工程的过程可以参考《<a id="cb_post_title_url" class="postTitle2" href="https://www.cnblogs.com/dz-boss/p/10118821.html">Spring boot 入门（一）：快速搭建Spring boot项目</a>》，<strong><span style="color: #ff0000;">此工程的目的只是简单的定义接口，所以</span><span style="color: #ff0000;">这里直接创建jar包，不是maven工程</span></strong>。创建好了后，新建一个接口。以下是我创建的接口：</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="./images/Java微服务（二）：服务消费者与提供者搭建1.png" alt="" /></p>
<p>&nbsp;</p>
<p>　　其中UserService代码如下：</p>
<src class="cnblogs_code">
<pre><code><span style="color: #008080;">1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> com.edu.hello.dubbo.service.user.api;
</span><span style="color: #008080;">2</span> 
<span style="color: #008080;">3</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> UserService {
</span><span style="color: #008080;">4</span> <span style="color: #000000;">    String sayHi();
</span><span style="color: #008080;">5</span> }</code></pre>

<p><span style="color: #ff0000;"><strong>　　创建完接口后，需要把接口install到本地仓库，供服务消费者和服务提供者使用</strong></span></p>
<p><span style="color: #000000;">　　在Terminal直接指向mvn clean install或者直接在lifecycle目录下点击install进行安装，出现如下页面，表示安装成功</span></p>
<p><span style="color: #000000;"><strong><img style="display: block; margin-left: auto; margin-right: auto;" src="./images/Java微服务（二）：服务消费者与提供者搭建2.png" alt="" /></strong></span></p>
<p>&nbsp;</p>
<p><span style="color: #000000;"><strong></strong></span></p>
<p>&nbsp;</p>
<p><strong><span style="font-size: 18pt;">3.服务提供者</span></strong></p>
<p>　　服务提供者主要是对接口的实现，用相同的方法创建一个maven工程，创建好后的maven工程目录如下：</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="./images/Java微服务（二）：服务消费者与提供者搭建3.png" alt="" /></p>
<p>&nbsp;</p>
<p>其中UserServicelmpl是多接口的实现，代码如下：</p>
<src class="cnblogs_code">
<pre><code><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> com.edu.hello.dubbo.service.user.provider.api.impl;
</span><span style="color: #008080;"> 2</span> 
<span style="color: #008080;"> 3</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> com.alibaba.dubbo.config.annotation.Service;
</span><span style="color: #008080;"> 4</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> com.edu.hello.dubbo.service.user.api.UserService;
</span><span style="color: #008080;"> 5</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> com.netflix.hystrix.contrib.javanica.annotation.HystrixCommand;
</span><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> com.netflix.hystrix.contrib.javanica.annotation.HystrixProperty;
</span><span style="color: #008080;"> 7</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.beans.factory.annotation.Value;
</span><span style="color: #008080;"> 8</span> 
<span style="color: #008080;"> 9</span> <span style="color: #008000;">/**</span>
<span style="color: #008080;">10</span> <span style="color: #008000;"> * @ClassName UserServiceImpl
</span><span style="color: #008080;">11</span> <span style="color: #008000;"> * @Deccription TODO
</span><span style="color: #008080;">12</span> <span style="color: #008000;"> * @Author DZ
</span><span style="color: #008080;">13</span> <span style="color: #008000;"> * @Date 2019/8/31 11:20
</span><span style="color: #008080;">14</span> <span style="color: #008000;"> *</span><span style="color: #008000;">*/</span>
<span style="color: #008080;">15</span> @Service(version = "${user.service.version}"<span style="color: #000000;">)
</span><span style="color: #008080;">16</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> UserServiceImpl <span style="color: #0000ff;">implements</span><span style="color: #000000;"> UserService {
</span><span style="color: #008080;">17</span> 
<span style="color: #008080;">18</span>     @Value("${dubbo.protocol.port}"<span style="color: #000000;">)
</span><span style="color: #008080;">19</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> String port;
</span><span style="color: #008080;">20</span> 
<span style="color: #008080;">21</span>     <span style="color: #008000;">/*</span><span style="color: #008000;">@HystrixCommand(commandProperties = {
</span><span style="color: #008080;">22</span> <span style="color: #008000;">            @HystrixProperty(name = "circuitBreaker.requestVolumeThreshold", value = "10"),
</span><span style="color: #008080;">23</span> <span style="color: #008000;">            @HystrixProperty(name = "execution.isolation.thread.timeoutInMilliseconds", value = "2000")
</span><span style="color: #008080;">24</span> <span style="color: #008000;">    })</span><span style="color: #008000;">*/</span>
<span style="color: #008080;">25</span> <span style="color: #000000;">    @Override
</span><span style="color: #008080;">26</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> String sayHi() {
</span><span style="color: #008080;">27</span>         <span style="color: #0000ff;">return</span> "Say Hello, i am from " +<span style="color: #000000;"> port;
</span><span style="color: #008080;">28</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">29</span> }</code></pre>

<p>其中@HystrixCommand注解在后面熔断器中会讲到，这里先注释。</p>
<p>yml配置如下：</p>
<src class="cnblogs_code" onclick="cnblogs_code_show('e9956f63-3b3c-40e5-92d4-8999f7587f0a')"><img id="code_img_closed_e9956f63-3b3c-40e5-92d4-8999f7587f0a" class="code_img_closed" src="./images/Java微服务（二）：服务消费者与提供者搭建4.png" alt="" /><img id="code_img_opened_e9956f63-3b3c-40e5-92d4-8999f7587f0a" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('e9956f63-3b3c-40e5-92d4-8999f7587f0a',event)" src="./images/Java微服务（二）：服务消费者与提供者搭建5.png" alt="" />
<src id="cnblogs_code_open_e9956f63-3b3c-40e5-92d4-8999f7587f0a" class="cnblogs_code_hide">
<pre><code><span style="color: #008080;"> 1</span> <span style="color: #000000;">spring:
</span><span style="color: #008080;"> 2</span> <span style="color: #000000;">  application:
</span><span style="color: #008080;"> 3</span> <span style="color: #000000;">    name: hello-dubbo-service-user-provider
</span><span style="color: #008080;"> 4</span> 
<span style="color: #008080;"> 5</span> <span style="color: #000000;">user:
</span><span style="color: #008080;"> 6</span> <span style="color: #000000;">  service:
</span><span style="color: #008080;"> 7</span> <span style="color: #000000;">    version: 1.0.0
</span><span style="color: #008080;"> 8</span> 
<span style="color: #008080;"> 9</span> <span style="color: #000000;">dubbo:
</span><span style="color: #008080;">10</span> <span style="color: #000000;">  scan:
</span><span style="color: #008080;">11</span> <span style="color: #000000;">    basePackages: com.edu.hello.dubbo.service.user.provider.api
</span><span style="color: #008080;">12</span> <span style="color: #000000;">  application:
</span><span style="color: #008080;">13</span> <span style="color: #000000;">    id: hello-dubbo-service-user-provider
</span><span style="color: #008080;">14</span> <span style="color: #000000;">    name: hello-dubbo-service-user-provider
</span><span style="color: #008080;">15</span> <span style="color: #000000;">    qos-port: 22222
</span><span style="color: #008080;">16</span> <span style="color: #000000;">    qos-enable: true
</span><span style="color: #008080;">17</span> <span style="color: #000000;">  protocol:
</span><span style="color: #008080;">18</span> <span style="color: #000000;">    id: dubbo
</span><span style="color: #008080;">19</span> <span style="color: #000000;">    name: dubbo
</span><span style="color: #008080;">20</span> <span style="color: #000000;">    port: 12346
</span><span style="color: #008080;">21</span> <span style="color: #000000;">    status: server
</span><span style="color: #008080;">22</span> <span style="color: #000000;">    serialization: kryo #高速序列化
</span><span style="color: #008080;">23</span> <span style="color: #000000;">    # optimizer:
</span><span style="color: #008080;">24</span> 
<span style="color: #008080;">25</span> <span style="color: #000000;">  registry:
</span><span style="color: #008080;">26</span> <span style="color: #000000;">    id: zookeeper
</span><span style="color: #008080;">27</span> <span style="color: #000000;">    address: zookeeper://192.168.1.12:2181?back=192.168.1.12:2182,192.168.1.12:2183
</span><span style="color: #008080;">28</span> <span style="color: #000000;">  provider:
</span><span style="color: #008080;">29</span> <span style="color: #000000;">    loadbalance: roundrobin #负载均衡
</span><span style="color: #008080;">30</span> 
<span style="color: #008080;">31</span> 
<span style="color: #008080;">32</span> 
<span style="color: #008080;">33</span> <span style="color: #000000;">management:
</span><span style="color: #008080;">34</span> <span style="color: #000000;">  endpoint:
</span><span style="color: #008080;">35</span> <span style="color: #000000;">    dubbo:
</span><span style="color: #008080;">36</span> <span style="color: #000000;">      enable: true
</span><span style="color: #008080;">37</span> <span style="color: #000000;">    dubbo-shutdown:
</span><span style="color: #008080;">38</span> <span style="color: #000000;">      enabled: true
</span><span style="color: #008080;">39</span> <span style="color: #000000;">    dubbo-configs:
</span><span style="color: #008080;">40</span> <span style="color: #000000;">      enabled: true
</span><span style="color: #008080;">41</span> <span style="color: #000000;">    dubbo-services:
</span><span style="color: #008080;">42</span> <span style="color: #000000;">      enabled: true
</span><span style="color: #008080;">43</span> <span style="color: #000000;">    dubbo-references:
</span><span style="color: #008080;">44</span> <span style="color: #000000;">      enabled: true
</span><span style="color: #008080;">45</span> <span style="color: #000000;">    dubbo-peoperties:
</span><span style="color: #008080;">46</span> <span style="color: #000000;">      enabled: true
</span><span style="color: #008080;">47</span> <span style="color: #000000;">  health:
</span><span style="color: #008080;">48</span> <span style="color: #000000;">    dubbo:
</span><span style="color: #008080;">49</span> <span style="color: #000000;">      status:
</span><span style="color: #008080;">50</span> <span style="color: #000000;">        defaults: memory
</span><span style="color: #008080;">51</span>         extras: load,threadpool</code></pre>

<span class="cnblogs_code_collapse">View Code</span>
<p>pom文件如下：</p>
<src class="cnblogs_code" onclick="cnblogs_code_show('210940a6-c9e2-4311-b34e-8cb902683222')"><img id="code_img_closed_210940a6-c9e2-4311-b34e-8cb902683222" class="code_img_closed" src="./images/Java微服务（二）：服务消费者与提供者搭建4.png" alt="" /><img id="code_img_opened_210940a6-c9e2-4311-b34e-8cb902683222" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('210940a6-c9e2-4311-b34e-8cb902683222',event)" src="./images/Java微服务（二）：服务消费者与提供者搭建5.png" alt="" />
<src id="cnblogs_code_open_210940a6-c9e2-4311-b34e-8cb902683222" class="cnblogs_code_hide">
<pre><code><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="UTF-8"</span><span style="color: #0000ff;">?&gt;</span>
<span style="color: #008080;"> 2</span> <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">project </span><span style="color: #ff0000;">xmlns</span><span style="color: #0000ff;">="http://maven.apache.org/POM/4.0.0"</span><span style="color: #ff0000;"> xmlns:xsi</span><span style="color: #0000ff;">="http://www.w3.org/2001/XMLSchema-instance"</span>
<span style="color: #008080;"> 3</span> <span style="color: #ff0000;">         xsi:schemaLocation</span><span style="color: #0000ff;">="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd"</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 4</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">modelVersion</span><span style="color: #0000ff;">&gt;</span>4.0.0<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">modelVersion</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 5</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">parent</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 6</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>org.springframework.boot<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 7</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>spring-boot-starter-parent<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 8</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">version</span><span style="color: #0000ff;">&gt;</span>2.1.7.RELEASE<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">version</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 9</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">relativePath</span><span style="color: #0000ff;">/&gt;</span> <span style="color: #008000;">&lt;!--</span><span style="color: #008000;"> lookup parent from repository </span><span style="color: #008000;">--&gt;</span>
<span style="color: #008080;">10</span>     <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">parent</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">11</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>com.edu<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">12</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>hello-dubbo-service-user-provider<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">13</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">version</span><span style="color: #0000ff;">&gt;</span>1.0.0-SNAPSHOT<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">version</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">14</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">name</span><span style="color: #0000ff;">&gt;</span>hello-dubbo-service-user-provider<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">name</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">15</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">description</span><span style="color: #0000ff;">&gt;</span>Demo project for Spring Boot<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">description</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">16</span> 
<span style="color: #008080;">17</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">properties</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">18</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">java.version</span><span style="color: #0000ff;">&gt;</span>1.8<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">java.version</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">19</span>     <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">properties</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">20</span> 
<span style="color: #008080;">21</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">dependencies</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">22</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">dependency</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">23</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>org.springframework.boot<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">24</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>spring-boot-starter<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">25</span>         <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">dependency</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">26</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">dependency</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">27</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>org.springframework.boot<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">28</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>spring-boot-starter-actuator<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">29</span>         <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">dependency</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">30</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">dependency</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">31</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>org.springframework.boot<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">32</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>spring-boot-starter-test<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">33</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">scope</span><span style="color: #0000ff;">&gt;</span>test<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">scope</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">34</span>         <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">dependency</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">35</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">dependency</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">36</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>com.alibaba.boot<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">37</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>dubbo-spring-boot-starter<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">38</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">version</span><span style="color: #0000ff;">&gt;</span>0.2.0<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">version</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">39</span>         <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">dependency</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">40</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">dependency</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">41</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>com.edu<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">42</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>hello-dubbo-service-user-api<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">43</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">version</span><span style="color: #0000ff;">&gt;</span>${project.version}<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">version</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">44</span>         <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">dependency</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">45</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">dependency</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">46</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>de.javakaffee<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">47</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>kryo-serializers<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">48</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">version</span><span style="color: #0000ff;">&gt;</span>0.42<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">version</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">49</span>         <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">dependency</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">50</span>         <span style="color: #008000;">&lt;!--</span><span style="color: #008000;"> https://mvnrepository.com/artifact/org.springframework.cloud/spring-cloud-starter-hystrix </span><span style="color: #008000;">--&gt;</span>
<span style="color: #008080;">51</span>         <span style="color: #008000;">&lt;!--</span><span style="color: #008000;"> https://mvnrepository.com/artifact/org.springframework.cloud/spring-cloud-starter-netflix-hystrix </span><span style="color: #008000;">--&gt;</span>
<span style="color: #008080;">52</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">dependency</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">53</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>org.springframework.cloud<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">54</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>spring-cloud-starter-netflix-hystrix<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">55</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">version</span><span style="color: #0000ff;">&gt;</span>2.0.1.RELEASE<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">version</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">56</span>         <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">dependency</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">57</span>         <span style="color: #008000;">&lt;!--</span><span style="color: #008000;"> https://mvnrepository.com/artifact/org.springframework.cloud/spring-cloud-starter-netflix-hystrix-dashboard </span><span style="color: #008000;">--&gt;</span>
<span style="color: #008080;">58</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">dependency</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">59</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>org.springframework.cloud<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">60</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>spring-cloud-starter-netflix-hystrix-dashboard<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">61</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">version</span><span style="color: #0000ff;">&gt;</span>2.0.1.RELEASE<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">version</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">62</span>         <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">dependency</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">63</span> 
<span style="color: #008080;">64</span> 
<span style="color: #008080;">65</span> 
<span style="color: #008080;">66</span>     <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">dependencies</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">67</span> 
<span style="color: #008080;">68</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">build</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">69</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">plugins</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">70</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">plugin</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">71</span>                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>org.springframework.boot<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">72</span>                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>spring-boot-maven-plugin<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">73</span>             <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">plugin</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">74</span>         <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">plugins</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">75</span>     <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">build</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">76</span> 
<span style="color: #008080;">77</span> <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">project</span><span style="color: #0000ff;">&gt;</span></code></pre>

<span class="cnblogs_code_collapse">View Code</span>
<p>本文pom文件和yml文件主要是根据dubbo官网中服务提供者的pom文件中的依赖而来，具体参考：<a href="https://github.com/apache/dubbo-spring-boot-project/tree/master/dubbo-spring-boot-samples/dubbo-registry-zookeeper-samples">https://github.com/apache/dubbo-spring-boot-project/tree/master/dubbo-spring-boot-samples/dubbo-registry-zookeeper-samples</a>。</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="./images/Java微服务（二）：服务消费者与提供者搭建8.png" alt="" /></p>
<p>&nbsp;</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="./images/Java微服务（二）：服务消费者与提供者搭建9.png" alt="" /></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000;"><strong>注意basePackages注解</strong></span></p>
<p><span style="color: #000000; font-size: 18pt;"><strong><strong>4.服务提供者</strong></strong></span></p>
<p><span style="color: #000000;">按照相同的方式创建服务提供者，配置文件和服务提供者也类似，直接贴代码了</span></p>
<p>&nbsp;<img style="display: block; margin-left: auto; margin-right: auto;" src="./images/Java微服务（二）：服务消费者与提供者搭建10.png" alt="" /></p>
<p>&nbsp;</p>
<src class="cnblogs_code">
<pre><code><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> com.edu.hello.dubbo.service.user.consumer.controller;
</span><span style="color: #008080;"> 2</span> 
<span style="color: #008080;"> 3</span> 
<span style="color: #008080;"> 4</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> com.alibaba.dubbo.config.annotation.Reference;
</span><span style="color: #008080;"> 5</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> com.edu.hello.dubbo.service.user.api.UserService;
</span><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> com.netflix.hystrix.contrib.javanica.annotation.HystrixCommand;
</span><span style="color: #008080;"> 7</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.web.bind.annotation.RequestMapping;
</span><span style="color: #008080;"> 8</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.web.bind.annotation.RequestMethod;
</span><span style="color: #008080;"> 9</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.web.bind.annotation.RestController;
</span><span style="color: #008080;">10</span> 
<span style="color: #008080;">11</span> <span style="color: #008000;">/**</span>
<span style="color: #008080;">12</span> <span style="color: #008000;"> * @ClassName UserController
</span><span style="color: #008080;">13</span> <span style="color: #008000;"> * @Deccription TODO
</span><span style="color: #008080;">14</span> <span style="color: #008000;"> * @Author DZ
</span><span style="color: #008080;">15</span> <span style="color: #008000;"> * @Date 2019/8/31 18:37
</span><span style="color: #008080;">16</span> <span style="color: #008000;"> *</span><span style="color: #008000;">*/</span>
<span style="color: #008080;">17</span> <span style="color: #000000;">@RestController
</span><span style="color: #008080;">18</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> UserController {
</span><span style="color: #008080;">19</span> 
<span style="color: #008080;">20</span>     @Reference(version = "${user.service.version}"<span style="color: #000000;">)
</span><span style="color: #008080;">21</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> UserService userService;
</span><span style="color: #008080;">22</span> 
<span style="color: #008080;">23</span>     @HystrixCommand(fallbackMethod = "sayHiError"<span style="color: #000000;">)
</span><span style="color: #008080;">24</span>     @RequestMapping(value = "hi", method =<span style="color: #000000;"> RequestMethod.GET)
</span><span style="color: #008080;">25</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> String sayHi() {
</span><span style="color: #008080;">26</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> userService.sayHi();
</span><span style="color: #008080;">27</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">28</span> 
<span style="color: #008080;">29</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> String sayHiError() {
</span><span style="color: #008080;">30</span>         <span style="color: #0000ff;">return</span> "Hystrix fallback"<span style="color: #000000;">;
</span><span style="color: #008080;">31</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">32</span> }</code></pre>

<p><img style="display: block; margin-left: auto; margin-right: auto;" src="./images/Java微服务（二）：服务消费者与提供者搭建11.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>yml配置文件和pom配置文件和提供者基本类似；</p>
<src class="cnblogs_code" onclick="cnblogs_code_show('eff9ae06-5ce1-4bc1-bec5-b8feb48fb98d')"><img id="code_img_closed_eff9ae06-5ce1-4bc1-bec5-b8feb48fb98d" class="code_img_closed" src="./images/Java微服务（二）：服务消费者与提供者搭建4.png" alt="" /><img id="code_img_opened_eff9ae06-5ce1-4bc1-bec5-b8feb48fb98d" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('eff9ae06-5ce1-4bc1-bec5-b8feb48fb98d',event)" src="./images/Java微服务（二）：服务消费者与提供者搭建5.png" alt="" />
<src id="cnblogs_code_open_eff9ae06-5ce1-4bc1-bec5-b8feb48fb98d" class="cnblogs_code_hide">
<pre><code><span style="color: #008080;"> 1</span> <span style="color: #000000;">spring:
</span><span style="color: #008080;"> 2</span> <span style="color: #000000;">  application:
</span><span style="color: #008080;"> 3</span> <span style="color: #000000;">    name: hello-dubbo-service-user-consumer
</span><span style="color: #008080;"> 4</span> 
<span style="color: #008080;"> 5</span> <span style="color: #000000;">user:
</span><span style="color: #008080;"> 6</span> <span style="color: #000000;">  service:
</span><span style="color: #008080;"> 7</span> <span style="color: #000000;">    version: 1.0.0
</span><span style="color: #008080;"> 8</span> 
<span style="color: #008080;"> 9</span> <span style="color: #000000;">dubbo:
</span><span style="color: #008080;">10</span> <span style="color: #000000;">  scan:
</span><span style="color: #008080;">11</span> <span style="color: #000000;">    basePackages: com.edu.hello.dubbo.service.user.consumer.controller
</span><span style="color: #008080;">12</span> <span style="color: #000000;">  application:
</span><span style="color: #008080;">13</span> <span style="color: #000000;">    id: hello-dubbo-service-user-consumer
</span><span style="color: #008080;">14</span> <span style="color: #000000;">    name: hello-dubbo-service-user-consumer
</span><span style="color: #008080;">15</span> <span style="color: #000000;">    qos-port: 22223
</span><span style="color: #008080;">16</span> <span style="color: #000000;">    qos-enable: true
</span><span style="color: #008080;">17</span> <span style="color: #000000;">  protocol:
</span><span style="color: #008080;">18</span> <span style="color: #000000;">    id: dubbo
</span><span style="color: #008080;">19</span> <span style="color: #000000;">    name: dubbo
</span><span style="color: #008080;">20</span> <span style="color: #000000;">    port: 12345
</span><span style="color: #008080;">21</span> <span style="color: #000000;">    #status: server
</span><span style="color: #008080;">22</span> <span style="color: #000000;">    serialization: kryo
</span><span style="color: #008080;">23</span> <span style="color: #000000;">  registry:
</span><span style="color: #008080;">24</span> <span style="color: #000000;">    id: zookeeper
</span><span style="color: #008080;">25</span> <span style="color: #000000;">    address: zookeeper://192.168.1.12:2181?back=192.168.1.12:2182,192.168.1.12:2183
</span><span style="color: #008080;">26</span> 
<span style="color: #008080;">27</span> 
<span style="color: #008080;">28</span> <span style="color: #000000;">management:
</span><span style="color: #008080;">29</span> <span style="color: #000000;">  endpoint:
</span><span style="color: #008080;">30</span> <span style="color: #000000;">    dubbo:
</span><span style="color: #008080;">31</span> <span style="color: #000000;">      enable: true
</span><span style="color: #008080;">32</span> <span style="color: #000000;">    dubbo-shutdown:
</span><span style="color: #008080;">33</span> <span style="color: #000000;">      enabled: true
</span><span style="color: #008080;">34</span> <span style="color: #000000;">    dubbo-configs:
</span><span style="color: #008080;">35</span> <span style="color: #000000;">      enabled: true
</span><span style="color: #008080;">36</span> <span style="color: #000000;">    dubbo-services:
</span><span style="color: #008080;">37</span> <span style="color: #000000;">      enabled: true
</span><span style="color: #008080;">38</span> <span style="color: #000000;">    dubbo-references:
</span><span style="color: #008080;">39</span> <span style="color: #000000;">      enabled: true
</span><span style="color: #008080;">40</span> <span style="color: #000000;">    dubbo-peoperties:
</span><span style="color: #008080;">41</span> <span style="color: #000000;">      enabled: true
</span><span style="color: #008080;">42</span> <span style="color: #000000;">  health:
</span><span style="color: #008080;">43</span> <span style="color: #000000;">    dubbo:
</span><span style="color: #008080;">44</span> <span style="color: #000000;">      status:
</span><span style="color: #008080;">45</span> <span style="color: #000000;">        defaults: memory
</span><span style="color: #008080;">46</span> <span style="color: #000000;">        extras: load,threadpool
</span><span style="color: #008080;">47</span> <span style="color: #000000;">server:
</span><span style="color: #008080;">48</span>   port: 9090</code></pre>

<span class="cnblogs_code_collapse">View Code</span>
<src class="cnblogs_code" onclick="cnblogs_code_show('f5a0eb13-5cdc-4d7f-8293-8593e61f5387')"><img id="code_img_closed_f5a0eb13-5cdc-4d7f-8293-8593e61f5387" class="code_img_closed" src="./images/Java微服务（二）：服务消费者与提供者搭建4.png" alt="" /><img id="code_img_opened_f5a0eb13-5cdc-4d7f-8293-8593e61f5387" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('f5a0eb13-5cdc-4d7f-8293-8593e61f5387',event)" src="./images/Java微服务（二）：服务消费者与提供者搭建5.png" alt="" />
<src id="cnblogs_code_open_f5a0eb13-5cdc-4d7f-8293-8593e61f5387" class="cnblogs_code_hide">
<pre><code><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="UTF-8"</span><span style="color: #0000ff;">?&gt;</span>
<span style="color: #008080;"> 2</span> <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">project </span><span style="color: #ff0000;">xmlns</span><span style="color: #0000ff;">="http://maven.apache.org/POM/4.0.0"</span><span style="color: #ff0000;"> xmlns:xsi</span><span style="color: #0000ff;">="http://www.w3.org/2001/XMLSchema-instance"</span>
<span style="color: #008080;"> 3</span> <span style="color: #ff0000;">         xsi:schemaLocation</span><span style="color: #0000ff;">="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd"</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 4</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">modelVersion</span><span style="color: #0000ff;">&gt;</span>4.0.0<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">modelVersion</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 5</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">parent</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 6</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>org.springframework.boot<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 7</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>spring-boot-starter-parent<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 8</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">version</span><span style="color: #0000ff;">&gt;</span>2.1.7.RELEASE<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">version</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 9</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">relativePath</span><span style="color: #0000ff;">/&gt;</span> <span style="color: #008000;">&lt;!--</span><span style="color: #008000;"> lookup parent from repository </span><span style="color: #008000;">--&gt;</span>
<span style="color: #008080;">10</span>     <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">parent</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">11</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>com.edu<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">12</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>hello-dubbo-service-user-consumer<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">13</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">version</span><span style="color: #0000ff;">&gt;</span>1.0.0-SNAPSHOT<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">version</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">14</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">name</span><span style="color: #0000ff;">&gt;</span>hello-dubbo-service-user-consumer<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">name</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">15</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">description</span><span style="color: #0000ff;">&gt;</span>Demo project for Spring Boot<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">description</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">16</span> 
<span style="color: #008080;">17</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">properties</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">18</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">java.version</span><span style="color: #0000ff;">&gt;</span>1.8<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">java.version</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">19</span>     <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">properties</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">20</span> 
<span style="color: #008080;">21</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">dependencies</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">22</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">dependency</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">23</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>org.springframework.boot<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">24</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>spring-boot-starter-web<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">25</span>         <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">dependency</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">26</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">dependency</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">27</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>org.springframework.boot<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">28</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>spring-boot-starter-actuator<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">29</span>         <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">dependency</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">30</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">dependency</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">31</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>org.springframework.boot<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">32</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>spring-boot-starter-test<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">33</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">scope</span><span style="color: #0000ff;">&gt;</span>test<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">scope</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">34</span>         <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">dependency</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">35</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">dependency</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">36</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>com.alibaba.boot<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">37</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>dubbo-spring-boot-starter<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">38</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">version</span><span style="color: #0000ff;">&gt;</span>0.2.0<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">version</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">39</span>         <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">dependency</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">40</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">dependency</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">41</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>com.edu<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">42</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>hello-dubbo-service-user-api<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">43</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">version</span><span style="color: #0000ff;">&gt;</span>${project.version}<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">version</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">44</span>         <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">dependency</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">45</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">dependency</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">46</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>de.javakaffee<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">47</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>kryo-serializers<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">48</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">version</span><span style="color: #0000ff;">&gt;</span>0.42<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">version</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">49</span>         <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">dependency</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">50</span>         <span style="color: #008000;">&lt;!--</span><span style="color: #008000;"> https://mvnrepository.com/artifact/org.springframework.cloud/spring-cloud-starter-hystrix </span><span style="color: #008000;">--&gt;</span>
<span style="color: #008080;">51</span>         <span style="color: #008000;">&lt;!--</span><span style="color: #008000;"> https://mvnrepository.com/artifact/org.springframework.cloud/spring-cloud-starter-netflix-hystrix </span><span style="color: #008000;">--&gt;</span>
<span style="color: #008080;">52</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">dependency</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">53</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>org.springframework.cloud<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">54</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>spring-cloud-starter-netflix-hystrix<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">55</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">version</span><span style="color: #0000ff;">&gt;</span>2.0.1.RELEASE<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">version</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">56</span>         <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">dependency</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">57</span>         <span style="color: #008000;">&lt;!--</span><span style="color: #008000;"> https://mvnrepository.com/artifact/org.springframework.cloud/spring-cloud-starter-netflix-hystrix-dashboard </span><span style="color: #008000;">--&gt;</span>
<span style="color: #008080;">58</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">dependency</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">59</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>org.springframework.cloud<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">60</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>spring-cloud-starter-netflix-hystrix-dashboard<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">61</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">version</span><span style="color: #0000ff;">&gt;</span>2.0.1.RELEASE<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">version</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">62</span>         <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">dependency</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">63</span>     <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">dependencies</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">64</span> 
<span style="color: #008080;">65</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">build</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">66</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">plugins</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">67</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">plugin</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">68</span>                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>org.springframework.boot<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">groupId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">69</span>                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>spring-boot-maven-plugin<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">70</span>                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">configuration</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">71</span>                     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">mainClass</span><span style="color: #0000ff;">&gt;</span>com.edu.hello.dubbo.service.user.consumer.HelloDubboServiceUserConsumerApplication<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">mainClass</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">72</span>                 <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">configuration</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">73</span>             <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">plugin</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">74</span>         <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">plugins</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">75</span>     <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">build</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;">76</span> 
<span style="color: #008080;">77</span> <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">project</span><span style="color: #0000ff;">&gt;</span></code></pre>

<span class="cnblogs_code_collapse">View Code</span>
<p>这里面关于服务熔断和负载均衡的的代码可以暂时不关注，后面会专门对熔断进行讨论。</p>
<p>&nbsp;</p>
<p><span style="font-size: 18pt;">5<strong style="font-weight: bold;">.结果</strong></span></p>
<p>分别启动服务消费者和服务提供者，启动成功后，如下：</p>
<p><img src="./images/Java微服务（二）：服务消费者与提供者搭建16.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;访问<a href="http://localhost:9090/hi">http://localhost:9090/hi</a></p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="./images/Java微服务（二）：服务消费者与提供者搭建17.png" alt="" /></p>
<p>&nbsp;</p>
<p>同时我们可以启动dubbo-admin控制台查看服务，<span style="color: #ff0000;">注意端口的冲突</span>：</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="./images/Java微服务（二）：服务消费者与提供者搭建18.png" alt="" /></p>
<p>&nbsp;</p>

</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>