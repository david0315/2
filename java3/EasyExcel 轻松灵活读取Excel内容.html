<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='ç”µè„‘,ç”µè„‘è®²è§£,ç”µè„‘æŠ€æœ¯,ç¼–ç¨‹,ç”µè„‘æ•…éšœç»´ä¿®EasyExcel è½»æ¾çµæ´»è¯»å–Excelå†…å®¹' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>é¦–é¡µ</a></li>
</div><div onclick='hidden1()' >åˆ†äº«</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>EasyExcel è½»æ¾çµæ´»è¯»å–Excelå†…å®¹</center></div><div class='banquan'>åŸæ–‡å‡ºå¤„:æœ¬æ–‡ç”±åšå®¢å›­åšä¸»æ—¥æ‹±ä¸€å…µæä¾›ã€‚<br/>
åŸæ–‡è¿æ¥:https://www.cnblogs.com/FraserYu/p/11717665.html</div><br>
    <h2 id="å†™åœ¨å‰é¢">å†™åœ¨å‰é¢</h2>
<p>Java åç«¯ç¨‹åºå‘˜åº”è¯¥ä¼šé‡åˆ°è¯»å– Excel ä¿¡æ¯åˆ° DB ç­‰ç›¸å…³éœ€æ±‚ï¼Œè„‘æµ·ä¸­å¯èƒ½çªç„¶é—´æƒ³èµ· Apache POI è¿™ä¸ªæŠ€æœ¯è§£å†³æ–¹æ¡ˆï¼Œä½†æ˜¯å½“ Excel çš„æ•°æ®é‡éå¸¸å¤§çš„æ—¶å€™ï¼Œä½ ä¹Ÿè®¸å‘ç°ï¼ŒPOI æ˜¯å°†æ•´ä¸ª Excel çš„å†…å®¹å…¨éƒ¨è¯»å‡ºæ¥æ”¾å…¥åˆ°å†…å­˜ä¸­ï¼Œæ‰€ä»¥å†…å­˜æ¶ˆè€—éå¸¸ä¸¥é‡ï¼Œå¦‚æœåŒæ—¶è¿›è¡ŒåŒ…å«å¤§æ•°æ®é‡çš„ Excel è¯»æ“ä½œï¼Œå¾ˆå®¹æ˜“é€ æˆå†…å­˜æº¢å‡ºé—®é¢˜</p>
<p>ä½† EasyExcel çš„å‡ºç°å¾ˆå¥½çš„è§£å†³äº† POI ç›¸å…³é—®é¢˜ï¼ŒåŸæœ¬ä¸€ä¸ª 3M çš„ Excel ç”¨ POI éœ€è¦100Må·¦å³å†…å­˜, è€Œ EasyExcel å¯ä»¥å°†å…¶é™ä½åˆ°å‡  Mï¼ŒåŒæ—¶å†å¤§çš„ Excel éƒ½ä¸ä¼šå‡ºç°å†…å­˜æº¢å‡ºçš„æƒ…å†µï¼Œå› ä¸ºæ˜¯é€è¡Œè¯»å– Excel çš„å†…å®¹ (è€è§„çŸ©ï¼Œè¿™é‡Œä¸ç”¨è¿‡åˆ†å…³å¿ƒä¸‹å›¾ï¼Œè„‘æµ·ä¸­æœ‰ä¸ªå°è±¡å³å¯ï¼Œçœ‹å®Œä¸‹é¢çš„ç”¨ä¾‹å†å›çœ‹è¿™ä¸ªå›¾ï¼Œå°±å¾ˆç®€å•äº†)</p>
<p><img src="./images/EasyExcel è½»æ¾çµæ´»è¯»å–Excelå†…å®¹0.png" /></p>
<p>å¦å¤– EasyExcel åœ¨ä¸Šå±‚åšäº†æ¨¡å‹è½¬æ¢çš„å°è£…ï¼Œä¸éœ€è¦ cell ç­‰ç›¸å…³æ“ä½œï¼Œè®©ä½¿ç”¨è€…æ›´åŠ ç®€å•å’Œæ–¹ä¾¿ï¼Œä¸”çœ‹</p>
<h2 id="ç®€å•è¯»">ç®€å•è¯»</h2>
<p>å‡è®¾æˆ‘ä»¬ excel ä¸­æœ‰ä»¥ä¸‹å†…å®¹:</p>
<p><img src="./images/EasyExcel è½»æ¾çµæ´»è¯»å–Excelå†…å®¹1.png" /></p>
<p>æˆ‘ä»¬éœ€è¦æ–°å»º User å®ä½“ï¼ŒåŒæ—¶ä¸ºå…¶æ·»åŠ æˆå‘˜å˜é‡</p>
<pre><code><code>@Data
public class User {

    /**
     * å§“å
     */
    @ExcelProperty(index = 0)
    private String name;

    /**
     * å¹´é¾„
     */
    @ExcelProperty(index = 1)
    private Integer age;
}</code></code></pre>
<p>ä½ ä¹Ÿè®¸å…³æ³¨åˆ°äº† <code>@ExcelProperty</code> æ³¨è§£ï¼ŒåŒæ—¶ä½¿ç”¨äº† index å±æ€§ (0 ä»£è¡¨ç¬¬ä¸€åˆ—ï¼Œä»¥æ­¤ç±»æ¨)ï¼Œè¯¥æ³¨è§£åŒæ—¶æ”¯æŒä»¥ã€Œåˆ—åã€name çš„æ–¹å¼åŒ¹é…ï¼Œæ¯”å¦‚:</p>
<pre><code><code>@ExcelProperty(&quot;å§“å&quot;)
private String name;</code></code></pre>
<p>æŒ‰ç…§ github æ–‡æ¡£çš„è¯´æ˜:</p>
<blockquote>
<p>ä¸å»ºè®® index å’Œ name åŒæ—¶ç”¨ï¼Œè¦ä¹ˆä¸€ä¸ªå¯¹è±¡åªç”¨indexï¼Œè¦ä¹ˆä¸€ä¸ªå¯¹è±¡åªç”¨nameå»åŒ¹é…</p>
</blockquote>
<ol>
<li>å¦‚æœè¯»å–çš„ Excel æ¨¡æ¿ä¿¡æ¯åˆ—å›ºå®šï¼Œè¿™é‡Œå»ºè®®ä»¥ index çš„å½¢å¼ä½¿ç”¨ï¼Œå› ä¸ºå¦‚æœç”¨åå­—å»åŒ¹é…ï¼Œåå­—é‡å¤ï¼Œä¼šå¯¼è‡´åªæœ‰ä¸€ä¸ªå­—æ®µè¯»å–åˆ°æ•°æ®ï¼Œæ‰€ä»¥ index æ˜¯æ›´ç¨³å¦¥çš„æ–¹å¼</li>
<li>å¦‚æœ Excel æ¨¡æ¿çš„åˆ— index ç»å¸¸æœ‰å˜åŒ–ï¼Œé‚£è¿˜æ˜¯é€‰æ‹© name æ–¹å¼æ¯”è¾ƒå¥½ï¼Œä¸ç”¨ç»å¸¸æ€§ä¿®æ”¹å®ä½“çš„æ³¨è§£ index æ•°å€¼</li>
</ol>
<p>æ‰€ä»¥å¤§å®¶å¯ä»¥æ ¹æ®è‡ªå·±çš„æƒ…å†µè‡ªè¡Œé€‰æ‹©</p>
<p>ç¼–å†™æµ‹è¯•ç”¨ä¾‹<br />
<img src="./images/EasyExcel è½»æ¾çµæ´»è¯»å–Excelå†…å®¹2.png" /></p>
<p>EasyExcel ç±»ä¸­é‡è½½äº†å¾ˆå¤šä¸ª read æ–¹æ³•ï¼Œè¿™é‡Œä¸ä¸€ä¸€åˆ—ä¸¾è¯´æ˜ï¼Œè¯·å¤§å®¶è‡ªè¡ŒæŸ¥çœ‹ï¼›åŒæ—¶ sheet æ–¹æ³•ä¹Ÿå¯ä»¥æŒ‡å®š sheetNoï¼Œé»˜è®¤æ˜¯ç¬¬ä¸€ä¸ª sheet çš„ä¿¡æ¯</p>
<p>ä¸Šé¢ä»£ç çš„ <code>new UserExcelListener()</code> å¼‚å¸¸é†’ç›®ï¼Œè¿™ä¹Ÿæ˜¯ EasyExcel é€è¡Œè¯»å– Excel å†…å®¹çš„å…³é”®æ‰€åœ¨ï¼Œè‡ªå®šä¹‰ <code>UserExcelListener</code> ç»§æ‰¿ <code>AnalysisEventListener</code></p>
<pre><code><code>@Slf4j
public class UserExcelListener extends AnalysisEventListener&lt;User&gt; {

    /**
     * æ‰¹å¤„ç†é˜ˆå€¼
     */
    private static final int BATCH_COUNT = 2;
    List&lt;User&gt; list = new ArrayList&lt;User&gt;(BATCH_COUNT);

    @Override
    public void invoke(User user, AnalysisContext analysisContext) {
        log.info(&quot;è§£æåˆ°ä¸€æ¡æ•°æ®:{}&quot;, JSON.toJSONString(user));
        list.add(user);
        if (list.size() &gt;= BATCH_COUNT) {
            saveData();
            list.clear();
        }
    }

    @Override
    public void doAfterAllAnalysed(AnalysisContext analysisContext) {
        saveData();
        log.info(&quot;æ‰€æœ‰æ•°æ®è§£æå®Œæˆï¼&quot;);
    }

    private void saveData(){
        log.info(&quot;{}æ¡æ•°æ®ï¼Œå¼€å§‹å­˜å‚¨æ•°æ®åº“ï¼&quot;, list.size());
        log.info(&quot;å­˜å‚¨æ•°æ®åº“æˆåŠŸï¼&quot;);
    }
}</code></code></pre>
<p>åˆ°è¿™é‡Œè¯·å›çœ‹æ–‡ç« å¼€å¤´çš„ EasyExcel åŸç†å›¾ï¼Œinvoke æ–¹æ³•é€è¡Œè¯»å–æ•°æ®ï¼Œå¯¹åº”çš„å°±æ˜¯è®¢é˜…è€… 1ï¼›doAfterAllAnalysed æ–¹æ³•å¯¹åº”çš„å°±æ˜¯è®¢é˜…è€… 2ï¼Œè¿™æ ·ä½ ç†è§£äº†å—ï¼Ÿ</p>
<p>æ‰“å°ç»“æœ:</p>
<p><img src="./images/EasyExcel è½»æ¾çµæ´»è¯»å–Excelå†…å®¹3.png" /></p>
<p>ä»è¿™é‡Œå¯ä»¥çœ‹å‡ºï¼Œè™½ç„¶æ˜¯é€è¡Œè§£ææ•°æ®ï¼Œä½†æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰é˜ˆå€¼ï¼Œå®Œæˆæ•°æ®çš„æ‰¹å¤„ç†æ“ä½œï¼Œå¯è§ EasyExcel æ“ä½œçš„çµæ´»æ€§</p>
<h2 id="è‡ªå®šä¹‰è½¬æ¢å™¨">è‡ªå®šä¹‰è½¬æ¢å™¨</h2>
<p>è¿™æ˜¯æœ€åŸºæœ¬çš„æ•°æ®è¯»å†™ï¼Œæˆ‘ä»¬çš„ä¸šåŠ¡æ•°æ®é€šå¸¸ä¸å¯èƒ½è¿™ä¹ˆç®€å•ï¼Œæœ‰æ—¶ç”šè‡³éœ€è¦å°†å…¶è½¬æ¢ä¸ºç¨‹åºå¯è¯»çš„æ•°æ®</p>
<h3 id="æ€§åˆ«ä¿¡æ¯è½¬æ¢">æ€§åˆ«ä¿¡æ¯è½¬æ¢</h3>
<p>æ¯”å¦‚ Excel ä¸­æ–°å¢ã€Œæ€§åˆ«ã€åˆ—ï¼Œå…¶æ€§åˆ«ä¸ºç”·/å¥³ï¼Œæˆ‘ä»¬éœ€è¦å°† Excel ä¸­çš„æ€§åˆ«ä¿¡æ¯è½¬æ¢æˆç¨‹åºä¿¡æ¯: ã€Œ1: ç”·ï¼›2:å¥³ã€</p>
<p><img src="./images/EasyExcel è½»æ¾çµæ´»è¯»å–Excelå†…å®¹4.png" /></p>
<p>é¦–å…ˆåœ¨ User å®ä½“ä¸­æ·»åŠ æˆå‘˜å˜é‡ gender:</p>
<pre><code><code>@ExcelProperty(index = 2)
private Integer gender;</code></code></pre>
<p>EasyExcel æ”¯æŒæˆ‘ä»¬è‡ªå®šä¹‰ converterï¼Œå°† excel çš„å†…å®¹è½¬æ¢ä¸ºæˆ‘ä»¬ç¨‹åºéœ€è¦çš„ä¿¡æ¯ï¼Œè¿™é‡Œæ–°å»º GenderConverterï¼Œç”¨æ¥è½¬æ¢æ€§åˆ«ä¿¡æ¯</p>
<pre><code><code>public class GenderConverter implements Converter&lt;Integer&gt; {

    public static final String MALE = &quot;ç”·&quot;;
    public static final String FEMALE = &quot;å¥³&quot;;

    @Override
    public Class supportJavaTypeKey() {
        return Integer.class;
    }

    @Override
    public CellDataTypeEnum supportExcelTypeKey() {
        return CellDataTypeEnum.STRING;
    }

    @Override
    public Integer convertToJavaData(CellData cellData, ExcelContentProperty excelContentProperty, GlobalConfiguration globalConfiguration) throws Exception {
        String stringValue = cellData.getStringValue();
        if (MALE.equals(stringValue)){
            return 1;
        }else {
            return 2;
        }
    }

    @Override
    public CellData convertToExcelData(Integer integer, ExcelContentProperty excelContentProperty, GlobalConfiguration globalConfiguration) throws Exception {
        return null;
    }
}</code></code></pre>
<blockquote>
<p>ä¸Šé¢ç¨‹åºçš„ Converter æ¥å£çš„æ³›å‹æ˜¯æŒ‡è¦è½¬æ¢çš„ Java æ•°æ®ç±»å‹ï¼Œä¸ supportJavaTypeKey æ–¹æ³•ä¸­çš„è¿”å›å€¼ç±»å‹ä¸€è‡´</p>
</blockquote>
<p>æ‰“å¼€æ³¨è§£ <code>@ExcelProperty</code> æŸ¥çœ‹ï¼Œè¯¥æ³¨è§£æ˜¯æ”¯æŒè‡ªå®šä¹‰ Converter çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸º User å®ä½“æ·»åŠ  <strong>gender</strong> æˆå‘˜å˜é‡ï¼Œå¹¶æŒ‡å®š converter</p>
<pre><code><code>/**
 * æ€§åˆ« 1ï¼šç”·ï¼›2ï¼šå¥³
 */
@ExcelProperty(index = 2, converter = GenderConverter.class)
private Integer gender;</code></code></pre>
<p>æ¥çœ‹è¿è¡Œç»“æœ:</p>
<p><img src="./images/EasyExcel è½»æ¾çµæ´»è¯»å–Excelå†…å®¹5.png" /></p>
<p>æ•°æ®æŒ‰ç…§æˆ‘ä»¬é¢„æœŸåšå‡ºäº†è½¬æ¢ï¼Œä»è¿™é‡Œä¹Ÿå¯ä»¥çœ‹å‡ºï¼ŒConverter å¯ä»¥ä¸€æ¬¡å®šä¹‰åˆ°å¤„æ˜¯ç”¨çš„ä¾¿åˆ©æ€§</p>
<h3 id="æ—¥æœŸä¿¡æ¯è½¬æ¢">æ—¥æœŸä¿¡æ¯è½¬æ¢</h3>
<p>æ—¥æœŸä¿¡æ¯ä¹Ÿæ˜¯æˆ‘ä»¬å¸¸è§çš„è½¬æ¢æ•°æ®ï¼Œæ¯”å¦‚ Excel ä¸­æ–°å¢ã€Œå‡ºç”Ÿå¹´æœˆã€åˆ—ï¼Œæˆ‘ä»¬è¦è§£ææˆ <strong>yyyy-MM-dd</strong> æ ¼å¼ï¼Œæˆ‘ä»¬éœ€è¦å°†å…¶è¿›è¡Œæ ¼å¼åŒ–ï¼ŒEasyExcel é€šè¿‡ <code>@DateTimeFormat</code> æ³¨è§£è¿›è¡Œæ ¼å¼åŒ–</p>
<p><img src="./images/EasyExcel è½»æ¾çµæ´»è¯»å–Excelå†…å®¹6.png" /></p>
<p>åœ¨ User å®ä½“ä¸­æ·»åŠ æˆå‘˜å˜é‡ <strong>birth</strong>ï¼ŒåŒæ—¶åº”ç”¨ <code>@DateTimeFormat</code> æ³¨è§£ï¼ŒæŒ‰ç…§è¦æ±‚åšæ ¼å¼åŒ–</p>
<pre><code><code>/**
 * å‡ºç”Ÿæ—¥æœŸ
 */
@ExcelProperty(index = 3)
@DateTimeFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;)
private String birth;</code></code></pre>
<p>æ¥çœ‹è¿è¡Œç»“æœ:</p>
<p><img src="./images/EasyExcel è½»æ¾çµæ´»è¯»å–Excelå†…å®¹7.png" /></p>
<p>å¦‚æœè¿™é‡Œä½ æŒ‡å®š birth çš„ç±»å‹ä¸º Dateï¼Œè¯•è¯•çœ‹ï¼Œä½ å¾—åˆ°çš„ç»“æœæ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>åˆ°è¿™é‡Œéƒ½æ˜¯ä»¥æµ‹è¯•çš„æ–¹å¼æ¥ç¼–å†™ç¨‹åºä»£ç ï¼Œä½œä¸º Java Web å¼€å‘äººå‘˜ï¼Œå°¤å…¶åœ¨ç›®å‰ä¸»æµ Spring Boot çš„æ¶æ„ä¸‹ï¼Œæ‰€ä»¥å¦‚ä½•å®ç° Web æ–¹å¼è¯»å– Excel çš„ä¿¡æ¯å‘¢ï¼Ÿ</p>
<h2 id="web-è¯»">web è¯»</h2>
<h3 id="ç®€å•-web">ç®€å• Web</h3>
<p>å¾ˆç®€å•ï¼Œåªæ˜¯å°†æµ‹è¯•ç”¨ä¾‹çš„å…³é”®ä»£ç ç§»åŠ¨åˆ° Controller ä¸­å³å¯ï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ª <code>UserController</code>ï¼Œåœ¨å…¶æ·»åŠ  <code>upload</code> æ–¹æ³•</p>
<pre><code><code>@RestController
@RequestMapping(&quot;/users&quot;)
@Slf4j
public class UserController {
    @PostMapping(&quot;/upload&quot;)
    public String upload(MultipartFile file) throws IOException {
        EasyExcel.read(file.getInputStream(), User.class, new UserExcelListener()).sheet().doRead();
        return &quot;success&quot;;
    }
}</code></code></pre>
<p>å…¶å®åœ¨å†™æµ‹è¯•ç”¨ä¾‹çš„æ—¶å€™ä½ ä¹Ÿè®¸å·²ç»å‘ç°ï¼Œlistener æ˜¯ä»¥ new çš„å½¢å¼ä½œä¸ºå‚æ•°ä¼ å…¥åˆ° EasyExcel.read æ–¹æ³•ä¸­çš„ï¼Œè¿™æ˜¯ä¸ç¬¦åˆ Spring IoC çš„è§„åˆ™çš„ï¼Œæˆ‘ä»¬é€šå¸¸è¯»å– Excel æ•°æ®ä¹‹åéƒ½è¦é’ˆå¯¹è¯»å–çš„æ•°æ®ç¼–å†™ä¸€äº›ä¸šåŠ¡é€»è¾‘çš„ï¼Œè€Œä¸šåŠ¡é€»è¾‘é€šå¸¸åˆä¼šå†™åœ¨ Service å±‚ä¸­ï¼Œæˆ‘ä»¬å¦‚ä½•åœ¨ listener ä¸­è°ƒç”¨åˆ°æˆ‘ä»¬çš„ service ä»£ç å‘¢ï¼Ÿ</p>
<p><strong>å…ˆä¸è¦å‘ä¸‹çœ‹ï¼Œä½ è„‘æµ·ä¸­æœ‰å“ªäº›æ–¹æ¡ˆå‘¢ï¼Ÿ </strong></p>
<h3 id="åŒ¿åå†…éƒ¨ç±»æ–¹å¼">åŒ¿åå†…éƒ¨ç±»æ–¹å¼</h3>
<p>åŒ¿åå†…éƒ¨ç±»æ˜¯æœ€ç®€å•çš„æ–¹å¼ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ–°å»º Service å±‚çš„ä¿¡æ¯:<br />
æ–°å»º IUser æ¥å£:</p>
<pre><code><code>public interface IUser {
    public boolean saveData(List&lt;User&gt; users);
}</code></code></pre>
<p>æ–°å»º IUser æ¥å£å®ç°ç±» UserServiceImpl:</p>
<pre><code><code>@Service
@Slf4j
public class UserServiceImpl implements IUser {
    @Override
    public boolean saveData(List&lt;User&gt; users) {
        log.info(&quot;UserService {}æ¡æ•°æ®ï¼Œå¼€å§‹å­˜å‚¨æ•°æ®åº“ï¼&quot;, users.size());
        log.info(JSON.toJSONString(users));
        log.info(&quot;UserService å­˜å‚¨æ•°æ®åº“æˆåŠŸï¼&quot;);
        return true;
    }
}</code></code></pre>
<p>æ¥ä¸‹æ¥ï¼Œåœ¨ Controller ä¸­æ³¨å…¥ IUser:</p>
<pre><code><code>@Autowired
private IUser iUser;</code></code></pre>
<p>ä¿®æ”¹ upload æ–¹æ³•ï¼Œä»¥åŒ¿åå†…éƒ¨ç±»é‡å†™ listener æ–¹æ³•çš„å½¢å¼æ¥å®ç°:</p>
<pre><code><code>@PostMapping(&quot;/uploadWithAnonyInnerClass&quot;)
    public String uploadWithAnonyInnerClass(MultipartFile file) throws IOException {
        EasyExcel.read(file.getInputStream(), User.class, new AnalysisEventListener&lt;User&gt;(){
            /**
             * æ‰¹å¤„ç†é˜ˆå€¼
             */
            private static final int BATCH_COUNT = 2;
            List&lt;User&gt; list = new ArrayList&lt;User&gt;();

            @Override
            public void invoke(User user, AnalysisContext analysisContext) {
                log.info(&quot;è§£æåˆ°ä¸€æ¡æ•°æ®:{}&quot;, JSON.toJSONString(user));
                list.add(user);
                if (list.size() &gt;= BATCH_COUNT) {
                    saveData();
                    list.clear();
                }
            }

            @Override
            public void doAfterAllAnalysed(AnalysisContext analysisContext) {
                saveData();
                log.info(&quot;æ‰€æœ‰æ•°æ®è§£æå®Œæˆï¼&quot;);
            }

            private void saveData(){
                iUser.saveData(list);
            }
        }).sheet().doRead();
        return &quot;success&quot;;
    }</code></code></pre>
<p>æŸ¥çœ‹ç»“æœ:</p>
<p><img src="./images/EasyExcel è½»æ¾çµæ´»è¯»å–Excelå†…å®¹8.png" /></p>
<p>è¿™ç§å®ç°æ–¹å¼ï¼Œå…¶å®è¿™åªæ˜¯å°† listener ä¸­çš„å†…å®¹å…¨éƒ¨é‡å†™ï¼Œå¹¶åœ¨ controller ä¸­å±•ç°å‡ºæ¥ï¼Œå½“ä½ çœ‹ç€è¿™ä¹ˆè‡ƒè‚¿çš„ controller æ˜¯ä¸æ˜¯éå¸¸éš¾å—ï¼Ÿå¾ˆæ˜¾ç„¶è¿™ç§æ–¹å¼ä¸æ˜¯æˆ‘ä»¬çš„æœ€ä½³ç¼–ç å®ç°</p>
<h3 id="æ„é€ å™¨ä¼ å‚">æ„é€ å™¨ä¼ å‚</h3>
<p>åœ¨ä¹‹å‰åˆ†æ SpringBoot ç»Ÿä¸€è¿”å›æºç æ—¶ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦å‘ç°ï¼ŒSpring åº•å±‚æºç å¤šæ•°ä»¥æ„é€ å™¨çš„å½¢å¼ä¼ å‚ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†ä¸º listener æ·»åŠ æœ‰å‚æ„é€ å™¨ï¼Œå°† Controller ä¸­ä¾èµ–æ³¨å…¥çš„ IUser ä»¥æ„é€ å™¨çš„å½¢å¼ä¼ å…¥åˆ° listener :</p>
<pre><code><code>@Slf4j
public class UserExcelListener extends AnalysisEventListener&lt;User&gt; {

    private IUser iUser;

    public UserExcelListener(IUser iUser){
        this.iUser = iUser;
    }

    // çœç•¥ç›¸åº”ä»£ç ...

    private void saveData(){
        iUser.saveData(list); //è°ƒç”¨ userService ä¸­çš„ saveData æ–¹æ³•
    }
    </code></code></pre>
<p>æ›´æ”¹ Controller æ–¹æ³•:</p>
<pre><code><code>@PostMapping(&quot;/uploadWithConstructor&quot;)
public String uploadWithConstructor(MultipartFile file) throws IOException {
    EasyExcel.read(file.getInputStream(), User.class, new UserExcelListener(iUser)).sheet().doRead();
    return &quot;success&quot;;
}</code></code></pre>
<p>è¿è¡Œç»“æœ: åŒä¸Š</p>
<p>è¿™æ ·æ›´æ”¹åï¼Œcontroller ä»£ç çœ‹ç€å¾ˆæ¸…æ™°ï¼Œä½†å¦‚æœåç»­ä¸šåŠ¡è¿˜æœ‰åˆ«çš„ Service éœ€è¦æ³¨å…¥ï¼Œæˆ‘ä»¬éš¾é“è¦ä¸€ç›´æ·»åŠ æœ‰å‚æ„é€ å™¨å—ï¼Ÿå¾ˆæ˜æ˜¾ï¼Œè¿™ç§æ–¹å¼åŒæ ·ä¸æ˜¯å¾ˆçµæ´»ã€‚</p>
<p>å…¶å®åœ¨ä½¿ç”¨åŒ¿åå†…éƒ¨ç±»çš„æ—¶å€™ï¼Œä½ ä¹Ÿè®¸ä¼šæƒ³åˆ°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ Java8 lambda çš„æ–¹å¼æ¥è§£å†³è¿™ä¸ªé—®é¢˜</p>
<h3 id="lambda-ä¼ å‚">Lambda ä¼ å‚</h3>
<p>ä¸ºäº†è§£å†³æ„é€ å™¨ä¼ å‚çš„ç—›ç‚¹ï¼ŒåŒæ—¶æˆ‘ä»¬åˆå¸Œæœ› listener æ›´å…·æœ‰é€šç”¨æ€§ï¼Œæ²¡å¿…è¦ä¸ºæ¯ä¸ª Excel ä¸šåŠ¡éƒ½æ–°å»ºä¸€ä¸ª listenerï¼Œå› ä¸º listener éƒ½æ˜¯é€è¡Œè¯»å– Excel æ•°æ®ï¼Œåªéœ€è¦å°†æˆ‘ä»¬çš„ä¸šåŠ¡é€»è¾‘ä»£ç ä¼ å…¥ç»™ listener å³å¯ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€ç”¨åˆ° <code>Consumer&lt;T&gt;</code> ï¼Œå°†å…¶ä½œä¸ºæ„é€  listener çš„å‚æ•°ã€‚</p>
<p>æ–°å»ºä¸€ä¸ªå·¥å…·ç±» ExcelDemoUtilsï¼Œç”¨æ¥æ„é€  listener:</p>
<p><img src="./images/EasyExcel è½»æ¾çµæ´»è¯»å–Excelå†…å®¹9.png" /></p>
<p>æˆ‘ä»¬çœ‹åˆ°ï¼ŒgetListener æ–¹æ³•æ¥æ”¶ä¸€ä¸ª <code>Consumer&lt;List&lt;T&gt;&gt;</code> çš„å‚æ•°ï¼Œè¿™æ ·ä¸‹é¢ä»£ç è¢«è°ƒç”¨æ—¶ï¼Œæˆ‘ä»¬çš„ä¸šåŠ¡é€»è¾‘ä¹Ÿå°±ä¼šè¢«ç›¸åº”çš„æ‰§è¡Œäº†:</p>
<pre><code><code>consumer.accept(linkedList);</code></code></pre>
<p>ç»§ç»­æ”¹é€  Controller æ–¹æ³•:<br />
<img src="./images/EasyExcel è½»æ¾çµæ´»è¯»å–Excelå†…å®¹10.png" /></p>
<p>è¿è¡Œç»“æœ: åŒä¸Š</p>
<p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬åªéœ€è¦å°†ä¸šåŠ¡é€»è¾‘å®šåˆ¶åœ¨ <code>batchInsert</code> æ–¹æ³•ä¸­:</p>
<ol>
<li>æ»¡è¶³ Controller RESTful API çš„ç®€æ´æ€§</li>
<li>listener æ›´åŠ é€šç”¨å’Œçµæ´»ï¼Œå®ƒæ›´å¤šæ˜¯æ‰®æ¼”äº†æŠ½è±¡ç±»çš„è§’è‰²ï¼Œå…·ä½“çš„é€»è¾‘äº¤ç»™æŠ½è±¡æ–¹æ³•çš„å®ç°æ¥å®Œæˆ</li>
<li>ä¸šåŠ¡é€»è¾‘å¯æ‰©å±•æ€§ä¹Ÿæ›´å¥½ï¼Œé€»è¾‘æ›´åŠ æ¸…æ™°</li>
</ol>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>åˆ°è¿™é‡Œï¼Œå…³äºå¦‚ä½•ä½¿ç”¨ EasyExcel è¯»å– Excel ä¿¡æ¯çš„åŸºæœ¬ä½¿ç”¨æ–¹å¼å·²ç»ä»‹ç»å®Œäº†ï¼Œè¿˜æœ‰å¾ˆå¤šç»†èŠ‚å†…å®¹æ²¡æœ‰è®²ï¼Œå¤§å®¶å¯ä»¥è‡ªè¡ŒæŸ¥é˜… <a href="https://github.com/alibaba/easyexcel">EasyExcel Github</a> æ–‡æ¡£å»å‘ç°æ›´å¤šå†…å®¹ã€‚çµæ´»ä½¿ç”¨ Java 8 çš„å‡½æ•°å¼æ¥å£ï¼Œæ›´å®¹æ˜“è®©ä½ æé«˜ä»£ç çš„å¤ç”¨æ€§ï¼ŒåŒæ—¶çœ‹èµ·æ¥æ›´ç®€æ´è§„èŒƒ</p>
<p>é™¤äº†è¯»å– Excel çš„è¯»å–ï¼Œè¿˜æœ‰ Excel çš„å†™å…¥ï¼Œå¦‚æœéœ€è¦å°†å…¶å†™å…¥åˆ°æŒ‡å®šä½ç½®ï¼Œé…åˆ HuTool çš„å·¥å…·ç±» FileWriter çš„ä½¿ç”¨æ˜¯éå¸¸æ–¹ä¾¿çš„ï¼Œé’ˆå¯¹ EasyExcel çš„ä½¿ç”¨ï¼Œå¦‚æœå¤§å®¶æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä¹Ÿæ¬¢è¿åˆ°åšå®¢ä¸‹æ–¹æ¢è®¨</p>
<p>å®Œæ•´ä»£ç è¯·åœ¨å…¬ä¼—å·å›å¤ã€Œdemoã€ï¼Œç‚¹å¼€é“¾æ¥ï¼ŒæŸ¥çœ‹ã€Œeasy-excel-demoã€æ–‡ä»¶å¤¹çš„å†…å®¹å³å¯ï¼Œå¦å¤–ä¸ªäººåšå®¢ç”±äºç‰¹æ®ŠåŸå› æš‚æ—¶å…³é—­é¦–é¡µï¼Œå…¶ä»–ç›®å½•è®¿é—®ä¸€åˆ‡æ­£å¸¸ï¼Œæ›´å¤šæ–‡ç« å¯ä»¥ä» https://dayarch.top/archives å…¥å£æŸ¥çœ‹</p>
<h2 id="æ„Ÿè°¢">æ„Ÿè°¢</h2>
<p>éå¸¸æ„Ÿè°¢ EasyExcel çš„ä½œè€… ğŸŒ¹ğŸŒ¹ï¼Œè®© Excel çš„è¯»å†™æ›´åŠ æ–¹ä¾¿</p>
<h2 id="çµé­‚è¿½é—®">çµé­‚è¿½é—®</h2>
<ol>
<li>é™¤äº† Consumerï¼Œå¦‚æœéœ€è¦è¿”å›å€¼çš„ä¸šåŠ¡é€»è¾‘ï¼Œéœ€è¦ç”¨åˆ°å“ªä¸ªå‡½æ•°å¼æ¥å£å‘¢ï¼Ÿ</li>
<li>å½“å‡ºç°å¤æ‚è¡¨å¤´çš„æ—¶å€™è¦å¦‚ä½•å¤„ç†å‘¢ï¼Ÿ</li>
<li>å°† DB æ•°æ®å†™å…¥åˆ° Excel å¹¶ä¸‹è½½ï¼Œå¦‚ä½•å®ç°å‘¢ï¼Ÿ</li>
<li>ä» EasyExcel çš„è®¾è®¡ä¸Šï¼Œä½ å­¦åˆ°äº†ä»€ä¹ˆï¼Œæ¬¢è¿åšå®¢ä¸‹æ–¹ç•™è¨€è®¨è®º</li>
</ol>
<h2 id="æé«˜æ•ˆç‡å·¥å…·">æé«˜æ•ˆç‡å·¥å…·</h2>
<p><img src="./images/EasyExcel è½»æ¾çµæ´»è¯»å–Excelå†…å®¹11.png" /></p>
<hr />
<h2 id="æ¨èé˜…è¯»">æ¨èé˜…è¯»</h2>
<ol>
<li><a href="https://dayarch.top/p/d7e125a1.html">è¿™æ¬¡èµ°è¿›å¹¶å‘çš„ä¸–ç•Œï¼Œè¯·ä¸è¦é”™è¿‡</a></li>
<li><a href="https://dayarch.top/p/86243a5b.html">å­¦å¹¶å‘ç¼–ç¨‹ï¼Œé€å½»ç†è§£è¿™ä¸‰ä¸ªæ ¸å¿ƒæ˜¯å…³é”®</a></li>
<li><a href="https://dayarch.top/p/6d12b8cf.html">å¹¶å‘Bugä¹‹æºæœ‰ä¸‰ï¼Œè¯·çå¤§çœ¼ç›çœ‹æ¸…å®ƒä»¬</a></li>
<li><a href="https://dayarch.top/p/815d7647.html">å¯è§æ€§æœ‰åºæ€§ï¼ŒHappens-beforeæ¥æå®š</a></li>
<li><a href="https://dayarch.top/p/32b8e26a.html">è§£å†³åŸå­æ€§é—®é¢˜ï¼Ÿä½ é¦–å…ˆéœ€è¦çš„æ˜¯å®è§‚ç†è§£</a></li>
<li><a href="https://dayarch.top/p/fb3c7eeb.html">é¢è¯•å¹¶å‘volatileå…³é”®å­—æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥å…·å¤‡å“ªäº›è°ˆèµ„ï¼Ÿ</a></li>
</ol>
<hr />
<blockquote>
<h3 id="æ¬¢è¿æŒç»­å…³æ³¨å…¬ä¼—å·æ—¥æ‹±ä¸€å…µ">æ¬¢è¿æŒç»­å…³æ³¨å…¬ä¼—å·ï¼šã€Œæ—¥æ‹±ä¸€å…µã€</h3>
<ul>
<li>å‰æ²¿ Java æŠ€æœ¯å¹²è´§åˆ†äº«</li>
<li>é«˜æ•ˆå·¥å…·æ±‡æ€» | å›å¤ã€Œå·¥å…·ã€</li>
<li>é¢è¯•é—®é¢˜åˆ†æä¸è§£ç­”</li>
<li>æŠ€æœ¯èµ„æ–™é¢†å– | å›å¤ã€Œèµ„æ–™ã€</li>
</ul>
</blockquote>
<blockquote>
<p>ä»¥è¯»ä¾¦æ¢å°è¯´æ€ç»´è½»æ¾è¶£å‘³å­¦ä¹  Java æŠ€æœ¯æ ˆç›¸å…³çŸ¥è¯†ï¼Œæœ¬ç€å°†å¤æ‚é—®é¢˜ç®€å•åŒ–ï¼ŒæŠ½è±¡é—®é¢˜å…·ä½“åŒ–å’Œå›¾å½¢åŒ–åŸåˆ™é€æ­¥åˆ†è§£æŠ€æœ¯é—®é¢˜ï¼ŒæŠ€æœ¯æŒç»­æ›´æ–°ï¼Œè¯·æŒç»­å…³æ³¨......</p>
</blockquote>
<p><img src="./images/EasyExcel è½»æ¾çµæ´»è¯»å–Excelå†…å®¹12.png" /></p>


</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>